!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("loco-js-model")):"function"==typeof define&&define.amd?define(["loco-js-model"],t):"object"==typeof exports?exports.App=t(require("loco-js-model")):e.App=t(e.LocoModel)}("undefined"!=typeof self?self:this,function(e){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=13)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={loco:null,namespaceController:null,controller:null,action:null,scope:null};t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Validators=t.IdentityMap=t.Deps=t.Base=void 0;var r=n(15),i={cable:null,NotificationCenter:null};t.Base=r.Base,t.Deps=i,t.IdentityMap=r.IdentityMap,t.Validators=r.Validators},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l;l=function(e){var t,n,l,u,a,s;t=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),t}(e);for(var c=arguments.length,f=Array(c>1?c-1:0),d=1;d<c;d++)f[d-1]=arguments[d];for(n=f.length-1;n>=0;n+=-1){u=f[n],s=u.prototype;for(a in s)l=s[a],t.prototype[a]=l}return t},t.default=l},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(1),u=n(4),a=function(e){return e&&e.__esModule?e:{default:e}}(u);i=function(){function e(){r(this,e)}return o(e,[{key:"connectWith",value:function(e){var t,n,r,i,o,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null==e)return null;for("Array"!==e.constructor.name&&(e=[e]),e=a.default.uniq(e),o=[],t=0,r=e.length;t<r;t++)i=e[t],"Function"===i.constructor.name?(n=i.getIdentity(),l.IdentityMap.addCollection(n,{to:this}),null!=u.receiver?o.push(this.receivers[n]=u.receiver):o.push(void 0)):(l.IdentityMap.connect(this,{with:i}),null!=u.receiver?o.push(this.receivers[i.toKey()]=u.receiver):o.push(void 0));return o}},{key:"receiverFor",value:function(e){return"String"===e.constructor.name?null!=this.receivers[e]?this.receivers[e]:null:null!=this.receivers[e.toKey()]?this.receivers[e.toKey()]:null}}]),e}(),t.default=i},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();i=function(){function e(){r(this,e)}return o(e,null,[{key:"map",value:function(e,t){var n,r,i,o;for(i=[],n=0,r=e.length;n<r;n++)o=e[n],i.push(t(o));return i}},{key:"uniq",value:function(e){var t,n,r,i;for(r=[],t=0,n=e.length;t<n;t++)i=e[t],-1===r.indexOf(i)&&r.push(i);return r}}]),e}(),t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(18),i=function(e){return e&&e.__esModule?e:{default:e}}(r),o={en:i.default};t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={Loco:{}};t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(14),i=function(e){return e&&e.__esModule?e:{default:e}}(r),o={Base:i.default};t.default=o},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o,l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(6),a=r(u),s=n(0),c=r(s),f=n(1);o=function(){function e(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];i(this,e),this.connected=!1}return l(e,[{key:"connect",value:function(){var e=this;return a.default.Loco.NotificationCenter=(f.Deps.cable||App.cable).subscriptions.create({channel:"Loco::NotificationCenterChannel"},{connected:function(){var t;return console.log("ws connected"),e.connected=!0,t=c.default.loco.getWire(),null!=t&&t.setDelayedDisconnection(),e._sendNotification({loco:"connected"})},disconnected:function(){var t;return console.log("ws disconnected"),e.connected=!1,t=c.default.loco.getWire(),null!=t&&(t.setUuid(null),t.fetchSyncTime({after:"connect"})),e._sendNotification({loco:"disconnected"})},rejected:function(){return console.log("ws rejected"),e._sendNotification({loco:"rejected"})},received:function(t){if(null!=t.loco&&(e._processSystemNotification(t.loco),delete t.loco),0!==Object.keys(t).length)return e._sendNotification(t)}})}},{key:"isWireAllowed",value:function(){return!this.connected}},{key:"send",value:function(e){return a.default.Loco.NotificationCenter.send(e)}},{key:"_processSystemNotification",value:function(e){var t;if(null!=e.connection_check&&this.send({loco:{connection_check:!0}}),null!=(t=c.default.loco.getWire()))return null!=e.sync_time&&t.setSyncTime(e.sync_time),null!=e.uuid&&(console.log("uuid: "+e.uuid),t.setUuid(e.uuid)),null!=e.notification&&t.processNotification(e.notification),null!=e.xhr_notifications&&t.check(),e.start_ajax_polling?(console.log("wire connected"),this.connected=null,t.setUuid(null),t.fetchSyncTime({after:"connect"})):void 0}},{key:"_sendNotification",value:function(e){var t;return t=null!=f.Deps.NotificationCenter?new f.Deps.NotificationCenter:new App.Services.NotificationCenter,t.receivedSignal(e)}}]),e}(),t.default=o},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o,l=function(){function e(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var l,u=e[Symbol.iterator]();!(r=(l=u.next()).done)&&(n.push(l.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(0),s=r(a),c=n(1),f=n(10),d=r(f);o=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e);var n,r,o,l;this.syncTime=null,this.token=null,this.pollingInterval=null,this.pollingTime=null!=(n=t.pollingTime)?n:3e3,this.log=!(null==t.log||!t.log),this.ssl=t.ssl,this.location=null!=(r=t.location)?r:"notification-center",this.size=null!=(o=t.size)?o:100,this.protocolWithHost=t.protocolWithHost,this.allowedDisconnectionTime=null!=(l=t.allowedDisconnectionTime)?l:10,this.disconnectedSinceTime=null,this.uuid=null,this.delayedDisconnection=!1}return u(e,[{key:"setToken",value:function(e){return this.token=e}},{key:"getSyncTime",value:function(){return this.syncTime}},{key:"setSyncTime",value:function(e){return this.syncTime=e}},{key:"resetSyncTime",value:function(){return this.syncTime=null}},{key:"getPollingTime",value:function(){return this.pollingTime}},{key:"setPollingTime",value:function(e){return this.pollingTime=e,this.disconnect(),this.connect()}},{key:"getPollingInterval",value:function(){return this.pollingInterval}},{key:"getSSL",value:function(){return this.ssl}},{key:"setSSL",value:function(e){return this.ssl=e}},{key:"getLocation",value:function(){return this.location}},{key:"setLocation",value:function(e){return this.location=e}},{key:"getSize",value:function(){return this.size}},{key:"setSize",value:function(e){return this.size=e}},{key:"getAllowedDisconnectionTime",value:function(){return this.allowedDisconnectionTime}},{key:"setAllowedDisconnectionTime",value:function(e){return this.allowedDisconnectionTime=e}},{key:"getUuid",value:function(){return this.uuid}},{key:"setUuid",value:function(e){return this.uuid=e}},{key:"setDelayedDisconnection",value:function(){return this.delayedDisconnection=!0}},{key:"connect",value:function(){var e,t=this;if(null==(e=s.default.loco.getLine())||e.isWireAllowed())return this.pollingInterval=setInterval(function(){if(t.check(),t.delayedDisconnection)return t.delayedDisconnection=!1,t.disconnect()},this.pollingTime)}},{key:"disconnect",value:function(){return window.clearInterval(this.pollingInterval)}},{key:"disableNotifications",value:function(){return console.log("Wire#disableNotifications - DEPRECATED"),this.disconnect()}},{key:"processNotification",value:function(e){var t,n,r,i,o,u,a;this.log&&console.log(e);var f=l(e,4);if(t=f[0],n=f[1],a=f[2],u=f[3],i=s.default.loco.getModelForRemoteName(t),r=i.getIdentity(),null!=c.IdentityMap.imap[r]&&(null!=c.IdentityMap.imap[r][n]&&(o=c.IdentityMap.find(r,n),null!=o.receivedSignal&&o.receivedSignal(a,u),this._emitSignalToMembers(n,a,u,i,r)),null!=i.receivedSignal&&i.receivedSignal(a,u),null!=c.IdentityMap.imap[r].collection&&0!==c.IdentityMap.imap[r].collection.length))return this._emitSignalToCollection(a,u,r)}},{key:"processSignal",value:function(e){return this.processNotification(e)}},{key:"check",value:function(){var e,t=this;if(0!==Object.keys(c.IdentityMap.imap).length||null!=this.token||null==this.syncTime)return e=new XMLHttpRequest,e.open("GET",this._getURL()+"?"+d.default.toURIParams(this._requestParams())),e.onload=function(e){var n,r,i,o,l;if(e.target.status>=200&&e.target.status<400){if(n=JSON.parse(e.target.response),t.disconnectedSinceTime=null,t.syncTime=n[1],l=n[0],0===l.length)return;for(r=0,i=l.length;r<i;r++)o=l[r],t.processNotification(o);if(l.length===t.size)return t.check()}else if(e.target.status>=500)return t._handleDisconnection()},e.onerror=function(){return t._handleDisconnection()},e.send()}},{key:"fetchSyncTime",value:function(){var e,t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e=new XMLHttpRequest,e.open("GET",this._getURL()+"/sync-time"),e.onerror=function(){if(null!=n.after)return t[n.after]()},e.onload=function(e){var r;if(e.target.status>=200&&e.target.status<400){if(r=JSON.parse(e.target.response),t.syncTime=r.sync_time,null!=n.after)return t[n.after]()}else if(e.target.status>=500&&null!=n.after)return t[n.after]()},e.send()}},{key:"_emitSignalToMembers",value:function(e,t,n,r,i){var o,l,u,a,s,f=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;for(null==f&&(f=new r({id:e})),a=c.IdentityMap.findConnected(i,e),s=[],l=0,u=a.length;l<u;l++)o=a[l],null!=o.receiverFor(f)?s.push(o[o.receiverFor(f)](t,n)):null!=o.receivedSignal?s.push(o.receivedSignal(t,n)):s.push(void 0);return s}},{key:"_emitSignalToCollection",value:function(e,t,n){var r,i,o,l,u;for(l=c.IdentityMap.imap[n].collection,u=[],r=0,i=l.length;r<i;r++)o=l[r],null!=o.receiverFor(n)?u.push(o[o.receiverFor(n)](n+" "+e,t)):null!=o.receivedSignal?u.push(o.receivedSignal(n+" "+e,t)):u.push(void 0);return u}},{key:"_requestParams",value:function(){var e;return e={synced_at:this.syncTime},null!=this.token&&(e.token=this.token),null!=this.uuid&&(e.uuid=this.uuid),e}},{key:"_getURL",value:function(){var e,t,n=window.location.href.split("/"),r=l(n,3);if(t=r[0],r[1],e=r[2],null!=this.protocolWithHost){var i=this.protocolWithHost.split("//"),o=l(i,2);t=o[0],e=o[1]}return null!=this.ssl&&(t=this.ssl?"https:":"http:"),t+"//"+e+"/"+this.location}},{key:"_handleDisconnection",value:function(){var e,t,n;if(null==this.disconnectedSinceTime&&(this.disconnectedSinceTime=new Date),t=(new Date-this.disconnectedSinceTime)/1e3,e=null!=(n=s.default.namespaceController)?n:s.default.controller,t>this.allowedDisconnectionTime&&null!=e.disconnectedForTooLong)return e.disconnectedForTooLong(this.disconnectedSinceTime)}}]),e}(),t.default=o},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();i=function(){function e(){r(this,e)}return o(e,null,[{key:"toURIParams",value:function(e){var t,n,r;n="";for(t in e)r=e[t],""!==n&&(n+="&"),n+=t+"="+encodeURIComponent(r);return n}}]),e}(),t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i={Base:r.Base};t.default=i},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(4),o=r(i),l=n(25),u=r(l),a=n(26),s=r(a),c=n(10),f=r(c),d=n(27),h=r(d),v={Array:o.default,Collection:u.default,Dom:s.default,Object:f.default,String:h.default};t.default=v},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Wire=t.Views=t.Validators=t.Utils=t.UI=t.Services=t.Presenters=t.Models=t.Mixins=t.Mix=t.Loco=t.Line=t.I18n=t.Helpers=t.Env=t.Deps=t.Controllers=t.Channels=void 0;var i=n(6),o=r(i),l=n(7),u=r(l),a=n(0),s=r(a),c=n(16),f=r(c),d=n(5),h=r(d),v=n(8),p=r(v),m=n(19),b=r(m),y=n(2),g=r(y),_=n(20),k=r(_),w=n(11),j=r(w),S=n(21),C=r(S),M=n(23),O=r(M),T=n(12),P=r(T),A=n(29),D=r(A),E=n(9),I=r(E),x=n(1),L={};t.Channels=o.default,t.Controllers=u.default,t.Deps=x.Deps,t.Env=s.default,t.Helpers=f.default,t.I18n=h.default,t.Line=p.default,t.Loco=b.default,t.Mix=g.default,t.Mixins=k.default,t.Models=j.default,t.Presenters=L,t.Services=C.default,t.UI=O.default,t.Utils=P.default,t.Validators=x.Validators,t.Views=D.default,t.Wire=I.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u,a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(2),c=r(s),f=n(3),d=r(f),h=n(0),v=r(h),p=n(4),m=r(p);u=function(e){function t(){i(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.views={},e.receivers={},e.subController=null,e.superController=null,e.params=e.__fetchParams(),e}return l(t,e),a(t,[{key:"setView",value:function(e,t){return this.views[e]=t}},{key:"getView",value:function(e){return this.views[e]}},{key:"getViews",value:function(){return this.views}},{key:"setSubController",value:function(e){return this.subController=e}},{key:"getSubController",value:function(){return this.subController}},{key:"setSuperController",value:function(e){return this.superController=e}},{key:"getSuperController",value:function(){return this.superController}},{key:"setResource",value:function(e){return this.setScope(e)}},{key:"setScope",value:function(e){return v.default.scope=e}},{key:"__fetchParams",value:function(){var e,t,n,r,i,o,l,u,a,s,c;if(l={},o=/https?:\/\/.+\/\w+\/(\d+)/.exec(window.location.href),n=null!=o?o[1]:null,null!=n&&(l.id=parseInt(n)),s=window.location.href.split("?"),1===s.length)return l;for(a=s[s.length-1],u=m.default.map(a.split("&"),function(e){return e.split("=")}),t=0,i=u.length;t<i;t++)e=u[t],r=decodeURIComponent(e[0]),c=decodeURIComponent(e[1]),null!=c&&(c=c.replace(/\+/g," ")),l[r]=c;return l}}]),t}((0,c.default)(d.default)),t.default=u},function(t,n){t.exports=e},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(17),i=function(e){return e&&e.__esModule?e:{default:e}}(r),o={Text:i.default};t.default=o},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();i=function(){function e(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];r(this,e)}return o(e,[{key:"simpleFormat",value:function(e){return e=e.replace(/\r\n?/,"\n"),e=e.trim(),e.length>0&&(e=e.replace(/\n\n+/g,"</p><p>"),e=e.replace(/\n/g,"<br>"),e="<p>"+e+"</p>"),e}}]),e}(),t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;r={variants:{},models:{},attributes:{},ui:{form:{sending:"Sending...",success:"Success",errors:{connection:"Connection Error",invalid_data:"Invalid data"}}},date:{formats:{default:"%Y-%m-%d",short:"%b %d",long:"%B %d, %Y"},day_names:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],abbr_day_names:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],month_names:["January","February","March","April","May","June","July","August","September","October","November","December"],abbr_month_names:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},errors:{messages:{accepted:"must be accepted",blank:"can't be blank",confirmation:"doesn't match %{attribute}",empty:"can't be empty",equal_to:"must be equal to %{count}",even:"must be even",exclusion:"is reserved",greater_than:"must be greater than %{count}",greater_than_or_equal_to:"must be greater than or equal to %{count}",inclusion:"is not included in the list",invalid:"is invalid",less_than:"must be less than %{count}",less_than_or_equal_to:"must be less than or equal to %{count}",not_a_number:"is not a number",not_an_integer:"must be an integer",odd:"must be odd",present:"must be blank",too_long:{one:"is too long (maximum is 1 character)",other:"is too long (maximum is %{count} characters)"},too_short:{one:"is too short (minimum is 1 character)",other:"is too short (minimum is %{count} characters)"},wrong_length:{one:"is the wrong length (should be 1 character)",other:"is the wrong length (should be %{count} characters)"},other_than:"must be other than %{count}"}}},t.default=r},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o,l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(1),a=n(9),s=r(a),c=n(8),f=r(c),d=n(0),h=r(d),v=n(7),p=r(v),m=n(11),b=r(m);o=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e);var n,r,o,l,u;this.wire=null,this.line=null,this.locale=null,this.turbolinks=null!=(r=t.turbolinks)&&r,this.startWire=!(null==(o=t.notifications)||!o.enable),this.postInit=t.postInit,this.setLocale(null!=(l=t.locale)?l:"en"),this.setProtocolWithHost(t.protocolWithHost),n=null!=(u=t.notifications)?u:{},n.protocolWithHost=this.protocolWithHost,this.notificationsParams=n}return l(e,[{key:"getWire",value:function(){return this.wire}},{key:"getLine",value:function(){return this.line}},{key:"getLocale",value:function(){return this.locale}},{key:"setLocale",value:function(e){return this.locale=e}},{key:"getProtocolWithHost",value:function(){return this.protocolWithHost}},{key:"setProtocolWithHost",value:function(e){return null==e?void(this.protocolWithHost=null):("/"===e[e.length-1]&&(e=e.slice(0,+(e.length-2)+1||9e9)),this.protocolWithHost=e)}},{key:"init",value:function(){var e,t=this;return h.default.loco=this,this.initWire(),this.initLine(),this.turbolinks?(e=Number(this.turbolinks)>=5?"turbolinks:load":"page:change",document.addEventListener(e,function(){if(t.flow(),null!=t.postInit)return t.postInit()})):this.ready(function(){if(t.flow(),null!=t.postInit)return t.postInit()})}},{key:"ready",value:function(e){var t;return t=document.attachEvent?"complete"===document.readyState:"loading"!==document.readyState,t?e():document.addEventListener("DOMContentLoaded",e)}},{key:"initWire",value:function(){if(this.startWire)return this.wire=new s.default(this.notificationsParams),this.wire.fetchSyncTime({after:"connect"})}},{key:"initLine",value:function(){if(null!=u.Deps.cable||null!=("undefined"!=typeof App&&null!==App?App.cable:void 0))return this.line=new f.default,this.line.connect()}},{key:"flow",value:function(){var e,t,n;if(u.IdentityMap.clear(),n=document.getElementsByTagName("body")[0].getAttribute("data-namespace"),t=document.getElementsByTagName("body")[0].getAttribute("data-controller"),e=document.getElementsByTagName("body")[0].getAttribute("data-action"),h.default.action=e,null!=p.default[n]?(h.default.namespaceController=new p.default[n],null!=p.default[n][t]&&(h.default.controller=new p.default[n][t]),null!=h.default.namespaceController.initialize&&h.default.namespaceController.initialize(),null!=h.default.controller&&(h.default.namespaceController.setSubController(h.default.controller),h.default.controller.setSuperController(h.default.namespaceController),null!=h.default.controller.initialize&&h.default.controller.initialize(),null!=h.default.controller[e]&&h.default.controller[e]())):p.default[t]&&(h.default.controller=new p.default[t],null!=h.default.controller.initialize&&h.default.controller.initialize(),null!=h.default.controller[e]&&h.default.controller[e]()),null!=this.wire)return this.wire.resetSyncTime(),this.wire.fetchSyncTime()}},{key:"emit",value:function(e){return this.line.send(e)}},{key:"getModels",value:function(){var e,t,n,r,i;n=[],i=/^[A-Z]/;for(e in b.default)if(b.default[e],i.exec(e)&&"Base"!==e){n.push(e),r=b.default[e];for(t in r)r[t],i.exec(t)&&n.push(e+"."+t)}return n}},{key:"getModelForRemoteName",value:function(e){var t,n,r,i,o;for(o=this.getModels(),t=0,n=o.length;t<n;t++)if(r=o[t],i=r.split("."),1===i.length){if(b.default[i[0]].getRemoteName()===e)return b.default[i[0]]}else if(2===i.length&&b.default[i[0]][i[1]].getRemoteName()===e)return b.default[i[0]][i[1]]}}]),e}(),t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),i=function(e){return e&&e.__esModule?e:{default:e}}(r),o={Connectivity:i.default};t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(22),i=function(e){return e&&e.__esModule?e:{default:e}}(r),o={Date:i.default};t.default=o},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o,l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(5),a=r(u),s=n(0),c=r(s);o=function(){function e(t){i(this,e),this.date=t}return l(e,[{key:"toString",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";switch(e=a.default[c.default.loco.getLocale()].date.formats,t){case"default":return this.strftime(e.default);case"short":return this.strftime(e.short);case"long":return this.strftime(e.long);default:return console.log("Services.Date#toString: unknown format.")}}},{key:"strftime",value:function(e){var t,n=this;return t=a.default[c.default.loco.getLocale()],e=e.replace("%Y",function(e){return n.date.getFullYear()}),e=e.replace("%y",function(e){return n.date.getFullYear().toString().slice(-2)}),e=e.replace("%m",function(e){var t;return t=n.date.getMonth()+1,t>=10?t:"0"+t}),e=e.replace("%b",function(e){return t.date.abbr_month_names[n.date.getMonth()]}),e=e.replace("%B",function(e){return t.date.month_names[n.date.getMonth()]}),e=e.replace("%d",function(e){return n.date.getDate()>=10?n.date.getDate():"0"+n.date.getDate()}),e=e.replace("%H",function(e){return n.date.getHours()>=10?n.date.getHours():"0"+n.date.getHours()}),e=e.replace("%M",function(e){return n.date.getMinutes()>=10?n.date.getMinutes():"0"+n.date.getMinutes()}),e=e.replace("%S",function(e){return n.date.getSeconds()>=10?n.date.getSeconds():"0"+n.date.getSeconds()})}}]),e}(),t.default=o},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(24),o=r(i),l=n(28),u=r(l),a={Form:o.default,Tabs:u.default};t.default=a},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o,l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(12),a=r(u),s=n(5),c=r(s),f=n(0),d=r(f);o=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.formId=t.id,this.obj=t.for,this.initObj=!(null==t.initObj||!t.initObj),this.delegator=t.delegator,this.callbackSuccess=t.callbackSuccess,this.callbackFailure=t.callbackFailure,this.callbackActive=t.callbackActive,this.form=this._findForm(),this.submit=null,this.submitVal=null,null!=this.form&&(this.submit=this.form.querySelector('[type="submit"]')),null!=this.submit&&(this.submitVal=this.submit.value),this.locale=d.default.loco.getLocale()}return l(e,[{key:"getObj",value:function(){return this.obj}},{key:"render",value:function(){return this.initObj?(this._assignAttribs(),this._handle()):null!=this.form?(this.fill(),this._handle()):void 0}},{key:"fill",value:function(){var e,t,n,r,i,o,l,u,s=this,c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(null==this.obj)return null;if(null==this.obj.constructor.attributes)return null;e={},null!=c?e[c]=null:e=this.obj.constructor.attributes,l=[];for(n in e)e[n],o=this.obj.getAttrRemoteName(n),null!==(r=this.form.querySelector("[data-attr="+o+"]"))&&(t=r.querySelectorAll("input,textarea,select"),0!==t.length&&(1!==t.length?(u=a.default.Array.uniq(a.default.Array.map(t,function(e){return e.getAttribute("type")})),1!==u.length||"radio"!==u[0]||null==(i=a.default.Collection.find(t,function(e){return e.value===String(s.obj[n])}))?"hidden"!==t[0].getAttribute("type")&&"checkbox"!==t[t.length-1].getAttribute("type")||l.push(t[t.length-1].checked=Boolean(this.obj[n])):i.checked=!0):t[0].value=this.obj[n]));return l}},{key:"_findForm",value:function(){var e;return null!=this.formId?document.getElementById(""+this.formId):null!=this.obj?(e=this.obj.getIdentity().toLowerCase(),null!=this.obj.id?document.getElementById("edit_"+e+"_"+this.obj.id):document.getElementById("new_"+e)):void 0}},{key:"_handle",value:function(){var e=this;return this.form.addEventListener("submit",function(t){var n;if(t.preventDefault(),e._canBeSubmitted())return null==e.obj?void e._submitForm():(e._assignAttribs(),e._hideErrors(),e.obj.isInvalid()?(e._renderErrors(),void(null!=e.callbackFailure&&e.delegator[e.callbackFailure]())):(e._submittingForm(!1),n=null==e.obj.id,e.obj.save().then(function(t){return e._alwaysAfterRequest(),t.success?e._handleSuccess(t,n):(null!=e.callbackFailure&&e.delegator[e.callbackFailure](),e._renderErrors())}).catch(function(t){return e._connectionError()})))})}},{key:"_canBeSubmitted",value:function(){return null==this.submit||!a.default.Dom.hasClass(this.submit,"active")&&(!a.default.Dom.hasClass(this.submit,"success")&&!a.default.Dom.hasClass(this.submit,"failure"))}},{key:"_submitForm",value:function(){var e,t,n,r,i=this;return this._submittingForm(),r=this.form.getAttribute("action")+".json",e=new FormData(this.form),n=new XMLHttpRequest,n.open("POST",r),n.setRequestHeader("X-CSRF-Token",null!=(t=document.querySelector("meta[name='csrf-token']"))?t.content:void 0),n.onload=function(t){return i._alwaysAfterRequest(),null!=i.submit&&i.submit.blur(),t.target.status>=200&&t.target.status<400?(e=JSON.parse(t.target.response),e.success?i._handleSuccess(e,"POST"===i.form.getAttribute("method")):i._renderErrors(e.errors)):t.target.status>=500?i._connectionError():void 0},n.onerror=function(){return i._alwaysAfterRequest(),null!=i.submit&&i.submit.blur(),i._connectionError()},n.send(e)}},{key:"_handleSuccess",value:function(e){var t,n,r,i=this,o=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return r=null!=(t=null!=(n=e.flash)?n.success:void 0)?t:c.default[this.locale].ui.form.success,null!=this.submit&&(a.default.Dom.addClass(this.submit,"success"),this.submit.value=r),null!=e.access_token&&d.default.loco.getWire().setToken(e.access_token),null!=this.callbackSuccess?void(null!=e.data?this.delegator[this.callbackSuccess](e.data):this.delegator[this.callbackSuccess]()):setTimeout(function(){var e,t,n,r,l,u;if(null!=i.submit&&(i.submit.disabled=!1,a.default.Dom.removeClass(i.submit,"success"),i.submit.value=i.submitVal),u=":not([data-loco-not-clear=true])",o){for(r=i.form.querySelectorAll("input:not([type='submit'])"+u+", textarea"+u),l=[],e=0,t=r.length;e<t;e++)n=r[e],l.push(n.value="");return l}},5e3)}},{key:"_renderErrors",value:function(){var e,t,n,r,i,o,l,u,s,f=this,d=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(!(null!=this.obj&&null==this.obj.errors||null==this.obj&&null==d)){t=null!=d?d:this.obj.errors;for(e in t)if(n=t[e],null==(s=null!=this.obj?this.obj.getAttrRemoteName(e):e)||"base"===e)"base"===e&&n.length>0&&(l=document.querySelectorAll(".errors[data-for='base']"),1===l.length?l[0].textContent=n[0]:null!=this.submit&&(this.submit.value=n[0]));else{if(null===(u=this.form.querySelector("[data-attr="+s+"]")))continue;if(l=u.querySelectorAll(".errors[data-for="+s+"]"),0===l.length)continue;for(r=0,i=l.length;r<i;r++)o=l[r],o.textContent=n[0]}return null!=this.submit&&(this.submit.value!==this.submitVal&&this.submit.value!==c.default[this.locale].ui.form.sending||(this.submit.value=c.default[this.locale].ui.form.errors.invalid_data),a.default.Dom.addClass(this.submit,"failure")),this._showErrors(),setTimeout(function(){var e,t,n,r;for(null!=f.submit&&(f.submit.disabled=!1,a.default.Dom.removeClass(f.submit,"failure"),f.submit.val=f.submitVal),n=f.form.querySelectorAll("input.invalid, textarea.invalid, select.invalid"),r=[],e=0,t=n.length;e<t;e++)o=n[e],r.push(a.default.Dom.removeClass(o,"invalid"));return r},1e3)}}},{key:"_assignAttribs",value:function(){var e,t,n,r,i,o,l,u;if(null==this.obj.constructor.attributes)return null;i=this.obj.constructor.attributes,l=[];for(t in i)i[t],o=this.obj.getAttrRemoteName(t),null!==(n=this.form.querySelector("[data-attr="+o+"]"))&&(e=n.querySelectorAll("input,textarea,select"),0!==e.length&&(1!==e.length?(u=a.default.Array.uniq(a.default.Array.map(e,function(e){return e.getAttribute("type")})),1!==u.length||"radio"!==u[0]||null==(r=a.default.Collection.find(e,function(e){return!0===e.checked}))?"hidden"!==e[0].getAttribute("type")&&"checkbox"!==e[e.length-1].getAttribute("type")||(!0===e[e.length-1].checked?l.push(this.obj.assignAttr(t,e[e.length-1].value)):l.push(this.obj.assignAttr(t,e[0].value))):this.obj.assignAttr(t,r.value)):this.obj.assignAttr(t,e[0].value)));return l}},{key:"_hideErrors",value:function(){var e,t,n,r,i;for(r=this.form.querySelectorAll(".errors"),i=[],t=0,n=r.length;t<n;t++)e=r[t],e.textContent.trim().length>0?(e.textContent="",i.push(e.style.display="none")):i.push(void 0);return i}},{key:"_showErrors",value:function(){var e,t,n,r,i;for(r=this.form.querySelectorAll(".errors"),i=[],t=0,n=r.length;t<n;t++)e=r[t],e.textContent.trim().length>0?i.push(e.style.display="block"):i.push(void 0);return i}},{key:"_submittingForm",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(null!=this.submit&&(a.default.Dom.removeClass(this.submit,"success"),a.default.Dom.removeClass(this.submit,"failure"),a.default.Dom.addClass(this.submit,"active"),this.submit.value=c.default[this.locale].ui.form.sending),null!=this.callbackActive&&this.delegator[this.callbackActive](),e)return this._hideErrors()}},{key:"_connectionError",value:function(){var e=this;if(null!=this.submit)return a.default.Dom.removeClass(this.submit,"active"),a.default.Dom.addClass(this.submit,"failure"),this.submit.val=c.default[this.locale].ui.form.errors.connection,setTimeout(function(){return e.submit.disabled=!1,a.default.Dom.removeClass(e.submit,"failure"),e.submit.val=e.submitVal},3e3)}},{key:"_alwaysAfterRequest",value:function(){if(null!=this.submit)return a.default.Dom.removeClass(this.submit,"active")}}]),e}(),t.default=o},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();i=function(){function e(){r(this,e)}return o(e,null,[{key:"find",value:function(e,t){var n,r,i;for(n=0,r=e.length;n<r;n++)if(i=e[n],!0===t(i))return i}}]),e}(),t.default=i},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();i=function(){function e(){r(this,e)}return o(e,null,[{key:"hasClass",value:function(e,t){return e.classList?e.classList.contains(t):new RegExp("(^| )"+t+"( |$)","gi").test(e.className)}},{key:"addClass",value:function(e,t){return e.classList?e.classList.add(t):e.className+=" "+t}},{key:"removeClass",value:function(e,t){return e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp("(^|\\b)"+t.split(" ").join("|")+"(\\b|$)","gi")," ")}}]),e}(),t.default=i},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();i=function(){function e(){r(this,e)}return o(e,null,[{key:"last",value:function(e){return e[e.length-1]}}]),e}(),t.default=i},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();i=function(){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};r(this,e);var o;this.sel=$(t),this.delegator=n,this.animFunc=null!=(o=i.animFunc)?o:"animate",this.handle()}return o(e,[{key:"handle",value:function(){var e,t=this;return e=this.sel.find("a").size(),this.sel.find("a").click(function(n){var r,i,o,l,u,a,s;if(n.preventDefault(),!$(n.target).hasClass("active")){for(o=0,a=$(n.target).parent().children("a"),i=0,u=a.length;i<u&&(r=a[i],$(r).text()!==$(n.target).text());i++)o+=1;return s=parseInt(t.sel.css("width")),l=s/e*o,t.sel.find("a.active").removeClass("active"),$(n.target).addClass("active"),t.sel.find("div.background")[t.animFunc]({left:l},200),t.delegator[$(n.target).data("action")]()}})}}]),e}(),t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(30),i=function(e){return e&&e.__esModule?e:{default:e}}(r),o={Base:i.default};t.default=o},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u,a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(2),c=r(s),f=n(3),d=r(f);u=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.views={},n.intervals={},n.receivers={},n.controller=null,n.delegator=null,null!=e.controller&&n.setController(e.controller),null!=e.delegator&&n.setDelegator(e.delegator),n}return l(t,e),a(t,[{key:"setController",value:function(e){return this.controller=e}},{key:"getController",value:function(){return this.controller}},{key:"setView",value:function(e,t){return this.views[e]=t}},{key:"getView",value:function(e){return this.views[e]}},{key:"getViews",value:function(){return this.views}},{key:"setDelegator",value:function(e){return this.delegator=e}},{key:"getDelegator",value:function(e){return this.delegator}}]),t}((0,c.default)(d.default)),t.default=u}])});