!function(t){function e(e){for(var n,a,u=e[0],c=e[1],s=e[2],f=0,p=[];f<u.length;f++)a=u[f],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&p.push(o[a][0]),o[a]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);for(l&&l(e);p.length;)p.shift()();return i.push.apply(i,s||[]),r()}function r(){for(var t,e=0;e<i.length;e++){for(var r=i[e],n=!0,u=1;u<r.length;u++){var c=r[u];0!==o[c]&&(n=!1)}n&&(i.splice(e--,1),t=a(a.s=r[0]))}return t}var n={},o={0:0},i=[];function a(e){if(n[e])return n[e].exports;var r=n[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,a),r.l=!0,r.exports}a.m=t,a.c=n,a.d=function(t,e,r){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(a.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)a.d(r,n,function(e){return t[e]}.bind(null,n));return r},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="";var u=window.webpackJsonp=window.webpackJsonp||[],c=u.push.bind(u);u.push=e,u=u.slice();for(var s=0;s<u.length;s++)e(u[s]);var l=c;i.push([167,1]),r()}({1:function(t,e,r){var n;window,t.exports=(n=r(126),function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=2)}([function(t,e){t.exports=n},function(t,e,r){window,t.exports=function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=0)}([function(t,e,r){"use strict";function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}r.r(e),r.d(e,"init",(function(){return a})),r.d(e,"helpers",(function(){return u})),r.d(e,"Controllers",(function(){return c}));var o=function(t){"function"==typeof t.constructor.initialize&&t.constructor.initialize(),"function"==typeof t.initialize&&t.initialize()},i=function(t,e,r){var o=void 0===r?t[e]:t[e][r];return"function"==typeof o?new o:"object"===n(o)?o:null},a=function(t){var e=document.getElementsByTagName("body")[0],r=e.getAttribute("data-namespace"),n=e.getAttribute("data-controller"),a=e.getAttribute("data-action"),u=i(t,r),c=i(t,n);return null!==u&&(c=i(t,r,n),u.controller=c,o(u)),null!==c&&(c.namespaceController=u,function(t,e){o(t),"function"==typeof t.constructor[e]&&t.constructor[e](),"function"==typeof t[e]&&t[e]()}(c,a)),{namespaceController:u,controller:c,action:a}},u={get params(){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.href,e={},r=/https?:\/\/.+\/\w+\/(\d+)/.exec(t),n=null!==r?r[1]:null;null!==n&&(e.id=parseInt(n));var o=t.split("?");if(1===o.length)return e;var i=o[o.length-1],a=i.split("&").map((function(t){return t.split("=")})),u=!0,c=!1,s=void 0;try{for(var l,f=a[Symbol.iterator]();!(u=(l=f.next()).done);u=!0){var p=l.value,d=decodeURIComponent(p[0]),m=decodeURIComponent(p[1]);"string"==typeof m&&(m=m.replace(/\+/g," ")),e[d]=m}}catch(t){c=!0,s=t}finally{try{u||null==f.return||f.return()}finally{if(c)throw s}}return e}()}},c={Base:function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}}}])},function(t,e,r){"use strict";r.r(e),r.d(e,"getLine",(function(){return _})),r.d(e,"getLocale",(function(){return b})),r.d(e,"setLocale",(function(){return v})),r.d(e,"getWire",(function(){return g})),r.d(e,"connector",(function(){return j})),r.d(e,"emit",(function(){return w})),r.d(e,"helpers",(function(){return o.helpers})),r.d(e,"init",(function(){return O})),r.d(e,"subscribe",(function(){return E})),r.d(e,"Controllers",(function(){return o.Controllers})),r.d(e,"Env",(function(){return n})),r.d(e,"I18n",(function(){return i.I18n})),r.d(e,"Models",(function(){return i.Models})),r.d(e,"Validators",(function(){return i.Validators}));var n={loco:null,namespaceController:null,controller:null,action:null},o=r(1),i=r(0);o.Controllers.Base.prototype.setScope=function(t){return i.Config.scope=t},o.Controllers.Base.prototype.setResource=function(t){return(void 0).setScope(t)};var a={cable:null,NotificationCenter:null},u=function(){function t(){}return t.toURIParams=function(t){var e,r,n;for(e in r="",t)n=t[e],""!==r&&(r+="&"),r+=e+"="+encodeURIComponent(n);return r},t}();function c(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{n||null==u.return||u.return()}finally{if(o)throw i}}return r}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var s=function(t,e,r,n,o){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;null===a&&(a=new n({id:t}));var u=!0,c=!1,s=void 0;try{for(var l,f=i.IdentityMap.findConnected(o,t)[Symbol.iterator]();!(u=(l=f.next()).done);u=!0){var p=l.value;p(e,r)}}catch(t){c=!0,s=t}finally{try{u||null==f.return||f.return()}finally{if(c)throw s}}},l=function(t,e,r){var n=!0,o=!1,a=void 0;try{for(var u,c=i.IdentityMap.imap[r].collection[Symbol.iterator]();!(n=(u=c.next()).done);n=!0)(0,u.value)("".concat(r," ").concat(t),e)}catch(t){o=!0,a=t}finally{try{n||null==c.return||c.return()}finally{if(o)throw a}}},f=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.log&&console.log(t);var r=c(t,4),o=r[0],u=r[1],f=r[2],p=r[3],d=n.loco.getModelForRemoteName(o),m=d.getIdentity();null!=a.NotificationCenter&&a.NotificationCenter({type:"".concat(m," ").concat(f),payload:p}),void 0!==i.IdentityMap.imap[m]&&(void 0!==i.IdentityMap.imap[m][u]&&s(u,f,p,d,m),void 0!==i.IdentityMap.imap[m].collection&&0!==i.IdentityMap.imap[m].collection.length&&l(f,p,m))},p=function(){function t(t){var e,r,n,o;null==t&&(t={}),this.syncTime=null,this.token=null,this.pollingInterval=null,this.pollingTime=null!=(e=t.pollingTime)?e:3e3,this.log=!(null==t.log||!t.log),this.ssl=t.ssl,this.location=null!=(r=t.location)?r:"notification-center",this.size=null!=(n=t.size)?n:100,this.protocolWithHost=t.protocolWithHost,this.allowedDisconnectionTime=null!=(o=t.allowedDisconnectionTime)?o:10,this.disconnectedSinceTime=null,this.uuid=null,this.delayedDisconnection=!1}return t.prototype.resetSyncTime=function(){return this.syncTime=null},t.prototype.setPollingTime=function(t){return this.pollingTime=t,this.disconnect(),this.connect()},t.prototype.connect=function(){var t,e;if(null==(t=n.loco.line)||t.isWireAllowed())return this.pollingInterval=setInterval((e=this,function(){if(e.check(),e.delayedDisconnection)return e.delayedDisconnection=!1,e.disconnect()}),this.pollingTime)},t.prototype.disconnect=function(){return window.clearInterval(this.pollingInterval)},t.prototype.check=function(){var t,e;if(0!==Object.keys(i.IdentityMap.imap).length||null!=this.token||null==this.syncTime)return(t=new XMLHttpRequest).open("GET",this._getURL()+"?"+u.toURIParams(this._requestParams())),t.onload=(e=this,function(t){var r,n,o,i,a;if(t.target.status>=200&&t.target.status<400){if(r=JSON.parse(t.target.response),e.disconnectedSinceTime=null,e.syncTime=r[1],0===(a=r[0]).length)return;for(n=0,o=a.length;n<o;n++)i=a[n],f(i,{log:e.log});if(a.length===e.size)return e.check()}else if(t.target.status>=500)return e._handleDisconnection()}),t.onerror=function(t){return function(){return t._handleDisconnection()}}(this),t.send()},t.prototype.fetchSyncTime=function(t){var e,r;return null==t&&(t={}),(e=new XMLHttpRequest).open("GET",this._getURL()+"/sync-time"),e.onerror=(r=this,function(){if(null!=t.after)return r[t.after]()}),e.onload=function(e){return function(r){var n;if(r.target.status>=200&&r.target.status<400){if(n=JSON.parse(r.target.response),e.syncTime=n.sync_time,null!=t.after)return e[t.after]()}else if(r.target.status>=500&&null!=t.after)return e[t.after]()}}(this),e.send()},t.prototype._requestParams=function(){var t;return t={synced_at:this.syncTime},null!=this.token&&(t.token=this.token),null!=this.uuid&&(t.uuid=this.uuid),t},t.prototype._getURL=function(){var t,e,r,n;return e=(r=window.location.href.split("/"))[0],r[1],t=r[2],null!=this.protocolWithHost&&(e=(n=this.protocolWithHost.split("//"))[0],t=n[1]),null!=this.ssl&&(e=this.ssl?"https:":"http:"),e+"//"+t+"/"+this.location},t.prototype._handleDisconnection=function(){var t,e,r;if(null==this.disconnectedSinceTime&&(this.disconnectedSinceTime=new Date),e=(new Date-this.disconnectedSinceTime)/1e3,t=null!=(r=n.namespaceController)?r:n.controller,e>this.allowedDisconnectionTime&&null!=t.disconnectedForTooLong)return t.disconnectedForTooLong(this.disconnectedSinceTime)},t}(),d=[];function m(t){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var h=function(){function t(t){null==t&&(t={}),this.connected=!1,this.subscription=null}return t.prototype.connect=function(){return this.subscription=a.cable.subscriptions.create({channel:"Loco::NotificationCenterChannel"},{connected:(t=this,function(){var e;return console.log("ws connected"),t.connected=!0,null!=(e=n.loco.wire)&&(e.delayedDisconnection=!0),a.NotificationCenter({loco:"connected"})}),disconnected:function(t){return function(){var e;return console.log("ws disconnected"),t.connected=!1,null!=(e=n.loco.wire)&&(e.uuid=null,e.fetchSyncTime({after:"connect"})),a.NotificationCenter({loco:"disconnected"})}}(this),rejected:function(){return console.log("ws rejected"),a.NotificationCenter({loco:"rejected"})},received:function(t){return function(e){if(null!=e.loco){if(!function(t,e){var r,n=e.line,o=e.wire,i=e.processNotification;if(!0===t.connection_check&&n.send({loco:{connection_check:!0}}),null!=o)return"string"==typeof t.sync_time&&(o.syncTime=t.sync_time),"string"==typeof t.uuid&&(console.log("uuid: ".concat(t.uuid)),o.uuid=t.uuid),"object"===m(t.notification)&&"Array"===t.notification.constructor.name&&i(t.notification,{log:o.log}),!0===t.xhr_notifications&&o.check(),!0===t.start_ajax_polling&&(console.log("wire connected"),n.connected=null,o.uuid=null,o.fetchSyncTime({after:"connect"})),"string"!=typeof t.idempotency_key||(r=t.idempotency_key,!d.includes(r)&&(d.unshift(r),d.length>100&&d.pop(),!0))}(e.loco,{line:t,wire:n.loco.wire,processNotification:f}))return;delete e.loco}if(0!==Object.keys(e).length)return a.NotificationCenter(e)}}(this)});var t},t.prototype.isWireAllowed=function(){return!this.connected},t.prototype.send=function(t){return this.subscription.send(t)},t}(),y=function(){function t(t){var e,r,n;null==t&&(t={}),this.wire=null,this.line=null,this.startWire=!!(null!=(r=t.notifications)?r.enable:void 0),this.postInit=t.postInit,(e=null!=(n=t.notifications)?n:{}).protocolWithHost=t.protocolWithHost,this.notificationsParams=e}return t.prototype.init=function(t){return n.loco=this,this.initWire(),this.initLine(t.cable),this.ready((e=this,function(){var t;if(i.IdentityMap.clear(),t=Object(o.init)(o.Controllers),n.namespaceController=t.namespaceController,n.controller=t.controller,n.action=t.action,null!=e.wire&&(e.wire.resetSyncTime(),e.wire.fetchSyncTime()),null!=e.postInit)return e.postInit()}));var e},t.prototype.ready=function(t){return(document.attachEvent?"complete"===document.readyState:"loading"!==document.readyState)?t():document.addEventListener("DOMContentLoaded",t)},t.prototype.initWire=function(){if(this.startWire)return this.wire=new p(this.notificationsParams),this.wire.fetchSyncTime({after:"connect"})},t.prototype.initLine=function(t){if(null!=t)return this.line=new h,this.line.connect()},t.prototype.emit=function(t){return this.line.send(t)},t.prototype.getModels=function(){var t,e,r,n,o;for(t in r=[],o=/^[A-Z]/,i.Models)if(i.Models[t],o.exec(t)&&"Base"!==t)for(e in r.push(t),n=i.Models[t])n[e],o.exec(e)&&r.push(t+"."+e);return r},t.prototype.getModelForRemoteName=function(t){var e,r,n,o;for(e=0,r=(o=this.getModels()).length;e<r;e++)if(1===(n=o[e].split(".")).length){if(i.Models[n[0]].getRemoteName()===t)return i.Models[n[0]]}else if(2===n.length&&i.Models[n[0]][n[1]].getRemoteName()===t)return i.Models[n[0]][n[1]]},t}(),b=function(){return i.Config.locale},v=function(t){return i.Config.locale=t},g=function(){return n.loco.wire},_=function(){return n.loco.line.subscription},w=function(t){return n.loco.emit(t)},O=function(t){i.Config.locale=t.locale||"en",i.Config.protocolWithHost=t.protocolWithHost,a.cable=t.cable,a.NotificationCenter=t.notificationCenter,new y(t).init({cable:a.cable,protocolWithHost:i.Config.protocolWithHost})},j={getLocale:b,Env:n,I18n:i.I18n},E=i.IdentityMap.subscribe}]))},124:function(t,e,r){},125:function(t,e,r){},126:function(t,e,r){window,t.exports=function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=0)}([function(t,e,r){"use strict";function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}r.r(e),r.d(e,"Config",(function(){return o})),r.d(e,"I18n",(function(){return i})),r.d(e,"IdentityMap",(function(){return p})),r.d(e,"Models",(function(){return q})),r.d(e,"Validators",(function(){return R}));var o=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.localeVar="en",this.protocolWithHostVar=null,this.scopeVar=null}var e,r;return e=t,(r=[{key:"locale",get:function(){return this.localeVar},set:function(t){return this.localeVar=t,this.localeVar}},{key:"protocolWithHost",get:function(){return this.protocolWithHostVar},set:function(t){return t?"/"===t[t.length-1]?(this.protocolWithHostVar=t.slice(0,t.length-1),this.protocolWithHostVar):(this.protocolWithHostVar=t,this.protocolWithHostVar):(this.protocolWithHostVar=null,this.protocolWithHostVar)}},{key:"scope",get:function(){return this.scopeVar},set:function(t){return this.scopeVar=t,this.scopeVar}}])&&n(e.prototype,r),t}()),i={en:{variants:{},models:{},attributes:{},errors:{messages:{accepted:"must be accepted",blank:"can't be blank",confirmation:"doesn't match %{attribute}",empty:"can't be empty",equal_to:"must be equal to %{count}",even:"must be even",exclusion:"is reserved",greater_than:"must be greater than %{count}",greater_than_or_equal_to:"must be greater than or equal to %{count}",inclusion:"is not included in the list",invalid:"is invalid",less_than:"must be less than %{count}",less_than_or_equal_to:"must be less than or equal to %{count}",not_a_number:"is not a number",not_an_integer:"must be an integer",odd:"must be odd",present:"must be blank",too_long:{one:"is too long (maximum is 1 character)",other:"is too long (maximum is %{count} characters)"},too_short:{one:"is too short (minimum is 1 character)",other:"is too short (minimum is %{count} characters)"},wrong_length:{one:"is the wrong length (should be 1 character)",other:"is the wrong length (should be %{count} characters)"},other_than:"must be other than %{count}"}}}};function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var u,c={},s=function(t,e){if(-1!==t.indexOf(e))return null;var r=function(t){var e=t.length;return t.find((function(t,r){if(null===t)return e=r,!0})),e}(t);return t[r]=e,r},l=function(t,e,r){return c[t][e][r]=null},f=function(t){var e=t.getIdentity();void 0===c[e]&&(c[e]={}),void 0===c[e][t.id]&&(c[e][t.id]=[]),c[e][t.id][0]=t},p={get imap(){return c},clear:function(){return c={}},subscribe:function(t){var e=function(){};if("object"===a(t.to)){var r=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.with;f(r);var n=c[r.getIdentity()][r.id];return s(n,t)}(t.with,{with:t.to});return null===r?e:function(){l(t.to.getIdentity(),t.to.id,r)}}if("function"==typeof t.to){var n=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};void 0===c[t]&&(c[t]={}),void 0===c[t].collection&&(c[t].collection=[]);var r=c[t].collection;return s(r,e.to)}(t.to.getIdentity(),{to:t.with});return null===n?e:function(){l(t.to.getIdentity(),"collection",n)}}},unsubscribe:l,add:f,find:function(t,e){return void 0!==c[t]&&null!=c[t][e]?c[t][e][0]:null},findConnected:function(t,e){return void 0!==c[t]&&void 0!==c[t][e]&&c[t][e].length>1?c[t][e].slice(1):[]}},d=function(){function t(){this.obj=null,this.attr=null,this.val=null,this.opts=null}return t.sharedInstances={},t.instance=function(t,e,r){var n,o;return o=this.identity,null==this.sharedInstances[o]&&(this.sharedInstances[o]=new R[o]),(n=this.sharedInstances[o]).assignAttribs(t,e,r),n},t.prototype.assignAttribs=function(t,e,r){return this.obj=t,this.attr=e,this.val=this.obj[this.attr],this.opts=r},t}(),m={}.hasOwnProperty,h=function(t){function e(){e.__super__.constructor.call(this)}return function(t,e){for(var r in e)m.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(e,t),e.identity="Absence",e.prototype.validate=function(){switch(typeof this.val){case"string":if(null!=this.val&&0===this.val.length)return;break;default:if(null==this.val)return}return this._addErrorMessage()},e.prototype._addErrorMessage=function(){var t;return t=null!=this.opts.message?this.opts.message:i[o.locale].errors.messages.present,this.obj.addErrorMessage(t,{for:this.attr})},e}(d),y={}.hasOwnProperty,b=function(t){function e(){e.__super__.constructor.call(this)}return function(t,e){for(var r in e)y.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(e,t),e.identity="Confirmation",e.prototype.validate=function(){var t;if(t=this.obj[this._properAttr()],null==this.val||null==t||this.val!==t)return this._addErrorMessage()},e.prototype._addErrorMessage=function(){var t,e,r,n;return r=this.attr.charAt(0).toUpperCase()+this.attr.slice(1),t=(e=i[o.locale].attributes[this.obj.getIdentity()])&&e[this.attr]||r,n=(n=null!=this.opts.message?this.opts.message:i[o.locale].errors.messages.confirmation).replace("%{attribute}",t),this.obj.addErrorMessage(n,{for:this._properAttr()})},e.prototype._properAttr=function(){return this.attr+"Confirmation"},e}(d),v={}.hasOwnProperty,g=function(t){function e(){e.__super__.constructor.call(this)}return function(t,e){for(var r in e)v.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(e,t),e.identity="Exclusion",e.prototype.validate=function(){if(-1!==(this.opts.in||this.opts.within||[]).indexOf(this.val))return this._addErrorMessage()},e.prototype._addErrorMessage=function(){var t;return t=null!=this.opts.message?this.opts.message:i[o.locale].errors.messages.exclusion,this.obj.addErrorMessage(t,{for:this.attr})},e}(d),_={}.hasOwnProperty,w=function(t){function e(){e.__super__.constructor.call(this)}return function(t,e){for(var r in e)_.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(e,t),e.identity="Format",e.prototype.validate=function(){if(null==this.opts.with.exec(this.val))return this._addErrorMessage()},e.prototype._addErrorMessage=function(){var t;return t=null!=this.opts.message?this.opts.message:i[o.locale].errors.messages.invalid,this.obj.addErrorMessage(t,{for:this.attr})},e}(d),O={}.hasOwnProperty,j=function(t){function e(){e.__super__.constructor.call(this)}return function(t,e){for(var r in e)O.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(e,t),e.identity="Inclusion",e.prototype.validate=function(){if(-1===(this.opts.in||this.opts.within||[]).indexOf(this.val))return this._addErrorMessage()},e.prototype._addErrorMessage=function(){var t;return t=null!=this.opts.message?this.opts.message:i[o.locale].errors.messages.inclusion,this.obj.addErrorMessage(t,{for:this.attr})},e}(d),E={}.hasOwnProperty,S=function(t){function e(){e.__super__.constructor.call(this)}return function(t,e){for(var r in e)E.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(e,t),e.identity="Length",e.prototype.validate=function(){var t;if(null!=this.val&&null!==(t=null!=this._range()[0]&&null!=this._range()[1]&&this._range()[0]===this._range()[1]&&this.val.length!==this._range()[0]?this._selectErrorMessage("wrong_length",this._range()[0]):null!=this._range()[0]&&this.val.length<this._range()[0]?this._selectErrorMessage("too_short",this._range()[0]):null!=this._range()[1]&&this.val.length>this._range()[1]?this._selectErrorMessage("too_long",this._range()[1]):null))return this.obj.addErrorMessage(t,{for:this.attr})},e.prototype._range=function(){return[this.opts.minimum||this.opts.is||null!=this.opts.within&&this.opts.within[0]||null,this.opts.maximum||this.opts.is||null!=this.opts.within&&this.opts.within[1]||null]},e.prototype._selectErrorMessage=function(t,e){var r,n,a,u,c;if(1===e)return i[o.locale].errors.messages[t].one;for(a=null,r=0,n=(u=["few","many"]).length;r<n;r++)if(c=u[r],this._checkVariant(c,e)){a=i[o.locale].errors.messages[t][c];break}return null==a&&(a=i[o.locale].errors.messages[t].other),null!=this.opts.message&&(a=this.opts.message),/%{count}/.exec(a)&&(a=a.replace("%{count}",e)),a},e.prototype._checkVariant=function(t,e){if(null!=i[o.locale].variants[t])return i[o.locale].variants[t](e)},e}(d),P={}.hasOwnProperty,k=function(t){function e(){e.__super__.constructor.call(this)}return function(t,e){for(var r in e)P.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(e,t),e.identity="Numericality",e.prototype.validate=function(){return isNaN(this.val)?this._addNaNErrorMessage():null!=this.opts.only_integer&&Number(this.val)!==parseInt(this.val)?this._addIntErrorMessage():null!=this.opts.greater_than&&Number(this.val)<=this.opts.greater_than?this._addGreatherThanErrorMessage():null!=this.opts.greater_than_or_equal_to&&Number(this.val)<this.opts.greater_than_or_equal_to?this._addGreatherThanOrEqualToErrorMessage():null!=this.opts.equal_to&&Number(this.val)!==this.opts.equal_to?this._addEqualToErrorMessage():null!=this.opts.less_than&&Number(this.val)>=this.opts.less_than?this._addLessThanErrorMessage():null!=this.opts.less_than_or_equal_to&&Number(this.val)>this.opts.less_than_or_equal_to?this._addLessThanOrEqualToErrorMessage():null!=this.opts.other_than&&Number(this.val)===this.opts.other_than?this._addOtherThanErrorMessage():null!=this.opts.odd&&Number(this.val)%2!=1?this._addOddErrorMessage():null!=this.opts.even&&Number(this.val)%2!=0?this._addEvenErrorMessage():void 0},e.prototype._addNaNErrorMessage=function(){var t;return t=null!=this.opts.message?this.opts.message:i[o.locale].errors.messages.not_a_number,this.obj.addErrorMessage(t,{for:this.attr})},e.prototype._addIntErrorMessage=function(){var t;return t=i[o.locale].errors.messages.not_an_integer,this.obj.addErrorMessage(t,{for:this.attr})},e.prototype._addGreatherThanErrorMessage=function(){var t;return t=(t=i[o.locale].errors.messages.greater_than).replace("%{count}",this.opts.greater_than),this.obj.addErrorMessage(t,{for:this.attr})},e.prototype._addGreatherThanOrEqualToErrorMessage=function(){var t;return t=(t=i[o.locale].errors.messages.greater_than_or_equal_to).replace("%{count}",this.opts.greater_than_or_equal_to),this.obj.addErrorMessage(t,{for:this.attr})},e.prototype._addEqualToErrorMessage=function(){var t;return t=(t=i[o.locale].errors.messages.equal_to).replace("%{count}",this.opts.equal_to),this.obj.addErrorMessage(t,{for:this.attr})},e.prototype._addLessThanErrorMessage=function(){var t;return t=(t=i[o.locale].errors.messages.less_than).replace("%{count}",this.opts.less_than),this.obj.addErrorMessage(t,{for:this.attr})},e.prototype._addLessThanOrEqualToErrorMessage=function(){var t;return t=(t=i[o.locale].errors.messages.less_than_or_equal_to).replace("%{count}",this.opts.less_than_or_equal_to),this.obj.addErrorMessage(t,{for:this.attr})},e.prototype._addOtherThanErrorMessage=function(){var t;return t=(t=i[o.locale].errors.messages.other_than).replace("%{count}",this.opts.other_than),this.obj.addErrorMessage(t,{for:this.attr})},e.prototype._addOddErrorMessage=function(){var t;return t=i[o.locale].errors.messages.odd,this.obj.addErrorMessage(t,{for:this.attr})},e.prototype._addEvenErrorMessage=function(){var t;return t=i[o.locale].errors.messages.even,this.obj.addErrorMessage(t,{for:this.attr})},e}(d),x={}.hasOwnProperty,I=function(t){function e(){e.__super__.constructor.call(this)}return function(t,e){for(var r in e)x.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(e,t),e.identity="Presence",e.prototype.validate=function(){switch(typeof this.val){case"string":if(null!=this.val&&this.val.length>0)return;break;default:if(null!=this.val)return}return this._addErrorMessage()},e.prototype._addErrorMessage=function(){var t;return t=null!=this.opts.message?this.opts.message:i[o.locale].errors.messages.blank,this.obj.addErrorMessage(t,{for:this.attr})},e}(d),A={}.hasOwnProperty;u=function(t){function e(){e.__super__.constructor.call(this)}return function(t,e){for(var r in e)A.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(e,t),e.identity="Size",e.prototype.validate=function(){return S.instance(this.obj,this.attr,this.opts).validate()},e}(d);var R={Absence:h,Base:d,Confirmation:b,Exclusion:g,Format:w,Inclusion:j,Length:S,Numericality:k,Presence:I,Size:u},T=function(t,e,r){var n=function(t){var e={};if(!t)return e;var r=["resource","total","count"];return Object.keys(t).forEach((function(n){-1===r.indexOf(n)&&(e[n]=t[n])})),e}(r),o="GET"===t?"".concat(e,"?").concat(function(t){var e="";return Object.keys(t).forEach((function(r){""!==e&&(e="".concat(e,"&")),e="".concat(e).concat(r,"=").concat(encodeURIComponent(t[r]))})),e}(n)):e,i=document.querySelector("meta[name='csrf-token']"),a=new XMLHttpRequest;return a.open(t,o),a.setRequestHeader("Accept","application/json"),a.setRequestHeader("Content-Type","application/json"),i&&a.setRequestHeader("X-CSRF-Token",i.content),a.send(JSON.stringify(n)),a},C=function(){function t(t){null==t&&(t={}),this.id=null,this.errors=null,this.resource=t.resource,null!=this.constructor.attributes&&this.__initAttributes(),null!=t&&this.__assignAttributes(t)}return t.getIdentity=function(){if(null!=this.identity)return this.identity;throw"Specify Model's identity!"},t.getRemoteName=function(){return null!=this.remoteName?this.remoteName:this.getIdentity()},t.all=function(t){return null==t&&(t={}),this.get("all",t)},t.get=function(t,e){return null==e&&(e={}),this.__send("GET",t,e)},t.post=function(t,e){return null==e&&(e={}),this.__send("POST",t,e)},t.put=function(t,e){return null==e&&(e={}),this.__send("PUT",t,e)},t.patch=function(t,e){return null==e&&(e={}),this.__send("PATCH",t,e)},t.delete=function(t,e){return null==e&&(e={}),this.__send("DELETE",t,e)},t.find=function(t){var e,r,n,o;return n={},"object"==typeof t?(n=t,e=t.id,delete n.id):e=t,r=T("GET",this.__getResourcesUrl(n)+"/"+e,n),new Promise((o=this,function(e,n){return r.onerror=function(t){return n(t)},r.onload=function(r){var n;return n=JSON.parse(r.target.response),e(o.__initFromJSON(n,t.resource))}}))},t.getAttribRemoteName=function(t){return null==this.attributes||null==this.attributes[t]?null:null==this.attributes[t].remoteName?t:this.attributes[t].remoteName},t.getResourcesUrlParams=function(t){var e,r,n,o;for(o=this.__getResourcesUrl({resource:t.resource}),n=/:(\w+)\/?/,r=[];e=n.exec(o);)r.push(e[1]),o=o.replace(e[0],e[1]);return r},t.__getResourcesUrl=function(t){var e,r;return r=null==this.resources?"/"+this.getRemoteName().toLowerCase()+"s":t.resource?this.resources[t.resource].url:null!=o.scope&&null!=this.resources[o.scope]?this.resources[o.scope].url:this.resources.url,null!=o.protocolWithHost&&(r=""+o.protocolWithHost+r),null==(e=/:(\w+)\/?/.exec(r))||(null!=t[e[1]]?(r=r.replace(":"+e[1],t[e[1]]),delete t[e[1]]):null!=t.obj&&null!=t.obj[e[1]]&&(r=r.replace(":"+e[1],t.obj[e[1]]))),r},t.__page=function(t,e,r){var n,o,i;return o=e.url,e.params[e.pageParam]=t,n=T(e.method,o,e.params),new Promise((i=this,function(t,o){return n.onerror=function(t){return o(t)},n.onload=function(n){var o,a,u,c,s,l,f,p,d,m;if((o=JSON.parse(n.target.response)).constructor===Array)for(a=0,s=o.length;a<s;a++)p=o[a],f=i.__initFromJSON(p,e.resource),r.push(f);else if(null!=o.resources){for(r.constructor===Array&&(r={resources:[],count:0}),u=0,l=(d=o.resources).length;u<l;u++)p=d[u],f=i.__initFromJSON(p,e.resource),r.resources.push(f);r.count=o.count}else for(c in o)m=o[c],r[c]=m;return t(r)}}))},t.__paginate=function(t){var e,r;return e={method:t.method,url:t.url,params:t.params,pageParam:t.pageParam,resource:t.resource},this.__page(t.pageNum||1,e,[]).then((r=this,function(n){var o,i,a,u,c,s;if(s=n.count||t.total,u=Promise.resolve(n),null!=t.pageNum)return u;if(s<=t.perPage)return u;if((a=parseInt(s/t.perPage))!==s/t.perPage&&(a+=1),1===a)return u;for(o=i=2,c=a;2<=c?i<=c:i>=c;o=2<=c?++i:--i)!function(t){u=u.then((function(o){return r.__page(t,e,n)}))}(o);return u}))},t.__getPaginationParam=function(t){var e,r,n,i,a;return null!=t&&null!=this.resources&&this.resources[t]?(null!=(e=this.resources[t].paginate)?e.param:void 0)||"page":null!=o.scope&&null!=this.resources&&null!=this.resources[o.scope]?(null!=(r=this.resources[o.scope])&&null!=(n=r.paginate)?n.param:void 0)||"page":null!=(null!=(i=this.resources)&&null!=(a=i.paginate)?a.param:void 0)?this.resources.paginate.param:"page"},t.__getPaginationPer=function(t){var e,r,n,i,a;return null!=t&&null!=this.resources&&this.resources[t]?null!=(e=this.resources[t].paginate)?e.per:void 0:null!=o.scope&&null!=this.resources&&null!=this.resources[o.scope]?null!=(r=this.resources[o.scope])&&null!=(n=r.paginate)?n.per:void 0:null!=(null!=(i=this.resources)&&null!=(a=i.paginate)?a.per:void 0)?this.resources.paginate.per:null},t.__send=function(t,e,r){var n,o;return o=this.__getResourcesUrl(r),"all"!==e&&(o=o+"/"+e),n={method:t,url:o,params:r,resource:r.resource,perPage:this.__getPaginationPer(r.resource),pageNum:r.page,pageParam:this.__getPaginationParam(r.resource),total:r.total||r.count},this.__paginate(n)},t.__initFromJSON=function(t,e){var r;return(r=new this(t)).resource=e,p.add(r),r},t.prototype.setResource=function(t){return this.resource=t},t.prototype.getIdentity=function(){return this.constructor.getIdentity()},t.prototype.getAttrRemoteName=function(t){return null==this.constructor.attributes||null==this.constructor.attributes[t]?null:this.constructor.attributes[t].remoteName||t},t.prototype.getAttrName=function(t){var e,r;if(null==this.constructor.attributes)return t;if(null!=this.constructor.attributes[t])return t;for(e in r=this.constructor.attributes)if(r[e].remoteName===t)return e;return t},t.prototype.getAttrType=function(t){return null==this.constructor.attributes||null==this.constructor.attributes[t]?null:this.constructor.attributes[t].type},t.prototype.assignAttr=function(t,e){var r;if(r=this.getAttrType(t),null!=e){switch(r){case"Date":e=new Date(Date.parse(e));break;case"Integer":case"Int":e=parseInt(e);break;case"Float":e=parseFloat(e);break;case"Boolean":case"Bool":e="boolean"==typeof e?e:Boolean(parseInt(e));break;case"Number":e=Number(e);break;case"String":e=String(e)}return this[t]=e}this[t]=null},t.prototype.attributes=function(){var t,e,r;if(t={id:this.id},null==this.constructor.attributes)return t;for(e in r=this.constructor.attributes)r[e],t[e]=this[e];return t},t.prototype.isValid=function(){var t,e,r,n,o,i,a,u,c,s,l;if(null==this.constructor.attributes)return!0;for(n in this.errors=null,i=this.constructor.attributes)if(null!=(t=i[n]).validations)for(c in a=t.validations)s=a[c],null!=this.id&&"create"===s.on||null==this.id&&"update"===s.on||(null==s.if||s.if(this))&&(l=c.charAt(0).toUpperCase()+c.slice(1),null!=R[l]?(o=this.__processedValidationSettings(s),R[l].instance(this,n,o).validate()):console.warn('"'+l+'" validator is not implemented!'));if(null!=this.constructor.validate)for(e=0,r=(u=this.constructor.validate).length;e<r;e++)this[u[e]]();return null==this.errors},t.prototype.isInvalid=function(){return!this.isValid()},t.prototype.isEmpty=function(){var t,e;for(t in e=this.attributes())if(e[t],null!==this[t])return!1;return!0},t.prototype.addErrorMessage=function(t,e){return null==e&&(e={}),null==this.errors&&(this.errors={}),null==this.errors[e.for]&&(this.errors[e.for]=[]),this.errors[e.for].push(t)},t.prototype.save=function(){var t,e,r;return t=null!=this.id?"PUT":"POST",e=T(t,this.__getResourceUrl(),this.serialize()),new Promise((r=this,function(t,n){return e.onerror=function(t){return n(t)},e.onload=function(e){var n;if(!(n=JSON.parse(e.target.response)).success)return null!=n.errors&&r.__assignRemoteErrorMessages(n.errors),t(n);t(n)}}))},t.prototype.updateAttribute=function(t){var e,r;return e=T("PUT",this.__getResourceUrl(),this.serialize(t)),new Promise((r=this,function(t,n){return e.onerror=function(t){return n(t)},e.onload=function(e){var o;return e.target.status>=200&&e.target.status<400?(o=JSON.parse(e.target.response)).success?void t(o):(null!=o.errors&&r.__assignRemoteErrorMessages(o.errors),t(o)):e.target.status>=500?n(e):void 0}}))},t.prototype.serialize=function(t){var e,r,n,o;if(null==t&&(t=null),null==this.constructor.attributes)return{};for(t in(r={})[n=this.constructor.getRemoteName().toLowerCase()]={},e={},null!=t?e[t]=null:e=this.constructor.attributes,e)e[t],o=this.getAttrRemoteName(t),r[n][o]=this[t];return r},t.prototype.reload=function(){var t,e,r,n,o;for(t={id:this.id,resource:this.resource},e=0,r=(o=this.constructor.getResourcesUrlParams({resource:this.resource})).length;e<r;e++)t[n=o[e]]=this[n];return this.constructor.find(t)},t.prototype.changes=function(){var t,e,r,n,o;for(e in n={},t=p.find(this.getIdentity(),this.id),r=this.attributes())if((o=r[e])!==t[e]){if(null!=o&&o.constructor===Date&&t[e]-o==0)continue;o!==t[e]&&(n[e]={is:t[e],was:o})}return n},t.prototype.applyChanges=function(){var t,e,r,n;for(t in r=[],e=this.changes())n=e[t],r.push(this[t]=n.is);return r},t.prototype.toKey=function(){return this.getIdentity().toLowerCase()+"_"+this.id},t.prototype.get=function(t,e){return null==e&&(e={}),this.__send("GET",t,e)},t.prototype.post=function(t,e){return null==e&&(e={}),this.__send("POST",t,e)},t.prototype.put=function(t,e){return null==e&&(e={}),this.__send("PUT",t,e)},t.prototype.patch=function(t,e){return null==e&&(e={}),this.__send("PATCH",t,e)},t.prototype.delete=function(t,e){return null==e&&(e={}),this.__send("DELETE",t,e)},t.prototype.__send=function(t,e,r){var n,o;return o=this.__getResourceUrl(),null!=e&&(o=o+"/"+e),n=T(t,o,r),new Promise((function(t,e){return n.onerror=function(t){return e(t)},n.onload=function(n){return n.target.status>=200&&n.target.status<400?(r=JSON.parse(n.target.response),t(r)):n.target.status>=500?e(n):void 0}}))},t.prototype.__assignAttributes=function(t){var e,r,n,o;for(r in n=[],t)o=t[r],e=this.getAttrName(r),n.push(this.assignAttr(e,o));return n},t.prototype.__initAttributes=function(){var t,e,r;for(t in r=[],e=this.constructor.attributes)e[t],r.push(this[t]=null);return r},t.prototype.__assignRemoteErrorMessages=function(t){var e,r,n,o,i;for(o in i=[],t)n=t[o],e=this.getAttrName(o),i.push(function(){var t,o,i;for(i=[],t=0,o=n.length;t<o;t++)r=n[t],i.push(this.addErrorMessage(r,{for:e}));return i}.call(this));return i},t.prototype.__getResourceUrl=function(){var t;return t=this.constructor.__getResourcesUrl({resource:this.resource,obj:this}),null==this.id?t:t+"/"+this.id},t.prototype.__processedValidationSettings=function(t){var e,r,n;for(e in n={},t)r=t[e],n[e]="function"==typeof r?r(this):r;return n},t}();function M(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function N(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}C.prototype.clone=function(){return new this.constructor(function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?M(Object(r),!0).forEach((function(e){N(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):M(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},this.attributes()))};var q={Base:C}}])},167:function(t,e,r){"use strict";r.r(e);r(124),r(125);var n=r(121);r.n(n).a.start();var o=r(1),i=r(17),a=r(122);r(5),r(6),r(7),r(56),r(32),r(96),r(4),r(103),r(104),r(105),r(3),r(19),r(16),r(8),r(116),r(9),r(20);function u(t){return{type:"ADD_ARTICLES",articles:t}}function c(t){return{type:"SET_ARTICLES",articles:t}}function s(t,e){return{type:"UPDATE_ARTICLE",article:t,index:e}}function l(t,e){return{type:"ADD_COMMENTS",articleId:e,comments:t}}function f(t,e){return{type:"SET_COMMENTS",comments:t,articleId:e}}function p(t,e,r){return{type:"UPDATE_COMMENT",comment:t,articleId:e,index:r}}var d=r(58),m=(r(30),r(39)),h=Object(m.a)((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"ADD_ARTICLES":return t.concat(e.articles);case"PREPEND_ARTICLES":return e.articles.concat(t);case"REMOVE_ARTICLE":return t.filter((function(t){return t.id!==e.id}));case"SET_ARTICLES":return e.articles;case"UPDATE_ARTICLE":t[e.index]=e.article;break;default:return t}})),y=(r(78),Object(m.a)((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"ADD_COMMENTS":t[e.articleId]=t[e.articleId].concat(e.comments);break;case"REMOVE_COMMENT":if(null==t[e.articleId])return t;t[e.articleId]=t[e.articleId].filter((function(t){return t.id!==e.id}));break;case"SET_COMMENTS":t[e.articleId]=e.comments;break;case"UPDATE_COMMENT":var r=e.articleId,n=e.index;if(!n){var o=t[r].find((function(t){return t.id===e.comment.id}));n=t[r].indexOf(o)}t[r][n]=e.comment;break;default:return t}}))),b=Object(m.a)((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"SET_USERS":return e.users;case"PREPEND_USERS":return e.users.concat(t);default:return t}})),v=Object(d.a)({articles:h,comments:y,users:b}),g=Object(d.b)(v),_=function(t){return function(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=e[t];n.parentId&&(o=o[n.parentId]);var i=o.find((function(t){return t.id===r}));if(!i)return[null,null];var a=o.indexOf(i);return[i,a]}},w=_("articles"),O=_("comments");r(14),r(33);function j(t){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function E(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function S(t,e){return!e||"object"!==j(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function P(t){return(P=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function k(t,e){return(k=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function x(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var I=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=S(this,P(e).call(this,t))).published=null!=r.publishedAt,r}var r,n,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&k(t,e)}(e,t),r=e,(n=[{key:"vulgarityLevel",value:function(){(null!=this.title&&/fuck/i.exec(this.title)||null!=this.content&&/fuck/i.exec(this.content))&&this.addErrorMessage("Article contains strong language.",{for:"base"})}},{key:"setDefaultValuesForAdminReview",value:function(){this.adminRate=null==this.adminRate?3:this.adminRate,this.categoryId=null==this.categoryId?6:this.categoryId,this.adminReviewStartedAt=Date.now()}}])&&E(r.prototype,n),o&&E(r,o),e}(o.Models.Base);x(I,"identity","Article"),x(I,"resources",{url:"/user/articles",paginate:{per:5},main:{url:"/articles",paginate:{per:3}},admin:{url:"/admin/articles",paginate:{per:4}}}),x(I,"attributes",{title:{validations:{presence:!0,length:{within:[3,255]}}},content:{validations:{presence:!0,length:{minimum:100}},remoteName:"text"},createdAt:{type:"Date",remoteName:"created_at"},updatedAt:{type:"Date",remoteName:"updated_at"},commentsCount:{type:"Int",remoteName:"comments_count"},publishedAt:{type:"Date",remoteName:"published_at"},published:{},adminReview:{remoteName:"admin_review"},adminRate:{type:"Int",remoteName:"admin_rate"},categoryId:{type:"Int",remoteName:"category_id"},adminReviewStartedAt:{remoteName:"admin_review_started_at"}}),x(I,"validate",["vulgarityLevel"]);var A=I;function R(t){return(R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function T(t,e){return!e||"object"!==R(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function C(t){return(C=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function M(t,e){return(M=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function N(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var q=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),T(this,C(e).call(this,t))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&M(t,e)}(e,t),e}(o.Models.Base);N(q,"identity","Article.Comment"),N(q,"remoteName","Comment"),N(q,"resources",{url:"/user/articles/:articleId/comments",paginate:{per:10},main:{url:"/articles/:articleId/comments",paginate:{per:5,param:"page-num"}},admin:{url:"/admin/articles/:articleId/comments",paginate:{per:5}}}),N(q,"attributes",{author:{validations:{presence:!0}},text:{validations:{presence:!0,vulgarity:!0}},articleId:{type:"Int",validations:{presence:!0},remoteName:"article_id"},createdAt:{type:"Date",remoteName:"created_at"},updatedAt:{type:"Date",remoteName:"updated_at"},emotion:{type:"Int"},pinned:{type:"Boolean"},adminRate:{type:"Int",remoteName:"admin_rate"},approved:{type:"Boolean"}});var D=q;function B(t){return(B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function L(t,e){return!e||"object"!==B(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function z(t){return(z=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function F(t,e){return(F=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function U(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var V=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),L(this,z(e).call(this,t))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&F(t,e)}(e,t),e}(o.Models.Base);U(V,"identity","User"),U(V,"resources",{url:"/users",admin:{url:"/admin/users"}}),U(V,"paginate",{per:10}),U(V,"attributes",{email:{validations:{presence:!0,format:{with:/^([^@\s]+)@((?:[-a-z0-9]+\.)+[a-z]{2,})$/i}}},username:{validations:{presence:!0,format:{with:/^[a-z][a-z0-9_-]*$/i}}},password:{validations:{presence:{on:"create"},confirmation:!0}},passwordConfirmation:{remoteName:"password_confirmation"},confirmed:{},createdAt:{type:"Date",remoteName:"created_at"},updatedAt:{type:"Date",remoteName:"updated_at"}});var H=V,W=(r(38),function(t){t.classList.remove("notice"),t.classList.remove("alert"),t.classList.remove("warning")}),J=function(t,e,r){null!=t[e]&&(r.classList.add(e),document.querySelector(".flash p").textContent=t[e])},G=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4e3;setTimeout((function(){document.querySelector(".flash").classList.add("none")}),t)},Y=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.hide,r=document.querySelector(".flash");W(r),J(t,"notice",r),J(t,"alert",r),J(t,"warning",r),r.classList.remove("none"),e&&G()},X={disconnectedForTooLong:function(){Y({alert:"You have been disconnected from the server for too long. Reload page!",hide:!1})}},$=r(0),K=r.n($),Z=r(15),Q=(r(34),r(2)),tt=r.n(Q);r(57);function et(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function rt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var nt=function(){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object(o.getLocale)();et(this,t),this.date=e,this.skope=o.I18n[r].date}var e,r,n;return e=t,(r=[{key:"toString",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default",e=this.skope.formats;switch(t){case"default":return this.strftime(e.default);case"short":return this.strftime(e.short);case"long":return this.strftime(e.long);default:console.log("Services.Date#toString: unknown format.")}}},{key:"strftime",value:function(t){t=(t=t.replace("%Y",this.date.getFullYear())).replace("%y",this.date.getFullYear().toString().substr(-2,2));var e=this.date.getMonth()+1;return e=e>=10?e:"0".concat(e),(t=(t=(t=(t=(t=(t=t.replace("%m",e)).replace("%b",this.skope.abbr_month_names[this.date.getMonth()])).replace("%B",this.skope.month_names[this.date.getMonth()])).replace("%d",this.date.getDate()>=10?this.date.getDate():"0".concat(this.date.getDate()))).replace("%H",this.date.getHours()>=10?this.date.getHours():"0".concat(this.date.getHours()))).replace("%M",this.date.getMinutes()>=10?this.date.getMinutes():"0".concat(this.date.getMinutes()))).replace("%S",this.date.getSeconds()>=10?this.date.getSeconds():"0".concat(this.date.getSeconds()))}}])&&rt(e.prototype,r),n&&rt(e,n),t}();function ot(t){var e=t.comment,r=new nt(e.createdAt).strftime("%d %b %y");return K.a.createElement("p",{id:"comment_".concat(e.id)},K.a.createElement("b",null,e.author)," on ",K.a.createElement("i",null,r)," (",K.a.createElement("a",{href:"/admin/articles/".concat(e.articleId,"/comments/").concat(e.id,"/edit")},"edit"),")",K.a.createElement("br",null),e.text)}ot.propTypes={comment:tt.a.instanceOf(D).isRequired};var it=ot;function at(t){var e=t.comments;return 0===e.length?K.a.createElement("p",null,"No comments"):K.a.createElement(K.a.Fragment,null,e.map((function(t){return K.a.createElement(it,{comment:t,key:t.id})})))}at.propTypes={comments:tt.a.arrayOf(tt.a.instanceOf(D)).isRequired};var ut=at;function ct(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}var st=function(t){document.getElementById("article_author").textContent=t.author,document.getElementById("article_title").textContent=t.title,document.getElementById("article_text").textContent=t.content},lt=function(t){return function(){var e,r=(e=regeneratorRuntime.mark((function e(r){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=r,e.next="updated"===e.t0?3:7;break;case 3:return e.next=5,t.reload();case 5:n=e.sent,st(n);case 7:case"end":return e.stop()}}),e)})),function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(t){ct(i,n,o,a,u,"next",t)}function u(t){ct(i,n,o,a,u,"throw",t)}a(void 0)}))});return function(t){return r.apply(this,arguments)}}()},ft=function(t){Object(o.subscribe)({to:t,with:lt(t)}),st(t)},pt=function(t){Object(Z.render)(K.a.createElement(ut,{comments:t}),document.getElementById("comments"))},dt=function(t){t.setDefaultValuesForAdminReview(),new i.UI.Form({id:"edit_article_form",for:t}).render()};function mt(t){var e=t.article,r=new nt(e.publishedAt).toString("short");return K.a.createElement("article",{id:"article_".concat(e.id)},K.a.createElement("h2",null,e.title),K.a.createElement("p",null,K.a.createElement("i",null,e.author," wrote this on ",r," /"," ",K.a.createElement("span",{className:"comments_quantity"},e.commentsCount," comment",1===e.commentsCount?"":"s"))),K.a.createElement("p",null,e.content),K.a.createElement("p",null,K.a.createElement("a",{href:"/admin/articles/".concat(e.id,"/edit")},"Review")))}mt.propTypes={article:tt.a.instanceOf(A).isRequired};var ht=mt;function yt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t))&&"[object Arguments]"!==Object.prototype.toString.call(t))return;var r=[],n=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{n||null==u.return||u.return()}finally{if(o)throw i}}return r}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function bt(t){var e=yt(Object($.useState)(t.articles),2),r=e[0],n=e[1];Object($.useEffect)((function(){var t=g.subscribe((function(){return n(g.getState().articles)}));return function(){t()}}));var o=r.map((function(t){return K.a.createElement(ht,{key:t.id,article:t})}));return K.a.createElement(K.a.Fragment,null,o)}bt.propTypes={articles:tt.a.arrayOf(tt.a.instanceOf(A)).isRequired};var vt=bt;function gt(t){return(gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function wt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ot(t,e){return!e||"object"!==gt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function jt(t){return(jt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Et(t,e){return(Et=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function St(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function Pt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){St(i,n,o,a,u,"next",t)}function u(t){St(i,n,o,a,u,"throw",t)}a(void 0)}))}}var kt=function(){var t=Pt(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,A.find(o.helpers.params.id);case 2:e=t.sent,ft(e),dt(e);case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),xt=function(){var t=Pt(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,D.all({articleId:o.helpers.params.id});case 2:e=t.sent,pt(e.resources);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),It=function(t){function e(){return _t(this,e),Ot(this,jt(e).apply(this,arguments))}var r,n,o,i,a;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Et(t,e)}(e,t),r=e,(n=[{key:"published",value:(a=Pt(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,A.get("published");case 2:e=t.sent,g.dispatch(c(e.resources)),Object(Z.render)(K.a.createElement(vt,{articles:e.resources}),document.getElementById("articles"));case 5:case"end":return t.stop()}}),t)}))),function(){return a.apply(this,arguments)})},{key:"edit",value:(i=Pt(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:kt(),xt();case 2:case"end":return t.stop()}}),t)}))),function(){return i.apply(this,arguments)})}])&&wt(r.prototype,n),o&&wt(r,o),e}(o.Controllers.Base);function At(t){return(At="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Rt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Tt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ct(t,e){return!e||"object"!==At(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Mt(t){return(Mt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Nt(t,e){return(Nt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var qt=function(t){function e(){return Rt(this,e),Ct(this,Mt(e).apply(this,arguments))}var r,n,a;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Nt(t,e)}(e,t),r=e,(n=[{key:"edit",value:function(){!function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=new i.UI.Form({for:new D({id:t.commentId,resource:"admin"}),id:"edit_comment_".concat(t.commentId),initObj:!0});e.render(),window.test={commentFormObj:e.getObj()}}({commentId:o.helpers.params.id})}}])&&Tt(r.prototype,n),a&&Tt(r,a),e}(o.Controllers.Base),Dt=function(){return window.location.href="/admin"};function Bt(t){return(Bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Lt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function zt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ft(t,e){return!e||"object"!==Bt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ut(t){return(Ut=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Vt(t,e){return(Vt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ht=function(t){function e(){return Lt(this,e),Ft(this,Ut(e).apply(this,arguments))}var r,n,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Vt(t,e)}(e,t),r=e,(n=[{key:"new",value:function(){new i.UI.Form({id:"sign_in_admin",callbackSuccess:Dt}).render()}}])&&zt(r.prototype,n),o&&zt(r,o),e}(o.Controllers.Base),Wt=function(t){var e=t.user;return K.a.createElement("tr",{id:"user_".concat(e.id)},K.a.createElement("td",null,e.email),K.a.createElement("td",null,e.username),K.a.createElement("td",{className:"confirmed"},e.confirmed?"Yes":"No"),K.a.createElement("td",null,K.a.createElement("a",{href:"/admin/users/".concat(e.id)},"Show")," |"," ",K.a.createElement("a",{href:"/admin/users/".concat(e.id,"/edit")},"Edit")," |"," ",K.a.createElement("a",{href:"/admin/users/".concat(e.id),"data-method":"delete","data-confirm":"Are you sure?"},"Delete")," ","|"," ",K.a.createElement("a",{href:"#",onClick:function(t){return function(t,e){t.preventDefault(),Object(o.emit)({type:"PING",user_id:e})}(t,e.id)}},"Ping")))};Wt.propTypes={user:tt.a.instanceOf(H).isRequired};var Jt=Wt;function Gt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t))&&"[object Arguments]"!==Object.prototype.toString.call(t))return;var r=[],n=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{n||null==u.return||u.return()}finally{if(o)throw i}}return r}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Yt(t){var e=Gt(Object($.useState)(t.users),2),r=e[0],n=e[1];Object($.useEffect)((function(){var t=g.subscribe((function(){return n(g.getState().users)}));return function(){t()}}));var o=r.map((function(t){return K.a.createElement(Jt,{key:"user_".concat(t.id),user:t})}));return K.a.createElement(K.a.Fragment,null,o)}Yt.propTypes={users:tt.a.arrayOf(tt.a.instanceOf(H)).isRequired};var Xt=Yt,$t=function(t){document.getElementById("user_email").textContent=t.email,document.getElementById("user_username").textContent=t.username,document.getElementById("user_confirmed").textContent=t.confirmed?"Yes":"No",function(t){var e=document.getElementById("edit_link"),r=e.getAttribute("href");e.setAttribute("href",r.replace("/0/","/".concat(t.id,"/")))}(t)};function Kt(t){return(Kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zt(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function Qt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Zt(i,n,o,a,u,"next",t)}function u(t){Zt(i,n,o,a,u,"throw",t)}a(void 0)}))}}function te(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ee(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function re(t,e){return!e||"object"!==Kt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ne(t){return(ne=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function oe(t,e){return(oe=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ie=function(t){function e(){return te(this,e),re(this,ne(e).apply(this,arguments))}var r,n,a,u,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&oe(t,e)}(e,t),r=e,(n=[{key:"index",value:(c=Qt(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,H.get("all");case 2:e=t.sent,g.dispatch({type:"PREPEND_USERS",users:e.resources}),Object(Z.render)(K.a.createElement(Xt,{users:e.resources}),document.querySelector("table tbody"));case 5:case"end":return t.stop()}}),t)}))),function(){return c.apply(this,arguments)})},{key:"show",value:(u=Qt(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,H.find(o.helpers.params.id);case 2:e=t.sent,$t(e);case 4:case"end":return t.stop()}}),t)}))),function(){return u.apply(this,arguments)})},{key:"edit",value:function(){var t;t=new H({id:o.helpers.params.id}),new i.UI.Form({for:t,initObj:!0,id:"admin_user_form"}).render()}}])&&ee(r.prototype,n),a&&ee(r,a),e}(o.Controllers.Base);function ae(t){return(ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ue(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ce(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function se(t,e){return!e||"object"!==ae(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function le(t){return(le=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function fe(t,e){return(fe=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Object.assign(o.Controllers.Base.prototype,X);var pe=function(t){function e(){return ue(this,e),se(this,le(e).apply(this,arguments))}var r,n,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&fe(t,e)}(e,t),r=e,(n=[{key:"initialize",value:function(){this.setScope("admin")}}])&&ce(r.prototype,n),o&&ce(r,o),e}(o.Controllers.Base);Object.assign(pe,{Articles:It,Comments:qt,Sessions:Ht,Users:ie});var de=pe,me=function(t,e){return t.comments[e]};function he(t){var e=t.comment,r=new nt(e.createdAt).strftime("%d %b %y");return K.a.createElement("p",{id:"comment_".concat(e.id)},K.a.createElement("b",null,e.author)," on ",K.a.createElement("i",null,r)," wrote:",K.a.createElement("br",null),e.text)}he.propTypes={comment:tt.a.instanceOf(D).isRequired};var ye=he;function be(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t))&&"[object Arguments]"!==Object.prototype.toString.call(t))return;var r=[],n=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{n||null==u.return||u.return()}finally{if(o)throw i}}return r}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function ve(t){var e=t.articleId,r=be(Object($.useState)(t.comments),2),n=r[0],o=r[1];Object($.useEffect)((function(){var t=g.subscribe((function(){o(me(g.getState(),e))}));return function(){t()}}));var i=n.map((function(t){return K.a.createElement(ye,{key:t.id,comment:t})}));return 0===n.length?K.a.createElement("p",{id:"no_comments"},"No comments."):K.a.createElement(K.a.Fragment,null,i)}ve.propTypes={articleId:tt.a.number.isRequired,comments:tt.a.arrayOf(tt.a.instanceOf(D)).isRequired};var ge=ve;function _e(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t))&&"[object Arguments]"!==Object.prototype.toString.call(t))return;var r=[],n=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{n||null==u.return||u.return()}finally{if(o)throw i}}return r}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function we(t){var e=_e(Object($.useState)(t.comments),2),r=e[0],n=e[1];return Object($.useEffect)((function(){var e=g.subscribe((function(){n(me(g.getState(),t.articleId))}));return function(){e()}})),K.a.createElement(K.a.Fragment,null,"".concat(r.length," comment").concat(1===r.length?"":"s"))}we.propTypes={articleId:tt.a.number.isRequired,comments:tt.a.arrayOf(tt.a.instanceOf(D)).isRequired};var Oe=we,je=(r(154),function(t){return(t=(t=t.replace(/\r\n?/,"\n")).trim()).length>0&&(t="<p>"+(t=(t=t.replace(/\n\n+/g,"</p><p>")).replace(/\n/g,"<br>"))+"</p>"),t});function Ee(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}var Se=function(t){return function(){var e,r=(e=regeneratorRuntime.mark((function e(r){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=r,e.next="updating"===e.t0?3:"updated"===e.t0?6:10;break;case 3:return Y({warning:"Author is currently editing article. Be aware of possible changes."}),e.abrupt("break",10);case 6:return e.next=8,t.reload();case 8:n=e.sent,Pe(n,!0);case 10:case"end":return e.stop()}}),e)})),function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(t){Ee(i,n,o,a,u,"next",t)}function u(t){Ee(i,n,o,a,u,"throw",t)}a(void 0)}))});return function(t){return r.apply(this,arguments)}}()},Pe=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!1===e&&Object(o.subscribe)({to:t,with:Se(t)}),document.getElementById("title").textContent=t.title,document.getElementById("author").textContent=t.author;var r=new nt(t.publishedAt);document.getElementById("pub_date").textContent=r.toString("short");var n=document.getElementById("text");n.innerHTML="";var i=je(t.content);n.insertAdjacentHTML("beforeend",i)},ke={renderArticle:Pe,renderForm:function(t){new i.UI.Form({for:t,initObj:!0,id:"new_comment"}).render()}};function xe(t){return(xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ie(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ae(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Re(t,e){return!e||"object"!==xe(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Te(t){return(Te=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ce(t,e){return(Ce=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Me(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function Ne(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Me(i,n,o,a,u,"next",t)}function u(t){Me(i,n,o,a,u,"throw",t)}a(void 0)}))}}var qe=function(){var t=Ne(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,A.find(o.helpers.params.id);case 2:e=t.sent,g.dispatch(c([e])),ke.renderArticle(e);case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),De=function(){var t=Ne(regeneratorRuntime.mark((function t(){var e,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,D.get("count",{articleId:o.helpers.params.id});case 2:return e=t.sent,t.next=5,D.all({articleId:o.helpers.params.id,total:e.total});case 5:r=t.sent,g.dispatch(f(r,o.helpers.params.id)),Object(Z.render)(K.a.createElement(ge,{articleId:o.helpers.params.id,comments:r}),document.getElementById("comments")),Object(Z.render)(K.a.createElement(Oe,{articleId:o.helpers.params.id,comments:r}),document.getElementById("comments_count"));case 9:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Be=function(t){function e(){return Ie(this,e),Re(this,Te(e).apply(this,arguments))}var r,n,i,a;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ce(t,e)}(e,t),r=e,(n=[{key:"show",value:(a=Ne(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=new D({articleId:o.helpers.params.id}),ke.renderForm(e),qe(),De();case 4:case"end":return t.stop()}}),t)}))),function(){return a.apply(this,arguments)})}])&&Ae(r.prototype,n),i&&Ae(r,i),e}(o.Controllers.Base);function Le(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function ze(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Le(i,n,o,a,u,"next",t)}function u(t){Le(i,n,o,a,u,"throw",t)}a(void 0)}))}}function Fe(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t))&&"[object Arguments]"!==Object.prototype.toString.call(t))return;var r=[],n=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{n||null==u.return||u.return()}finally{if(o)throw i}}return r}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Ue(){var t=Fe(Object($.useState)(1),2),e=t[0],r=t[1],n=Fe(Object($.useState)(!1),2),o=n[0],i=n[1];function a(t){return c.apply(this,arguments)}function c(){return(c=ze(regeneratorRuntime.mark((function t(n){var o,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),r(o=e+1),a=null,t.prev=4,t.next=7,A.get("all",{page:o});case 7:a=t.sent,t.next=14;break;case 10:return t.prev=10,t.t0=t.catch(4),alert("Invalid URL: ".concat(t.t0)),t.abrupt("return");case 14:a.resources.length>0?g.dispatch(u(a.resources)):i(!0);case 15:case"end":return t.stop()}}),t,null,[[4,10]])})))).apply(this,arguments)}return o?K.a.createElement("span",null,"No more posts."):K.a.createElement("a",{href:"#",id:"load_more",onClick:a},"Load more…")}function Ve(t){var e=t.article,r=new nt(e.publishedAt).toString("short");return K.a.createElement("article",{id:"article_".concat(e.id)},K.a.createElement("h2",null,e.title),K.a.createElement("p",null,K.a.createElement("i",null,e.author," wrote this on ",r," /"," ",K.a.createElement("a",{href:"/articles/".concat(e.id,"#comments"),className:"comments_quantity"},e.commentsCount," comment",1===e.commentsCount?"":"s"))),K.a.createElement("p",null,e.content),K.a.createElement("p",null,K.a.createElement("a",{href:"/articles/".concat(e.id)},"Continued…")))}Ve.propTypes={article:tt.a.instanceOf(A).isRequired};var He=Ve;function We(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t))&&"[object Arguments]"!==Object.prototype.toString.call(t))return;var r=[],n=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{n||null==u.return||u.return()}finally{if(o)throw i}}return r}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Je(t){var e=We(Object($.useState)(t.articles),2),r=e[0],n=e[1];Object($.useEffect)((function(){var t=g.subscribe((function(){return n(g.getState().articles)}));return function(){t()}}));var o=r.map((function(t){return K.a.createElement(He,{key:t.id,article:t})}));return K.a.createElement(K.a.Fragment,null,o)}Je.propTypes={articles:tt.a.arrayOf(tt.a.instanceOf(A)).isRequired};var Ge=Je;function Ye(t){return(Ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xe(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function $e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ke(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ze(t,e){return!e||"object"!==Ye(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Qe(t){return(Qe=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function tr(t,e){return(tr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var er=function(t){function e(){return $e(this,e),Ze(this,Qe(e).apply(this,arguments))}var r,n,o,i,a;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&tr(t,e)}(e,t),r=e,(n=[{key:"index",value:(i=regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Object(Z.render)(K.a.createElement(Ue,null),document.getElementById("load_more_wrapper")),t.next=3,A.get("all",{page:1});case 3:e=t.sent,g.dispatch(c(e.resources)),Object(Z.render)(K.a.createElement(Ge,{articles:e.resources}),document.getElementById("articles"));case 6:case"end":return t.stop()}}),t)})),a=function(){var t=this,e=arguments;return new Promise((function(r,n){var o=i.apply(t,e);function a(t){Xe(o,r,n,a,u,"next",t)}function u(t){Xe(o,r,n,a,u,"throw",t)}a(void 0)}))},function(){return a.apply(this,arguments)})}])&&Ke(r.prototype,n),o&&Ke(r,o),e}(o.Controllers.Base),rr=function(t){switch(t){case"confirming":document.getElementById("verification_info").textContent=document.getElementById("verification_progress").textContent;break;case"confirmed":window.location.href="/user/sessions/new?event=confirmed"}},nr=function(t){Object(o.subscribe)({to:new H({id:t.id}),with:rr}),document.querySelector("form").style.display="none",document.getElementById("sign_in_paragraph").classList.remove("none"),document.getElementById("verification_info").classList.remove("none"),Y({notice:t.notice})};function or(t){return(or="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ir(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ar(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ur(t,e){return!e||"object"!==or(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function cr(t){return(cr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function sr(t,e){return(sr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var lr=function(t){function e(){return ir(this,e),ur(this,cr(e).apply(this,arguments))}var r,n,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&sr(t,e)}(e,t),r=e,(n=[{key:"new",value:function(){new i.UI.Form({for:new H,callbackSuccess:nr}).render()}}])&&ar(r.prototype,n),o&&ar(r,o),e}(o.Controllers.Base);function fr(t){return(fr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function dr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function mr(t,e){return!e||"object"!==fr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function hr(t){return(hr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function yr(t,e){return(yr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Object.assign(o.Controllers.Base.prototype,X);var br=function(t){function e(){return pr(this,e),mr(this,hr(e).apply(this,arguments))}var r,n,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yr(t,e)}(e,t),r=e,(n=[{key:"initialize",value:function(){this.setScope("main")}}])&&dr(r.prototype,n),o&&dr(r,o),e}(o.Controllers.Base);Object.assign(br,{Articles:Be,Pages:er,Users:lr});var vr=br;function gr(t){return(gr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _r(t,e){return!e||"object"!==gr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function wr(t){return(wr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Or(t,e){return(Or=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function jr(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Er=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),_r(this,wr(e).call(this,t))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Or(t,e)}(e,t),e}(o.Models.Base);jr(Er,"identity","Room.Member"),jr(Er,"resources",{url:"/user/rooms/:roomId/members",paginate:{per:100}});var Sr=Er;r(157);function Pr(t){return(Pr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function kr(t,e){return!e||"object"!==Pr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function xr(t){return(xr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ir(t,e){return(Ir=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ar,Rr,Tr,Cr=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),kr(this,xr(e).call(this,t))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ir(t,e)}(e,t),e}(o.Models.Base);Tr="Room",(Rr="identity")in(Ar=Cr)?Object.defineProperty(Ar,Rr,{value:Tr,enumerable:!0,configurable:!0,writable:!0}):Ar[Rr]=Tr;var Mr=Cr,Nr=function(t){document.querySelector("#room_".concat(t," td.members"))},qr=function(t,e){switch(t){case"Room member_joined":o=e.room_id,(i=Nr(o)).textContent=parseInt(i.text())+1;break;case"Room member_left":!function(t){var e=Nr(t);e.textContent=parseInt(e.text())-1}(e.room_id);break;case"Room created":document.getElementById("rooms_list").insertAdjacentHTML("beforeend",(n=e.room,void"\n  <tr id='room_".concat(n.id,"'>\n    <td>").concat(n.name,"</td>\n    <td class='members'>0</td>\n    <td>\n      <a rel='nofollow' data-method='patch' href='/user/rooms/").concat(n.id,"/join'>Join</a> |\n      <a data-confirm='R U sure?' rel='nofollow' data-method='delete'\n        href='/user/rooms/").concat(n.id,"'>Destroy</a>\n    </td>\n  </tr>\n  ")));break;case"Room destroyed":var r=document.getElementById("room_".concat(e.room_id));r.parentNode.removeChild(r)}var n,o,i},Dr=function(t){var e="<li id='user_".concat(t.id,"'>").concat(t.username,"</li>");document.getElementById("members").insertAdjacentHTML("beforeend",e)},Br=function(t){return function(e,r){switch(e){case"Room member_joined":if(r.room_id!==t)return;Dr(r.member);break;case"Room member_left":if(r.room_id!==t)return;n=r.member,(o=document.querySelector("#members li#user_".concat(n.id))).parentNode.removeChild(o)}var n,o}},Lr=function(t){Object(o.subscribe)({to:Mr,with:Br(t)}),function(t){document.querySelector("[data-behavior~=room-speaker]").addEventListener("keypress",(function(e){13===e.keyCode&&(e.preventDefault(),Object(o.emit)({type:"NEW_MESSAGE",txt:e.target.value,room_id:t}),e.target.value="")}))}(t)},zr=function(t){var e=!0,r=!1,n=void 0;try{for(var o,i=t[Symbol.iterator]();!(e=(o=i.next()).done);e=!0){var a=o.value;Dr(a)}}catch(t){r=!0,n=t}finally{try{e||null==i.return||i.return()}finally{if(r)throw n}}},Fr=function(t,e){var r='<p class="msg"><b>'.concat(e,"</b>: ").concat(t,"</p>");document.getElementById("messages").insertAdjacentHTML("beforeend",r)};function Ur(t){return(Ur="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vr(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function Hr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Wr(t,e){return!e||"object"!==Ur(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Jr(t){return(Jr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Gr(t,e){return(Gr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Yr=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Wr(this,Jr(e).call(this))).callbacks={},t}var r,n,i,a,u;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Gr(t,e)}(e,t),r=e,(n=[{key:"index",value:function(){Object(o.subscribe)({to:Mr,with:qr})}},{key:"show",value:(a=regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.callbacks.receivedMessage=Fr,Lr(o.helpers.params.id),t.next=4,Sr.all({roomId:o.helpers.params.id});case 4:e=t.sent,zr(e.resources);case 6:case"end":return t.stop()}}),t,this)})),u=function(){var t=this,e=arguments;return new Promise((function(r,n){var o=a.apply(t,e);function i(t){Vr(o,r,n,i,u,"next",t)}function u(t){Vr(o,r,n,i,u,"throw",t)}i(void 0)}))},function(){return u.apply(this,arguments)})}])&&Hr(r.prototype,n),i&&Hr(r,i),e}(o.Controllers.Base);function Xr(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function $r(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Xr(i,n,o,a,u,"next",t)}function u(t){Xr(i,n,o,a,u,"throw",t)}a(void 0)}))}}var Kr=function(t){document.getElementById("article_title").textContent=t.title,document.getElementById("article_text").textContent=t.content;var e=document.getElementById("publish_article");e&&null!=t.publishedAt?e.style.display="none":e&&(e.style.display="")},Zr=function(t){return function(){var e=$r(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=r,e.next="updated"===e.t0?3:"destroyed"===e.t0?8:9;break;case 3:return e.next=5,t.reload();case 5:return t.applyChanges(),Kr(t),e.abrupt("break",9);case 8:window.location.href="/user/articles?message=deleted";case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},Qr=function(t){var e,r;null!==t&&(Object(o.subscribe)({to:t,with:Zr(t)}),function(t){document.getElementById("publish_article").addEventListener("click",function(){var e=$r(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),r.target.textContent="Publishing...",e.prev=2,e.next=5,t.put("publish");case 5:document.getElementById("publish_article").outerHTML="<span>Published!</span>",e.next=12;break;case 8:e.prev=8,e.t0=e.catch(2),document.getElementById("publish_article").textContent="Publish",Y({alert:"Connection error!"});case 12:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t){return e.apply(this,arguments)}}())}(t),e=t.id,r=document.getElementById("edit_link").getAttribute("href"),document.getElementById("edit_link").setAttribute("href",r.replace("/0/","/".concat(e,"/"))),Kr(t))};r(158),r(160),r(162);function tn(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function en(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?tn(Object(r),!0).forEach((function(e){rn(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):tn(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function rn(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nn(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function on(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t))&&"[object Arguments]"!==Object.prototype.toString.call(t))return;var r=[],n=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{n||null==u.return||u.return()}finally{if(o)throw i}}return r}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function an(t){var e,r=t.comment,n=t.isAdmin,o=void 0!==n&&n,i=on(Object($.useState)(!1),2),a=i[0],u=i[1],c=new nt(r.createdAt).strftime("%d %b %y"),s=function(){var t,e=(t=regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.preventDefault(),u(!0),r.approved=!0,t.next=5,r.updateAttribute("approved");case 5:if(t.sent.ok){t.next=8;break}return t.abrupt("return");case 8:g.dispatch(p(new D(en({},r,{approved:!0})),r.articleId));case 9:case"end":return t.stop()}}),t)})),function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){nn(i,n,o,a,u,"next",t)}function u(t){nn(i,n,o,a,u,"throw",t)}a(void 0)}))});return function(t){return e.apply(this,arguments)}}();return K.a.createElement("p",{id:"comment_".concat(r.id)},K.a.createElement("b",null,r.author)," on ",K.a.createElement("i",null,c),o?(e=r.approved?K.a.createElement(K.a.Fragment,null,K.a.createElement("span",null,"approved")," |"," "):a?K.a.createElement(K.a.Fragment,null,K.a.createElement("span",null,"approving...")," |"," "):K.a.createElement(K.a.Fragment,null,K.a.createElement("a",{href:"/user/articles/".concat(r.articleId,"/comments/").concat(r.id,"/approve"),className:"approve",onClick:s},"approve")," ","|"," "),K.a.createElement(K.a.Fragment,null," ","(",e,K.a.createElement("a",{href:"/user/articles/".concat(r.articleId,"/comments/").concat(r.id,"/edit")},"edit")," ","|"," ",K.a.createElement("a",{href:"/user/articles/".concat(r.articleId,"/comments/").concat(r.id),"data-method":"delete","data-confirm":"Are you sure?"},"delete"),")")):"",K.a.createElement("br",null),r.text)}an.propTypes={comment:tt.a.instanceOf(D).isRequired,isAdmin:tt.a.bool};var un=an;function cn(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t))&&"[object Arguments]"!==Object.prototype.toString.call(t))return;var r=[],n=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{n||null==u.return||u.return()}finally{if(o)throw i}}return r}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function sn(t){var e=t.articleId,r=t.isAdmin||!1,n=cn(Object($.useState)(t.comments),2),o=n[0],i=n[1];if(Object($.useEffect)((function(){var t=g.subscribe((function(){return i(me(g.getState(),e))}));return function(){t()}})),0===o.length)return K.a.createElement("p",null,"No comments.");var a=o.map((function(t){return K.a.createElement(un,{key:t.id,comment:t,isAdmin:r})}));return K.a.createElement(K.a.Fragment,null,a)}sn.propTypes={articleId:tt.a.number.isRequired,isAdmin:tt.a.bool,comments:tt.a.arrayOf(tt.a.instanceOf(D)).isRequired};var ln=sn;function fn(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function pn(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){fn(i,n,o,a,u,"next",t)}function u(t){fn(i,n,o,a,u,"throw",t)}a(void 0)}))}}function dn(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t))&&"[object Arguments]"!==Object.prototype.toString.call(t))return;var r=[],n=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{n||null==u.return||u.return()}finally{if(o)throw i}}return r}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var mn,hn=function(t){for(var e=0,r=Object.entries(t.changes());e<r.length;e++){var n=dn(r[e],1)[0],o=document.querySelector("a.apply_changes[data-for=".concat(t.getAttrRemoteName(n),"]"));o&&o.classList.remove("none")}},yn=function(t){return function(){var e=pn(regeneratorRuntime.mark((function e(r,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=r,e.next="updating"===e.t0?3:"updated"===e.t0?5:"destroyed"===e.t0?9:10;break;case 3:return document.querySelector("h1").getAttribute("data-mark")!==n.mark&&Y({warning:"Uuups someone else started editing this article."}),e.abrupt("break",10);case 5:return e.next=7,t.reload();case 7:return hn(t),e.abrupt("break",10);case 9:window.location.href="/user/articles?message=deleted";case 10:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()},bn={render:function(t){g.dispatch(u([t])),Object(o.subscribe)({to:t,with:yn(t)});var e=new i.UI.Form({for:t});e.render(),function(t){for(var e=0,r=Array.from(document.querySelectorAll("a.apply_changes"));e<r.length;e++){r[e].addEventListener("click",(function(e){e.preventDefault();var r=t.getObj(),n=r.getAttrName(e.target.getAttribute("data-for"));r[n]=r.changes()[n].is,t.fill(n),e.target.classList.add("none")}))}}(e)},renderComments:(mn=pn(regeneratorRuntime.mark((function t(e){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,D.all({articleId:e});case 2:r=t.sent,g.dispatch(f(r.resources,e)),Object(Z.render)(K.a.createElement(ln,{articleId:e,comments:r.resources,isAdmin:!0}),document.getElementById("comments"));case 5:case"end":return t.stop()}}),t)}))),function(t){return mn.apply(this,arguments)})};function vn(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function gn(t){var e=t.article,r=t.onArticleDestroyed,n=function(){var t,n=(t=regeneratorRuntime.mark((function t(n){var o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),confirm("Are you sure?")){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,e.delete(null);case 5:(o=t.sent).success&&g.dispatch({type:"REMOVE_ARTICLE",id:o.id}),r(o);case 8:case"end":return t.stop()}}),t)})),function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){vn(i,n,o,a,u,"next",t)}function u(t){vn(i,n,o,a,u,"throw",t)}a(void 0)}))});return function(t){return n.apply(this,arguments)}}();return K.a.createElement("tr",{id:"article_".concat(e.id)},K.a.createElement("td",null,e.title),K.a.createElement("td",null,e.content),K.a.createElement("td",{className:"comments_quantity"},e.commentsCount),K.a.createElement("td",{className:"published"},e.publishedAt?"yes":"no"),K.a.createElement("td",null,K.a.createElement("a",{href:"/user/articles/".concat(e.id)},"Show")," |",K.a.createElement("a",{href:"/user/articles/".concat(e.id,"/edit")},"Edit")," |",K.a.createElement("a",{href:"/user/articles/".concat(e.id),className:"delete_article",onClick:n},"Delete")))}gn.propTypes={article:tt.a.instanceOf(A).isRequired,onArticleDestroyed:tt.a.func.isRequired};var _n=gn;function wn(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t))&&"[object Arguments]"!==Object.prototype.toString.call(t))return;var r=[],n=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{n||null==u.return||u.return()}finally{if(o)throw i}}return r}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function On(t){var e=wn(Object($.useState)(t.articles),2),r=e[0],n=e[1];Object($.useEffect)((function(){var t=g.subscribe((function(){return n(g.getState().articles)}));return function(){t()}}));var o=r.map((function(e){return K.a.createElement(_n,{key:e.id,article:e,onArticleDestroyed:t.onArticleDestroyed})}));return K.a.createElement(K.a.Fragment,null,o)}On.propTypes={articles:tt.a.arrayOf(tt.a.instanceOf(A)).isRequired,onArticleDestroyed:tt.a.func.isRequired};var jn=On;function En(t){return(En="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Sn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Pn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function kn(t,e){return!e||"object"!==En(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function xn(t){return(xn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function In(t,e){return(In=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function An(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function Rn(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){An(i,n,o,a,u,"next",t)}function u(t){An(i,n,o,a,u,"throw",t)}a(void 0)}))}}var Tn=function(){var t=Rn(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,A.find(o.helpers.params.id);case 2:e=t.sent,g.dispatch(c([e])),Qr(e);case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Cn=function(){var t=Rn(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,D.all({articleId:o.helpers.params.id});case 2:e=t.sent,g.dispatch(f(e.resources,o.helpers.params.id)),Object(Z.render)(K.a.createElement(ln,{articleId:o.helpers.params.id,comments:e.resources}),document.getElementById("comments"));case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Mn=function(t){t.success?Y({notice:t.notice}):Y({alert:t.alert})},Nn=function(t){function e(){return Sn(this,e),kn(this,xn(e).apply(this,arguments))}var r,n,i,a,u;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&In(t,e)}(e,t),r=e,(n=[{key:"index",value:(u=Rn(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"deleted"===o.helpers.params.message&&Y({alert:"Article has been deleted."}),t.next=3,A.get("all");case 3:e=t.sent,g.dispatch(c(e.resources)),Object(Z.render)(K.a.createElement(jn,{articles:e.resources,onArticleDestroyed:Mn}),document.getElementById("article_list"));case 6:case"end":return t.stop()}}),t)}))),function(){return u.apply(this,arguments)})},{key:"show",value:function(){Tn(),Cn()}},{key:"new",value:function(){bn.render(new A)}},{key:"edit",value:(a=Rn(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return bn.renderComments(o.helpers.params.id),t.next=3,A.find(o.helpers.params.id);case 3:e=t.sent,bn.render(e);case 5:case"end":return t.stop()}}),t)}))),function(){return a.apply(this,arguments)})}])&&Pn(r.prototype,n),i&&Pn(r,i),e}(o.Controllers.Base);function qn(t){return(qn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Dn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Bn(t,e){return!e||"object"!==qn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ln(t){return(Ln=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function zn(t,e){return(zn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Object.assign(o.Controllers.Base.prototype,X);var Fn=function(t){function e(){return Dn(this,e),Bn(this,Ln(e).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&zn(t,e)}(e,t),e}(o.Controllers.Base);Object.assign(Fn,{Articles:Nn,Rooms:Yr});var Un=Fn;function Vn(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Hn(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Wn(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t))&&"[object Arguments]"!==Object.prototype.toString.call(t))return;var r=[],n=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{n||null==u.return||u.return()}finally{if(o)throw i}}return r}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Jn(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function Gn(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Jn(i,n,o,a,u,"next",t)}function u(t){Jn(i,n,o,a,u,"throw",t)}a(void 0)}))}}var Yn=function(){var t=Gn(regeneratorRuntime.mark((function t(e){var r,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.id,o.Env.namespaceController.constructor===Un){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,A.find({id:r,abbr:!0});case 5:n=t.sent,g.dispatch(u([n]));case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Xn=function(){var t=Gn(regeneratorRuntime.mark((function t(e){var r,n,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.id,o.Env.namespaceController.constructor!==de){t.next=8;break}return t.next=4,A.find({id:r,abbr:!0,resource:"admin"});case 4:n=t.sent,g.dispatch({type:"PREPEND_ARTICLES",articles:[n]}),t.next=12;break;case 8:return t.next=10,A.find({id:r,abbr:!0});case 10:i=t.sent,g.dispatch(u([i]));case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),$n=function(){var t=Gn(regeneratorRuntime.mark((function t(e){var r,n,i,a,u,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.id,n={id:r,abbr:!0},o.Env.namespaceController.constructor===de&&(n.resource="admin"),i=w(g.getState(),r),a=Wn(i,2),u=a[0],c=a[1],u){t.next=6;break}return t.abrupt("return");case 6:return t.next=8,A.find(n);case 8:u=t.sent,g.dispatch(s(u,c));case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Kn=function(t,e){var r=t.article_id,n=Wn(w(g.getState(),r),2),o=n[0],i=n[1];if(o){var a=new A(function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Vn(Object(r),!0).forEach((function(e){Hn(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Vn(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},o,{commentsCount:o.commentsCount+e}));g.dispatch(s(a,i))}},Zn=function(){var t=Gn(regeneratorRuntime.mark((function t(e){var r,n,i,a,u,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.article_id,n=e.id,i={articleId:r,id:n},o.Env.namespaceController.constructor===vr&&(i.resource="main"),a=w(g.getState(),r),u=Wn(a,1),u[0]){t.next=6;break}return t.abrupt("return");case 6:return t.next=8,D.find(i);case 8:c=t.sent,g.dispatch(l([c],r));case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Qn=function(){var t=Gn(regeneratorRuntime.mark((function t(e){var r,n,o,i,a,u,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.article_id,n=e.id,o=O(g.getState(),n,{parentId:r}),i=Wn(o,2),a=i[0],u=i[1],a){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,a.reload();case 6:c=t.sent,g.dispatch(p(c,r,u));case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),to=function(){var t=Gn(regeneratorRuntime.mark((function t(e){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=e.type,t.next="PING"===t.t0?3:"NEW_MESSAGE"===t.t0?5:"Article created"===t.t0?7:"Article published"===t.t0?9:"Article updated"===t.t0?11:"Article.Comment created"===t.t0?13:"Article.Comment destroyed"===t.t0?16:"Article.Comment updated"===t.t0?19:"User created"===t.t0?21:26;break;case 3:return o.Env.namespaceController.constructor===Un&&alert("Ping!"),t.abrupt("break",26);case 5:return(u=void 0,u=function(){},o.Env.namespaceController.constructor!==Un||o.Env.controller.constructor!==Yr||"show"!==o.Env.action?u:o.Env.controller.callbacks.receivedMessage)(e.message,e.author),t.abrupt("break",26);case 7:return Yn(e.payload),t.abrupt("break",26);case 9:return Xn(e.payload),t.abrupt("break",26);case 11:return $n(e.payload),t.abrupt("break",26);case 13:return Kn(e.payload,1),Zn(e.payload),t.abrupt("break",26);case 16:return Kn(e.payload,-1),n=e.payload,i=void 0,a=void 0,i=n.article_id,a=n.id,g.dispatch(function(t,e){return{type:"REMOVE_COMMENT",id:t,articleId:e}}(a,i)),t.abrupt("break",26);case 19:return Qn(e.payload),t.abrupt("break",26);case 21:return t.next=23,H.find(e.payload.id);case 23:return r=t.sent,g.dispatch({type:"PREPEND_USERS",users:[r]}),t.abrupt("break",26);case 26:case"end":return t.stop()}var n,i,a,u}),t)})));return function(e){return t.apply(this,arguments)}}();Object(o.init)({cable:Object(a.createConsumer)(),notificationCenter:to,notifications:{enable:!0,log:!0,size:10},postInit:function(){"test"===document.querySelector("body").getAttribute("data-rails-env")&&Object(o.getWire)().setPollingTime(1e3)}}),Object(i.connect)(o.connector);r(164);function eo(t){return(eo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ro(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function no(t,e){return!e||"object"!==eo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function oo(t){return(oo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function io(t,e){return(io=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ao=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),no(this,oo(e).call(this))}var r,n,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&io(t,e)}(e,t),r=e,(n=[{key:"validate",value:function(){if(null!=this.val)switch(eo(this.val)){case"string":var t=this._getVulgarWord();if(!new RegExp("".concat(t),["i"]).exec(this.val))return;this._addErrorMessage();break;default:throw new TypeError("Vulgarity validator is applicable only for strings and ".concat(this.attr," isn't."))}}},{key:"_addErrorMessage",value:function(){var t=o.I18n[Object(o.getLocale)()].errors.messages.vulgarity;this.obj.addErrorMessage(t,{for:this.attr})}},{key:"_getVulgarWord",value:function(){switch(Object(o.getLocale)()){case"pl":return"kurwa";case"en":return"fuck"}}}])&&ro(r.prototype,n),i&&ro(r,i),e}(o.Validators.Base);!function(t,e,r){e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r}(ao,"identity","Vulgarity");var uo=ao;Object.assign(o.Validators,{Vulgarity:uo});o.I18n.pl={variants:{few:function(t){var e,r=parseInt((e=String(t))[e.length-1]);-1!==[2,3,4].indexOf(r)&&(2!==String(t).length||String(t)[0])}},models:{},attributes:{},ui:{form:{sending:"Wysyłam...",success:"Sukces",errors:{connection:"Błąd z połączeniem",invalid_data:"Nieprawidłowe dane"}}},date:{formats:{default:"%d-%m-%Y",short:"%d %b",long:"%B %d, %Y"},day_names:["niedziela","poniedziałek","wtorek","środa","czwartek","piątek","sobota"],abbr_day_names:["nie","pon","wto","śro","czw","pią","sob"],month_names:["styczeń","luty","marzec","kwiecień","maj","czerwiec","lipiec","sierpień","wrzesień","październik","listopad","grudzień"],abbr_month_names:["sty","lut","mar","kwi","maj","cze","lip","sie","wrz","paź","lis","gru"]},errors:{messages:{accepted:"musi zostać zaakceptowane",blank:"nie może być puste",confirmation:"nie zgadza się z polem %{attribute}",empty:"nie może być puste",equal_to:"musi być równe %{count}",even:"musi być parzyste",exclusion:"jest zarezerwowane",greater_than:"musi być większe od %{count}",greater_than_or_equal_to:"musi być większe lub równe %{count}",inclusion:"nie znajduje się na liście dopuszczalnych wartości",invalid:"jest nieprawidłowe",less_than:"musi być mniejsze od %{count}",less_than_or_equal_to:"musi być mniejsze lub równe %{count}",not_a_number:"nie jest liczbą",not_an_integer:"musi być liczbą całkowitą",odd:"musi być nieparzyste",present:"musi być puste",too_long:{few:"jest za długie (maksymalnie %{count} znaki)",many:"jest za długie (maksymalnie %{count} znaków)",one:"jest za długie (maksymalnie jeden znak)",other:"jest za długie (maksymalnie %{count} znaków)"},too_short:{few:"jest za krótkie (przynajmniej %{count} znaki)",many:"jest za krótkie (przynajmniej %{count} znaków)",one:"jest za krótkie (przynajmniej jeden znak)",other:"jest za krótkie (przynajmniej %{count} znaków)"},wrong_length:{few:"ma nieprawidłową długość (powinna wynosić %{count} znaki)",many:"ma nieprawidłową długość (powinna wynosić %{count} znaków)",one:"ma nieprawidłową długość (powinna wynosić jeden znak)",other:"ma nieprawidłową długość (powinna wynosić %{count} znaków)"},other_than:"musi być inna niż %{count}"}}},o.I18n.pl.models.User="Użytkownik",o.I18n.pl.attributes.User={password:"Hasło",passwordConfirmation:"Powtórz hasło"},o.I18n.en.errors.messages.vulgarity="contains strong language.",o.I18n.pl.errors.messages.vulgarity="zawiera mocny język.",o.I18n.en.date={formats:{default:"%Y-%m-%d",short:"%b %d",long:"%B %d, %Y"},day_names:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],abbr_day_names:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],month_names:["January","February","March","April","May","June","July","August","September","October","November","December"],abbr_month_names:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},Object.assign(o.Controllers,{Admin:de,Main:vr,User:Un}),Object.assign(A,{Comment:D}),Object.assign(Mr,{Member:Sr}),Object.assign(o.Models,{Article:A,Room:Mr,User:H}),window.test={getLine:o.getLine,getWire:o.getWire}},17:function(t,e,r){window,t.exports=function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=0)}([function(t,e,r){"use strict";r.r(e),r.d(e,"UI",(function(){return c})),r.d(e,"connect",(function(){return p}));var n={getLocale:null,wire:null,I18n:null},o=function(t,e){return null!=t.classList?t.classList.contains(e):new RegExp("(^| )"+e+"( |$)","gi").test(t.className)},i=function(t,e){null!=t.classList?t.classList.add(e):t.className+=" "+e},a=function(t,e){null!=t.classList?t.classList.remove(e):t.className=t.className.replace(new RegExp("(^|\\b)"+e.split(" ").join("|")+"(\\b|$)","gi")," ")},u=function(t){return Array.from(t).map((function(t){return t.getAttribute("type")})).filter((function(t,e,r){return r.indexOf(t)===e}))},c={Form:function(){function t(t){null==t&&(t={}),this.formId=t.id,this.obj=t.for,this.initObj=!(null==t.initObj||!t.initObj),this.callbackSuccess=t.callbackSuccess,this.callbackFailure=t.callbackFailure,this.callbackActive=t.callbackActive,this.form=this._findForm(),this.submit=null,this.submitVal=null,null!=this.form&&(this.submit=this.form.querySelector('[type="submit"]')),null!=this.submit&&(this.submitVal=this.submit.value),this.locale=n.getLocale()}return t.prototype.getObj=function(){return this.obj},t.prototype.render=function(){return this.initObj?(this._assignAttribs(),this._handle()):null!=this.form?(this.fill(),this._handle()):void 0},t.prototype.fill=function(t){var e,r,n,o,i,a,c,s;if(null==t&&(t=null),null==this.obj)return null;if(null==this.obj.constructor.attributes)return null;for(n in e={},null!=t?e[t]=null:e=this.obj.constructor.attributes,c=[],e)e[n],a=this.obj.getAttrRemoteName(n),null!==(o=this.form.querySelector("[data-attr="+a+"]"))&&0!==(r=o.querySelectorAll("input,textarea,select")).length&&(1!==r.length?1!==(s=u(r)).length||"radio"!==s[0]||null==(i=Array.from(r).find(function(t){return function(e){return e.value===String(t.obj[n])}}(this)))?"hidden"!==r[0].getAttribute("type")&&"checkbox"!==r[r.length-1].getAttribute("type")||c.push(r[r.length-1].checked=Boolean(this.obj[n])):i.checked=!0:r[0].value=this.obj[n]);return c},t.prototype._findForm=function(){var t;return null!=this.formId?document.getElementById(""+this.formId):null!=this.obj?(t=this.obj.getIdentity().toLowerCase(),null!=this.obj.id?document.getElementById("edit_"+t+"_"+this.obj.id):document.getElementById("new_"+t)):void 0},t.prototype._handle=function(){return this.form.addEventListener("submit",(t=this,function(e){var r;if(e.preventDefault(),t._canBeSubmitted()){if(null!=t.obj)return t._assignAttribs(),t._hideErrors(),t.obj.isInvalid()?(t._renderErrors(),void(null!=t.callbackFailure&&t.callbackFailure())):(t._submittingForm(!1),r=null==t.obj.id,t.obj.save().then((function(e){return t._alwaysAfterRequest(),e.success?t._handleSuccess(e,r):(null!=t.callbackFailure&&t.callbackFailure(),t._renderErrors())})).catch((function(e){return t._connectionError()})));t._submitForm()}}));var t},t.prototype._canBeSubmitted=function(){return null==this.submit||!o(this.submit,"active")&&!o(this.submit,"success")&&!o(this.submit,"failure")},t.prototype._submitForm=function(){var t,e,r,n,o;return this._submittingForm(),n=this.form.getAttribute("action")+".json",t=new FormData(this.form),(r=new XMLHttpRequest).open("POST",n),r.setRequestHeader("X-CSRF-Token",null!=(e=document.querySelector("meta[name='csrf-token']"))?e.content:void 0),r.onload=(o=this,function(e){return o._alwaysAfterRequest(),null!=o.submit&&o.submit.blur(),e.target.status>=200&&e.target.status<400?(t=JSON.parse(e.target.response)).success?o._handleSuccess(t,"POST"===o.form.getAttribute("method")):o._renderErrors(t.errors):e.target.status>=500?o._connectionError():void 0}),r.onerror=function(t){return function(){return t._alwaysAfterRequest(),null!=t.submit&&t.submit.blur(),t._connectionError()}}(this),r.send(t)},t.prototype._handleSuccess=function(t,e){var r,o,u,c;if(null==e&&(e=!0),u=null!=(r=null!=(o=t.flash)?o.success:void 0)?r:n.I18n[this.locale].ui.form.success,null!=this.submit&&(i(this.submit,"success"),this.submit.value=u),null!=t.access_token&&(n.wire.token=t.access_token),null==this.callbackSuccess)return setTimeout((c=this,function(){var t,r,n,o,i,u;if(null!=c.submit&&(c.submit.disabled=!1,a(c.submit,"success"),c.submit.value=c.submitVal),u=":not([data-loco-not-clear=true])",e){for(i=[],t=0,r=(o=c.form.querySelectorAll("input:not([type='submit'])"+u+", textarea"+u)).length;t<r;t++)n=o[t],i.push(n.value="");return i}}),5e3);null!=t.data?this.callbackSuccess(t.data):this.callbackSuccess()},t.prototype._renderErrors=function(t){var e,r,o,u,c,s,l,f,p;if(null==t&&(t=null),!(null!=this.obj&&null==this.obj.errors||null==this.obj&&null==t)){for(e in r=null!=t?t:this.obj.errors)if(o=r[e],null==(p=null!=this.obj?this.obj.getAttrRemoteName(e):e)||"base"===e)"base"===e&&o.length>0&&(1===(l=document.querySelectorAll(".errors[data-for='base']")).length?l[0].textContent=o[0]:null!=this.submit&&(this.submit.value=o[0]));else{if(null===(f=this.form.querySelector("[data-attr="+p+"]")))continue;if(0===(l=f.querySelectorAll(".errors[data-for="+p+"]")).length)continue;for(u=0,c=l.length;u<c;u++)(s=l[u]).textContent=o[0]}return null!=this.submit&&(this.submit.value!==this.submitVal&&this.submit.value!==n.I18n[this.locale].ui.form.sending||(this.submit.value=n.I18n[this.locale].ui.form.errors.invalid_data),i(this.submit,"failure")),this._showErrors(),setTimeout((d=this,function(){var t,e,r,n;for(null!=d.submit&&(d.submit.disabled=!1,a(d.submit,"failure"),d.submit.value=d.submitVal),n=[],t=0,e=(r=d.form.querySelectorAll("input.invalid, textarea.invalid, select.invalid")).length;t<e;t++)s=r[t],n.push(a(s,"invalid"));return n}),1e3);var d}},t.prototype._assignAttribs=function(){var t,e,r,n,o,i,a,c;if(null==this.obj.constructor.attributes)return null;for(e in a=[],o=this.obj.constructor.attributes)o[e],i=this.obj.getAttrRemoteName(e),null!==(r=this.form.querySelector("[data-attr="+i+"]"))&&0!==(t=r.querySelectorAll("input,textarea,select")).length&&(1!==t.length?1!==(c=u(t)).length||"radio"!==c[0]||null==(n=Array.from(t).find((function(t){return!0===t.checked})))?"hidden"!==t[0].getAttribute("type")&&"checkbox"!==t[t.length-1].getAttribute("type")||(!0===t[t.length-1].checked?a.push(this.obj.assignAttr(e,t[t.length-1].value)):a.push(this.obj.assignAttr(e,t[0].value))):this.obj.assignAttr(e,n.value):this.obj.assignAttr(e,t[0].value));return a},t.prototype._hideErrors=function(){var t,e,r,n,o;for(o=[],e=0,r=(n=this.form.querySelectorAll(".errors")).length;e<r;e++)(t=n[e]).textContent.trim().length>0?(t.textContent="",o.push(t.style.display="none")):o.push(void 0);return o},t.prototype._showErrors=function(){var t,e,r,n,o;for(o=[],e=0,r=(n=this.form.querySelectorAll(".errors")).length;e<r;e++)(t=n[e]).textContent.trim().length>0?o.push(t.style.display="block"):o.push(void 0);return o},t.prototype._submittingForm=function(t){if(null==t&&(t=!0),null!=this.submit&&(a(this.submit,"success"),a(this.submit,"failure"),i(this.submit,"active"),this.submit.value=n.I18n[this.locale].ui.form.sending),null!=this.callbackActive&&this.callbackActive(),t)return this._hideErrors()},t.prototype._connectionError=function(){var t;if(null!=this.submit)return a(this.submit,"active"),i(this.submit,"failure"),this.submit.value=n.I18n[this.locale].ui.form.errors.connection,setTimeout((t=this,function(){return t.submit.disabled=!1,a(t.submit,"failure"),t.submit.value=t.submitVal}),3e3)},t.prototype._alwaysAfterRequest=function(){if(null!=this.submit)return a(this.submit,"active")},t}()},s={ui:{form:{sending:"Sending...",success:"Success",errors:{connection:"Connection Error",invalid_data:"Invalid data"}}}};function l(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function f(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var p=function(t){n.getLocale=t.getLocale,n.wire=t.Env.loco.wire,n.I18n=t.I18n,n.I18n.en=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?l(r,!0).forEach((function(e){f(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):l(r).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},s,{},n.I18n.en)}}])}});
//# sourceMappingURL=application.js.map