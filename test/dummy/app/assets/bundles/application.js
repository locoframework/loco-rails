!function(e){function t(t){for(var r,a,c=t[0],u=t[1],l=t[2],f=0,p=[];f<c.length;f++)a=c[f],o[a]&&p.push(o[a][0]),o[a]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(e[r]=u[r]);for(s&&s(t);p.length;)p.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,c=1;c<n.length;c++){var u=n[c];0!==o[u]&&(r=!1)}r&&(i.splice(t--,1),e=a(a.s=n[0]))}return e}var r={},o={0:0},i=[];function a(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=r,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="";var c=window.webpackJsonp=window.webpackJsonp||[],u=c.push.bind(c);c.push=t,c=c.slice();for(var l=0;l<c.length;l++)t(c[l]);var s=u;i.push([157,1]),n()}({112:function(e,t,n){},113:function(e,t,n){},157:function(e,t,n){"use strict";n.r(t);n(112),n(113);var r=n(109);n.n(r).a.start();var o=n(1),i=n(110);n(5),n(6),n(7),n(4),n(34),n(10),n(11),n(2),n(8),n(9);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=u(this,l(t).call(this,n))).notice=n.notice,e.alert=n.alert,e.warning=n.warning,e.hide=n.hide,e}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(t,o["Views"].Base),n=t,(r=[{key:"setNotice",value:function(e){this.notice=e}},{key:"setAlert",value:function(e){this.alert=e}},{key:"setWarning",value:function(e){this.warning=e}},{key:"render",value:function(){var e=document.querySelector(".flash");e.classList.remove("notice"),e.classList.remove("alert"),e.classList.remove("warning"),null!=this.notice?(e.classList.add("notice"),document.querySelector(".flash p").textContent=this.notice):null!=this.alert?(e.classList.add("alert"),document.querySelector(".flash p").textContent=this.alert):null!=this.warning&&(e.classList.add("warning"),document.querySelector(".flash p").textContent=this.warning),e.classList.remove("none"),this.hide&&this.hideAfterTime()}},{key:"hideAfterTime",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4e3;setTimeout(function(){document.querySelector(".flash").classList.add("none")},e)}}])&&c(n.prototype,r),i&&c(n,i),t}(),p={disconnectedForTooLong:function(){new f({alert:"You have been disconnected from the server for too long. Reload page!",hide:!1}).render()}},y=(n(31),n(17),n(18),n(0)),m=n.n(y),b=n(16),d="ADD_ARTICLES",h="PREPEND_ARTICLES",v="REMOVE_ARTICLE",w="SET_ARTICLES",g="UPDATE_ARTICLE",_="ADD_COMMENTS",O="REMOVE_COMMENT",j="SET_COMMENTS",S="UPDATE_COMMENT",E="PREPEND_USERS";function k(e){return{type:d,articles:e}}function P(e){return{type:w,articles:e}}function x(e,t){return{type:g,article:e,index:t}}function R(e,t){return{type:_,articleId:t,comments:e}}function I(e,t){return{type:j,comments:e,articleId:t}}function C(e,t,n){return{type:S,comment:e,articleId:t,index:n}}var T=n(56),A=(n(26),n(54),n(35)),B=Object(A.a)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case d:return e.concat(t.articles);case h:return t.articles.concat(e);case v:return e.filter(function(e){return e.id!==t.id});case w:return t.articles;case g:e[t.index]=t.article;break;default:return e}}),z=(n(70),Object(A.a)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case _:e[t.articleId]=e[t.articleId].concat(t.comments);break;case O:if(null==e[t.articleId])return e;e[t.articleId]=e[t.articleId].filter(function(e){return e.id!==t.id});break;case j:e[t.articleId]=t.comments;break;case S:var n=t.articleId,r=t.index;if(!r){var o=e[n].find(function(e){return e.id===t.comment.id});r=e[n].indexOf(o)}e[n][r]=t.comment;break;default:return e}})),N=Object(A.a)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USERS":return t.users;case E:return t.users.concat(e);default:return e}}),D=Object(T.a)({articles:B,comments:z,users:N}),L=Object(T.b)(D);function q(e){return(q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function M(e,t){return!t||"object"!==q(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function V(e){return(V=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function U(e,t){return(U=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var F=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),M(this,V(t).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&U(e,t)}(t,o["Views"].Base),t}();n(102);function W(e){return(W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function H(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function J(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){H(i,r,o,a,c,"next",e)}function c(e){H(i,r,o,a,c,"throw",e)}a(void 0)})}}function Y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $(e,t){return!t||"object"!==W(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function G(e){return(G=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function K(e,t){return(K=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Q=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=$(this,G(t).call(this,n))).article=null,e}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&K(e,t)}(t,o["Views"].Base),n=t,(r=[{key:"renderArticle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null==this.article&&(this.connectWith(e,{receiver:"articleReceivedSignal"}),this.article=e),document.getElementById("article_title").textContent=this.article.title,document.getElementById("article_text").textContent=this.article.content;var t=document.getElementById("publish_article");t&&null!=this.article.publishedAt?t.style.display="none":t&&(t.style.display=""),this._handlePublishing(),this._updateEditLink()}},{key:"articleReceivedSignal",value:function(){var e=J(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t,e.next="updated"===e.t0?3:"destroyed"===e.t0?8:9;break;case 3:return e.next=5,this.article.reload();case 5:return this.article.applyChanges(),this.renderArticle(),e.abrupt("break",9);case 8:window.location.href="/user/articles?message=deleted";case 9:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"_handlePublishing",value:function(){var e=this;document.getElementById("publish_article").addEventListener("click",function(){var t=J(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),n.target.textContent="Publishing...",t.prev=2,t.next=5,e.article.put("publish");case 5:document.getElementById("publish_article").outerHTML="<span>Published!</span>",t.next=13;break;case 8:t.prev=8,t.t0=t.catch(2),document.getElementById("publish_article").textContent="Publish",new f({alert:"Connection error!"}).render();case 13:case"end":return t.stop()}},t,null,[[2,8]])}));return function(e){return t.apply(this,arguments)}}())}},{key:"_updateEditLink",value:function(){var e=document.getElementById("edit_link").getAttribute("href");document.getElementById("edit_link").setAttribute("href",e.replace("/0/","/".concat(this.article.id,"/")))}}])&&Y(n.prototype,r),i&&Y(n,i),t}();n(142),n(144),n(146);function X(e){return(X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Z(e,t){return!t||"object"!==X(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ee(e){return(ee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function te(e,t){return(te=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ne(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var re=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Z(this,ee(t).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&te(e,t)}(t,o["Models"].Base),t}();ne(re,"identity","Article.Comment"),ne(re,"remoteName","Comment"),ne(re,"resources",{url:"/user/articles/:articleId/comments",paginate:{per:10},main:{url:"/articles/:articleId/comments",paginate:{per:5,param:"page-num"}},admin:{url:"/admin/articles/:articleId/comments",paginate:{per:5}}}),ne(re,"attributes",{author:{validations:{presence:!0}},text:{validations:{presence:!0,vulgarity:!0}},articleId:{type:"Int",validations:{presence:!0},remoteName:"article_id"},createdAt:{type:"Date",remoteName:"created_at"},updatedAt:{type:"Date",remoteName:"updated_at"},emotion:{type:"Int"},pinned:{type:"Boolean"},adminRate:{type:"Int",remoteName:"admin_rate"},approved:{type:"Boolean"}});var oe=re,ie=(n(32),n(3)),ae=n.n(ie),ce=function(e,t){return e.comments[t]};n(104),n(105),n(106);function ue(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){le(e,t,n[t])})}return e}function le(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function se(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function fe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function pe(e){var t,n=e.comment,r=e.isAdmin,i=void 0!==r&&r,a=fe(Object(y.useState)(!1),2),c=a[0],u=a[1],l=new o.Services.Date(n.createdAt).strftime("%d %b %y"),s=function(){var e,t=(e=regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),u(!0),n.approved=!0,e.next=5,n.updateAttribute("approved");case 5:if(e.sent.ok){e.next=8;break}return e.abrupt("return");case 8:L.dispatch(C(new oe(ue({},n,{approved:!0})),n.articleId));case 9:case"end":return e.stop()}},e)}),function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){se(i,r,o,a,c,"next",e)}function c(e){se(i,r,o,a,c,"throw",e)}a(void 0)})});return function(e){return t.apply(this,arguments)}}();return m.a.createElement("p",{id:"comment_".concat(n.id)},m.a.createElement("b",null,n.author)," on ",m.a.createElement("i",null,l),i?(t=n.approved?m.a.createElement(m.a.Fragment,null,m.a.createElement("span",null,"approved")," |"," "):c?m.a.createElement(m.a.Fragment,null,m.a.createElement("span",null,"approving...")," |"," "):m.a.createElement(m.a.Fragment,null,m.a.createElement("a",{href:"/user/articles/".concat(n.articleId,"/comments/").concat(n.id,"/approve"),className:"approve",onClick:s},"approve")," ","|"," "),m.a.createElement(m.a.Fragment,null," ","(",t,m.a.createElement("a",{href:"/user/articles/".concat(n.articleId,"/comments/").concat(n.id,"/edit")},"edit")," ","|"," ",m.a.createElement("a",{href:"/user/articles/".concat(n.articleId,"/comments/").concat(n.id),"data-method":"delete","data-confirm":"Are you sure?"},"delete"),")")):"",m.a.createElement("br",null),n.text)}pe.propTypes={comment:ae.a.instanceOf(oe).isRequired,isAdmin:ae.a.bool};var ye=pe;function me(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function be(e){var t=e.articleId,n=e.isAdmin||!1,r=me(Object(y.useState)(e.comments),2),o=r[0],i=r[1];if(Object(y.useEffect)(function(){var e=L.subscribe(function(){return i(ce(L.getState(),t))});return function(){e()}}),0===o.length)return m.a.createElement("p",null,"No comments.");var a=o.map(function(e){return m.a.createElement(ye,{key:e.id,comment:e,isAdmin:n})});return m.a.createElement(m.a.Fragment,null,a)}be.propTypes={articleId:ae.a.number.isRequired,isAdmin:ae.a.bool,comments:ae.a.arrayOf(ae.a.instanceOf(oe)).isRequired};var de=be;function he(e){return(he="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ve(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function we(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function ge(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){we(i,r,o,a,c,"next",e)}function c(e){we(i,r,o,a,c,"throw",e)}a(void 0)})}}function _e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Oe(e,t){return!t||"object"!==he(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function je(e){return(je=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Se(e,t){return(Se=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ee=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Oe(this,je(t).call(this,n))).article=null,e.form=null,e.changes=null,e}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Se(e,t)}(t,o["Views"].Base),n=t,(r=[{key:"render",value:function(e){L.dispatch(k([e])),this.article=e,this.connectWith(this.article),this._handleApplyingChanges(),this.form=new o.UI.Form({for:this.article}),this.form.render()}},{key:"renderComments",value:function(){var e=ge(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,oe.all({articleId:t});case 2:n=e.sent,L.dispatch(I(n.resources,t)),Object(b.render)(m.a.createElement(de,{articleId:t,comments:n.resources,isAdmin:!0}),document.getElementById("comments"));case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"receivedSignal",value:function(){var e=ge(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t,e.next="updating"===e.t0?3:"updated"===e.t0?5:"destroyed"===e.t0?10:11;break;case 3:return document.querySelector("h1").getAttribute("data-mark")!==n.mark&&new f({warning:"Uuups someone else started editing this article."}).render(),e.abrupt("break",11);case 5:return e.next=7,this.article.reload();case 7:return this.changes=this.article.changes(),this._displayChanges(),e.abrupt("break",11);case 10:window.location.href="/user/articles?message=deleted";case 11:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"_displayChanges",value:function(){for(var e=0,t=Object.entries(this.changes);e<t.length;e++){var n=ve(t[e],1)[0],r=document.querySelector("a.apply_changes[data-for=".concat(this.article.getAttrRemoteName(n),"]"));r&&r.classList.remove("none")}}},{key:"_handleApplyingChanges",value:function(){for(var e=this,t=0,n=Array.from(document.querySelectorAll("a.apply_changes"));t<n.length;t++){n[t].addEventListener("click",function(t){t.preventDefault();var n=e.article.getAttrName(t.target.getAttribute("data-for"));e.article[n]=e.changes[n].is,e.form.fill(n),t.target.classList.add("none")})}}}])&&_e(n.prototype,r),i&&_e(n,i),t}();function ke(e){return(ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Pe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xe(e,t){return!t||"object"!==ke(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Re(e){return(Re=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ie(e,t){return(Ie=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ce(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Te=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=xe(this,Re(t).call(this,e))).published=null!=n.publishedAt,n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ie(e,t)}(t,o["Models"].Base),n=t,(r=[{key:"vulgarityLevel",value:function(){(null!=this.title&&/fuck/i.exec(this.title)||null!=this.content&&/fuck/i.exec(this.content))&&this.addErrorMessage("Article contains strong language.",{for:"base"})}},{key:"setDefaultValuesForAdminReview",value:function(){this.adminRate=null==this.adminRate?3:this.adminRate,this.categoryId=null==this.categoryId?6:this.categoryId,this.adminReviewStartedAt=Date.now()}}])&&Pe(n.prototype,r),i&&Pe(n,i),t}();Ce(Te,"identity","Article"),Ce(Te,"resources",{url:"/user/articles",paginate:{per:5},main:{url:"/articles",paginate:{per:3}},admin:{url:"/admin/articles",paginate:{per:4}}}),Ce(Te,"attributes",{title:{validations:{presence:!0,length:{within:[3,255]}}},content:{validations:{presence:!0,length:{minimum:100}},remoteName:"text"},createdAt:{type:"Date",remoteName:"created_at"},updatedAt:{type:"Date",remoteName:"updated_at"},commentsCount:{type:"Int",remoteName:"comments_count"},publishedAt:{type:"Date",remoteName:"published_at"},published:{},adminReview:{remoteName:"admin_review"},adminRate:{type:"Int",remoteName:"admin_rate"},categoryId:{type:"Int",remoteName:"category_id"},adminReviewStartedAt:{remoteName:"admin_review_started_at"}}),Ce(Te,"validate",["vulgarityLevel"]);var Ae=Te;function Be(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function ze(e){var t=e.article,n=e.onArticleDestroyed,r=function(){var e,r=(e=regeneratorRuntime.mark(function e(r){var o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r.preventDefault(),confirm("Are you sure?")){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,t.delete(null);case 5:(o=e.sent).success&&L.dispatch((i=o.id,{type:v,id:i})),n(o);case 8:case"end":return e.stop()}var i},e)}),function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){Be(i,r,o,a,c,"next",e)}function c(e){Be(i,r,o,a,c,"throw",e)}a(void 0)})});return function(e){return r.apply(this,arguments)}}();return m.a.createElement("tr",{id:"article_".concat(t.id)},m.a.createElement("td",null,t.title),m.a.createElement("td",null,t.content),m.a.createElement("td",{className:"comments_quantity"},t.commentsCount),m.a.createElement("td",{className:"published"},t.publishedAt?"yes":"no"),m.a.createElement("td",null,m.a.createElement("a",{href:"/user/articles/".concat(t.id)},"Show")," |",m.a.createElement("a",{href:"/user/articles/".concat(t.id,"/edit")},"Edit")," |",m.a.createElement("a",{href:"/user/articles/".concat(t.id),className:"delete_article",onClick:r},"Delete")))}ze.propTypes={article:ae.a.instanceOf(Ae).isRequired,onArticleDestroyed:ae.a.func.isRequired};var Ne=ze;function De(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Le(e){var t=De(Object(y.useState)(e.articles),2),n=t[0],r=t[1];Object(y.useEffect)(function(){var e=L.subscribe(function(){return r(L.getState().articles)});return function(){e()}});var o=n.map(function(t){return m.a.createElement(Ne,{key:t.id,article:t,onArticleDestroyed:e.onArticleDestroyed})});return m.a.createElement(m.a.Fragment,null,o)}Le.propTypes={articles:ae.a.arrayOf(ae.a.instanceOf(Ae)).isRequired,onArticleDestroyed:ae.a.func.isRequired};var qe=Le;function Me(e){return(Me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ve(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function Ue(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){Ve(i,r,o,a,c,"next",e)}function c(e){Ve(i,r,o,a,c,"throw",e)}a(void 0)})}}function Fe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function We(e,t){return!t||"object"!==Me(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function He(e){return(He=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Je(e,t){return(Je=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ye=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),We(this,He(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Je(e,t)}(t,o["Controllers"].Base),n=t,(r=[{key:"initialize",value:function(){this.layout=new F}},{key:"onArticleDestroyed",value:function(e){var t=new f;e.success?t.setNotice(e.notice):t.setAlert(e.alert),t.render()}},{key:"index",value:function(){var e=Ue(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return"deleted"===this.params.message&&new f({alert:"Article has been deleted."}).render(),e.next=3,Ae.get("all");case 3:t=e.sent,L.dispatch(P(t.resources)),Object(b.render)(m.a.createElement(qe,{articles:t.resources,onArticleDestroyed:this.onArticleDestroyed}),document.getElementById("article_list"));case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"show",value:function(){var e=Ue(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.showView=new Q,e.next=3,Ae.find(this.params.id);case 3:return t=e.sent,L.dispatch(P([t])),this.showView.renderArticle(t),e.next=8,oe.all({articleId:this.params.id});case 8:n=e.sent,L.dispatch(I(n.resources,this.params.id)),Object(b.render)(m.a.createElement(de,{articleId:this.params.id,comments:n.resources}),document.getElementById("comments"));case 11:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"new",value:function(){(new Ee).render(new Ae)}},{key:"edit",value:function(){var e=Ue(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(t=new Ee).renderComments(this.params.id),e.next=4,Ae.find(this.params.id);case 4:n=e.sent,t.render(n);case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}])&&Fe(n.prototype,r),i&&Fe(n,i),t}();function $e(e){return($e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ge(e,t){return!t||"object"!==$e(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ke(e){return(Ke=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Qe(e,t){return(Qe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Xe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ze=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ge(this,Ke(t).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qe(e,t)}(t,o["Models"].Base),t}();Xe(Ze,"identity","Room.Member"),Xe(Ze,"resources",{url:"/user/rooms/:roomId/members",paginate:{per:100}}),Xe(Ze,"attributes",{}),Xe(Ze,"validate",[]);var et=Ze;n(151),n(107);function tt(e){return(tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nt(e,t){return!t||"object"!==tt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function rt(e){return(rt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ot(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function it(e,t,n){return t&&ot(e.prototype,t),n&&ot(e,n),e}function at(e,t){return(at=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ct(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ut=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),nt(this,rt(t).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&at(e,t)}(t,o["Models"].Base),it(t,null,[{key:"receivedSignal",value:function(e){console.log("User.receivedSignal: ".concat(e))}}]),it(t,[{key:"receivedSignal",value:function(e){console.log("User#receivedSignal: ".concat(e))}}]),t}();ct(ut,"identity","User"),ct(ut,"resources",{url:"/users",admin:{url:"/admin/users"}}),ct(ut,"paginate",{per:10}),ct(ut,"attributes",{email:{validations:{presence:!0,format:{with:/^([^@\s]+)@((?:[-a-z0-9]+\.)+[a-z]{2,})$/i}}},username:{validations:{presence:!0,format:{with:/^[a-z][a-z0-9_-]*$/i}}},password:{validations:{presence:{on:"create"},confirmation:!0}},passwordConfirmation:{remoteName:"password_confirmation"},confirmed:{},createdAt:{type:"Date",remoteName:"created_at"},updatedAt:{type:"Date",remoteName:"updated_at"}});var lt=ut;function st(e){return(st="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ft(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pt(e,t){return!t||"object"!==st(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function yt(e){return(yt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function mt(e,t){return(mt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var bt=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),pt(this,yt(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mt(e,t)}(t,o["Views"].Base),n=t,(r=[{key:"render",value:function(){this.connectWith(lt)}},{key:"receivedSignal",value:function(e,t){switch(e){case"Room member_joined":this._memberJoined(t.room_id);break;case"Room member_left":this._memberLeft(t.room_id);break;case"Room created":var n=this._renderRoom(t.room);document.getElementById("rooms_list").insertAdjacentHTML("beforeend",n);break;case"Room destroyed":var r=document.getElementById("room_".concat(t.room_id));r.parentNode.removeChild(r)}}},{key:"_memberJoined",value:function(e){var t=this._membersNode(e);t.textContent=parseInt(t.text())+1}},{key:"_memberLeft",value:function(e){var t=this._membersNode(e);t.textContent=parseInt(t.text())-1}},{key:"_membersNode",value:function(e){document.querySelector("#room_".concat(e," td.members"))}},{key:"_renderRoom",value:function(e){"\n    <tr id='room_".concat(e.id,"'>\n      <td>").concat(e.name,"</td>\n      <td class='members'>0</td>\n      <td>\n        <a rel='nofollow' data-method='patch' href='/user/rooms/").concat(e.id,"/join'>Join</a> |\n        <a data-confirm='R U sure?' rel='nofollow' data-method='delete'\n          href='/user/rooms/").concat(e.id,"'>Destroy</a>\n      </td>\n    </tr>\n    ")}}])&&ft(n.prototype,r),i&&ft(n,i),t}();function dt(e){return(dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ht(e,t){return!t||"object"!==dt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function vt(e){return(vt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wt(e,t){return(wt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function gt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var _t=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ht(this,vt(t).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wt(e,t)}(t,o["Models"].Base),t}();gt(_t,"identity","Room"),gt(_t,"resources",{}),gt(_t,"attributes",{}),gt(_t,"validate",[]);var Ot=_t;function jt(e){return(jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function St(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Et(e,t){return!t||"object"!==jt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function kt(e){return(kt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Pt(e,t){return(Pt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var xt=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Et(this,kt(t).call(this,n))).roomId=n.id,e}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pt(e,t)}(t,o["Views"].Base),n=t,(r=[{key:"render",value:function(){this.connectWith(Ot),this._handleSendingMessage()}},{key:"renderMembers",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=e[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;this._memberJoined(a)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}}},{key:"receivedMessage",value:function(e,t){var n="<p><b>".concat(t,"</b>: ").concat(e,"</p>");document.getElementById("messages").insertAdjacentHTML("beforeend",n)}},{key:"receivedSignal",value:function(e,t){switch(e){case"Room member_joined":if(t.room_id!==this.roomId)return;this._memberJoined(t.member);break;case"Room member_left":if(t.room_id!==this.roomId)return;this._memberLeft(t.member)}}},{key:"_handleSendingMessage",value:function(){var e=this;document.querySelector("[data-behavior~=room-speaker]").addEventListener("keypress",function(t){13===t.keyCode&&(t.preventDefault(),o.Env.loco.emit({signal:"message",txt:t.target.value,room_id:e.roomId}),t.target.value="")})}},{key:"_memberJoined",value:function(e){var t="<li id='user_".concat(e.id,"'>").concat(e.username,"</li>");document.getElementById("members").insertAdjacentHTML("beforeend",t)}},{key:"_memberLeft",value:function(e){var t=document.querySelector("#members li#user_".concat(e.id));t.parentNode.removeChild(t)}}])&&St(n.prototype,r),i&&St(n,i),t}();function Rt(e){return(Rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function It(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function Ct(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Tt(e,t){return!t||"object"!==Rt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function At(e){return(At=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Bt(e,t){return(Bt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var zt=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Tt(this,At(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Bt(e,t)}(t,o["Controllers"].Base),n=t,(r=[{key:"initialize",value:function(){}},{key:"index",value:function(){(new bt).render()}},{key:"show",value:function(){var e,t=(e=regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new xt({id:this.params.id}),this.setView("show",t),t.render(),e.next=5,et.all({roomId:this.params.id});case 5:n=e.sent,t.renderMembers(n.resources);case 7:case"end":return e.stop()}},e,this)}),function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){It(i,r,o,a,c,"next",e)}function c(e){It(i,r,o,a,c,"throw",e)}a(void 0)})});return function(){return t.apply(this,arguments)}}()}])&&Ct(n.prototype,r),i&&Ct(n,i),t}();function Nt(e){return(Nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Dt(e,t){return!t||"object"!==Nt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Lt(e){return(Lt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function qt(e,t){return(qt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.assign(o.Controllers.Base.prototype,p);var Mt=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Dt(this,Lt(t).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qt(e,t)}(t,o["Controllers"].Base),t}();Object.assign(Mt,{Articles:Ye,Rooms:zt});var Vt=Mt;function Ut(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ft=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"receivedSignal",value:function(e){switch(e.signal){case"ping":this._pingSignal();break;case"message":this._messageSignal(e)}}},{key:"_pingSignal",value:function(){o.Env.namespaceController.constructor===Vt&&alert("Ping!")}},{key:"_messageSignal",value:function(e){var t=this._getRoomView();t&&t.receivedMessage(e.message,e.author)}},{key:"_getRoomView",value:function(){return o.Env.namespaceController.constructor===Vt&&(o.Env.controller.constructor===zt&&("show"===o.Env.action&&o.Env.controller.getView("show")))}}])&&Ut(t.prototype,n),r&&Ut(t,r),e}(),Wt=function(e){return function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=t[e];r.parentId&&(o=o[r.parentId]);var i=o.find(function(e){return e.id===n});return i?[i,o.indexOf(i)]:[null,null]}},Ht=Wt("articles"),Jt=Wt("comments");function Yt(e){var t=e.comment,n=new o.Services.Date(t.createdAt).strftime("%d %b %y");return m.a.createElement("p",{id:"comment_".concat(t.id)},m.a.createElement("b",null,t.author)," on ",m.a.createElement("i",null,n)," (",m.a.createElement("a",{href:"/admin/articles/".concat(t.articleId,"/comments/").concat(t.id,"/edit")},"edit"),")",m.a.createElement("br",null),t.text)}Yt.propTypes={comment:ae.a.instanceOf(oe).isRequired};var $t=Yt;function Gt(e){var t=e.comments;return 0===t.length?m.a.createElement("p",null,"No comments"):m.a.createElement(m.a.Fragment,null,t.map(function(e){return m.a.createElement($t,{comment:e,key:e.id})}))}Gt.propTypes={comments:ae.a.arrayOf(ae.a.instanceOf(oe)).isRequired};var Kt=Gt;function Qt(e){return(Qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xt(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function Zt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function en(e,t){return!t||"object"!==Qt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function tn(e){return(tn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function nn(e,t){return(nn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var rn=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=en(this,tn(t).call(this,n))).article=null,e}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nn(e,t)}(t,o["Views"].Base),n=t,(r=[{key:"receivedSignal",value:function(){var e,t=(e=regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t,e.next="updated"===e.t0?3:7;break;case 3:return e.next=5,this.article.reload();case 5:this.article.applyChanges(),this._renderArticle();case 7:case"end":return e.stop()}},e,this)}),function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){Xt(i,r,o,a,c,"next",e)}function c(e){Xt(i,r,o,a,c,"throw",e)}a(void 0)})});return function(e){return t.apply(this,arguments)}}()},{key:"render",value:function(e){this.article=e,this.connectWith(e),this._renderArticle()}},{key:"renderComments",value:function(e){Object(b.render)(m.a.createElement(Kt,{comments:e}),document.getElementById("comments"))}},{key:"_renderArticle",value:function(){document.getElementById("article_author").textContent=this.article.author,document.getElementById("article_title").textContent=this.article.title,document.getElementById("article_text").textContent=this.article.content}}])&&Zt(n.prototype,r),i&&Zt(n,i),t}();function on(e){return(on="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function an(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function cn(e,t){return!t||"object"!==on(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function un(e){return(un=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ln(e,t){return(ln=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var sn=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),cn(this,un(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ln(e,t)}(t,o["Views"].Base),n=t,(r=[{key:"render",value:function(e){e.setDefaultValuesForAdminReview(),new o.UI.Form({id:"edit_article_form",for:e}).render()}}])&&an(n.prototype,r),i&&an(n,i),t}();n(55);function fn(e){var t=e.article,n=new o.Services.Date(t.publishedAt).toString("short");return m.a.createElement("article",{id:"article_".concat(t.id)},m.a.createElement("h2",null,t.title),m.a.createElement("p",null,m.a.createElement("i",null,t.author," wrote this on ",n," /"," ",m.a.createElement("span",{className:"comments_quantity"},t.commentsCount," comment",1===t.commentsCount?"":"s"))),m.a.createElement("p",null,t.content),m.a.createElement("p",null,m.a.createElement("a",{href:"/admin/articles/".concat(t.id,"/edit")},"Review")))}fn.propTypes={article:ae.a.instanceOf(Ae).isRequired};var pn=fn;function yn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function mn(e){var t=yn(Object(y.useState)(e.articles),2),n=t[0],r=t[1];Object(y.useEffect)(function(){var e=L.subscribe(function(){return r(L.getState().articles)});return function(){e()}});var o=n.map(function(e){return m.a.createElement(pn,{key:e.id,article:e})});return m.a.createElement(m.a.Fragment,null,o)}mn.propTypes={articles:ae.a.arrayOf(ae.a.instanceOf(Ae)).isRequired};var bn=mn;function dn(e){return(dn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hn(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function vn(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){hn(i,r,o,a,c,"next",e)}function c(e){hn(i,r,o,a,c,"throw",e)}a(void 0)})}}function wn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function gn(e,t){return!t||"object"!==dn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _n(e){return(_n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function On(e,t){return(On=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var jn=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),gn(this,_n(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&On(e,t)}(t,o["Controllers"].Base),n=t,(r=[{key:"published",value:function(){var e=vn(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ae.get("published");case 2:t=e.sent,L.dispatch(P(t.resources)),Object(b.render)(m.a.createElement(bn,{articles:t.resources}),document.getElementById("articles"));case 5:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},{key:"edit",value:function(){var e=vn(regeneratorRuntime.mark(function e(){var t,n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new rn,e.next=3,Ae.find(this.params.id);case 3:return n=e.sent,t.render(n),(new sn).render(n),e.next=8,oe.all({articleId:this.params.id});case 8:r=e.sent,t.renderComments(r.resources);case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}])&&wn(n.prototype,r),i&&wn(n,i),t}();function Sn(e){return(Sn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function En(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function kn(e,t){return!t||"object"!==Sn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Pn(e){return(Pn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function xn(e,t){return(xn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Rn=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),kn(this,Pn(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xn(e,t)}(t,o["Views"].Base),n=t,(r=[{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new o.UI.Form({for:new oe({id:e.commentId,resource:"admin"}),id:"edit_comment_".concat(e.commentId),initObj:!0});t.render(),o.Env.test={commentFormObj:t.getObj()}}}])&&En(n.prototype,r),i&&En(n,i),t}();function In(e){return(In="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Cn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Tn(e,t){return!t||"object"!==In(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function An(e){return(An=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Bn(e,t){return(Bn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var zn=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Tn(this,An(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Bn(e,t)}(t,o["Controllers"].Base),n=t,(r=[{key:"edit",value:function(){(new Rn).render({commentId:this.params.id})}}])&&Cn(n.prototype,r),i&&Cn(n,i),t}();function Nn(e){return(Nn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Dn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ln(e,t){return!t||"object"!==Nn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qn(e){return(qn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Mn(e,t){return(Mn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Vn=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ln(this,qn(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Mn(e,t)}(t,o["Views"].Base),n=t,(r=[{key:"render",value:function(){new o.UI.Form({id:"sign_in_admin",delegator:this,callbackSuccess:"_signedIn"}).render()}},{key:"_signedIn",value:function(){window.location.href="/admin"}}])&&Dn(n.prototype,r),i&&Dn(n,i),t}();function Un(e){return(Un="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Wn(e,t){return!t||"object"!==Un(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Hn(e){return(Hn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Jn(e,t){return(Jn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Yn=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Wn(this,Hn(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Jn(e,t)}(t,o["Controllers"].Base),n=t,(r=[{key:"new",value:function(){(new Vn).render()}}])&&Fn(n.prototype,r),i&&Fn(n,i),t}(),$n=function(e){var t=e.user;return m.a.createElement("tr",{id:"user_".concat(t.id)},m.a.createElement("td",null,t.email),m.a.createElement("td",null,t.username),m.a.createElement("td",{className:"confirmed"},t.confirmed?"Yes":"No"),m.a.createElement("td",null,m.a.createElement("a",{href:"/admin/users/".concat(t.id)},"Show")," |"," ",m.a.createElement("a",{href:"/admin/users/".concat(t.id,"/edit")},"Edit")," |"," ",m.a.createElement("a",{href:"/admin/users/".concat(t.id),"data-method":"delete","data-confirm":"Are you sure?"},"Delete")," ","|"," ",m.a.createElement("a",{href:"#",onClick:function(e){return function(e,t){e.preventDefault(),o.Env.loco.emit({signal:"ping",user_id:t})}(e,t.id)}},"Ping")))};$n.propTypes={user:ae.a.instanceOf(lt).isRequired};var Gn=$n;function Kn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Qn(e){var t=Kn(Object(y.useState)(e.users),2),n=t[0],r=t[1];Object(y.useEffect)(function(){var e=L.subscribe(function(){return r(L.getState().users)});return function(){e()}});var o=n.map(function(e){return m.a.createElement(Gn,{key:"user_".concat(e.id),user:e})});return m.a.createElement(m.a.Fragment,null,o)}Qn.propTypes={users:ae.a.arrayOf(ae.a.instanceOf(lt)).isRequired};var Xn=Qn;function Zn(e){return(Zn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function er(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tr(e,t){return!t||"object"!==Zn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function nr(e){return(nr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function rr(e,t){return(rr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var or=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=tr(this,nr(t).call(this,n))).user=n.user,e}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rr(e,t)}(t,o["Views"].Base),n=t,(r=[{key:"render",value:function(){document.getElementById("user_email").textContent=this.user.email,document.getElementById("user_username").textContent=this.user.username,document.getElementById("user_confirmed").textContent=this.user.confirmed?"Yes":"No",this._updateEditLink()}},{key:"_updateEditLink",value:function(){var e=document.getElementById("edit_link"),t=e.getAttribute("href");e.setAttribute("href",t.replace("/0/","/#{@user.id}/"))}}])&&er(n.prototype,r),i&&er(n,i),t}();function ir(e){return(ir="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ar(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function cr(e,t){return!t||"object"!==ir(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ur(e){return(ur=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function lr(e,t){return(lr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var sr=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=cr(this,ur(t).call(this,n))).user=n.user,e}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&lr(e,t)}(t,o["Views"].Base),n=t,(r=[{key:"render",value:function(){new o.UI.Form({for:this.user,initObj:!0,id:"admin_user_form"}).render()}}])&&ar(n.prototype,r),i&&ar(n,i),t}();function fr(e){return(fr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pr(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function yr(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){pr(i,r,o,a,c,"next",e)}function c(e){pr(i,r,o,a,c,"throw",e)}a(void 0)})}}function mr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function br(e,t){return!t||"object"!==fr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function dr(e){return(dr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function hr(e,t){return(hr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var vr=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),br(this,dr(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hr(e,t)}(t,o["Controllers"].Base),n=t,(r=[{key:"index",value:function(){var e=yr(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,lt.get("all");case 2:t=e.sent,L.dispatch((n=t.resources,{type:E,users:n})),Object(b.render)(m.a.createElement(Xn,{users:t.resources}),document.querySelector("table tbody"));case 5:case"end":return e.stop()}var n},e)}));return function(){return e.apply(this,arguments)}}()},{key:"show",value:function(){var e=yr(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,lt.find(this.params.id);case 2:t=e.sent,new or({user:t}).render();case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"edit",value:function(){new sr({user:new lt({id:this.params.id})}).render()}}])&&mr(n.prototype,r),i&&mr(n,i),t}();function wr(e){return(wr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function gr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _r(e,t){return!t||"object"!==wr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Or(e){return(Or=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function jr(e,t){return(jr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.assign(o.Controllers.Base.prototype,p);var Sr=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),_r(this,Or(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jr(e,t)}(t,o["Controllers"].Base),n=t,(r=[{key:"initialize",value:function(){this.setScope("admin")}}])&&gr(n.prototype,r),i&&gr(n,i),t}();Object.assign(Sr,{Articles:jn,Comments:zn,Sessions:Yn,Users:vr});var Er=Sr;function kr(e){var t=e.comment,n=new o.Services.Date(t.createdAt).strftime("%d %b %y");return m.a.createElement("p",{id:"comment_".concat(t.id)},m.a.createElement("b",null,t.author)," on ",m.a.createElement("i",null,n)," wrote:",m.a.createElement("br",null),t.text)}kr.propTypes={comment:ae.a.instanceOf(oe).isRequired};var Pr=kr;function xr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Rr(e){var t=e.articleId,n=xr(Object(y.useState)(e.comments),2),r=n[0],o=n[1];Object(y.useEffect)(function(){var e=L.subscribe(function(){o(ce(L.getState(),t))});return function(){e()}});var i=r.map(function(e){return m.a.createElement(Pr,{key:e.id,comment:e})});return 0===r.length?m.a.createElement("p",{id:"no_comments"},"No comments."):m.a.createElement(m.a.Fragment,null,i)}Rr.propTypes={articleId:ae.a.number.isRequired,comments:ae.a.arrayOf(ae.a.instanceOf(oe)).isRequired};var Ir=Rr;function Cr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Tr(e){var t=Cr(Object(y.useState)(e.comments),2),n=t[0],r=t[1];return Object(y.useEffect)(function(){var t=L.subscribe(function(){r(ce(L.getState(),e.articleId))});return function(){t()}}),m.a.createElement(m.a.Fragment,null,"".concat(n.length," comment").concat(1===n.length?"":"s"))}Tr.propTypes={articleId:ae.a.number.isRequired,comments:ae.a.arrayOf(ae.a.instanceOf(oe)).isRequired};var Ar=Tr;function Br(e){return(Br="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zr(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function Nr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Dr(e,t){return!t||"object"!==Br(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Lr(e){return(Lr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function qr(e,t){return(qr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Mr=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Dr(this,Lr(t).call(this,n))).article=null,e.newComment=n.comment,e}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qr(e,t)}(t,o["Views"].Base),n=t,(r=[{key:"render",value:function(){new o.UI.Form({for:this.newComment,initObj:!0,id:"new_comment"}).render()}},{key:"renderArticle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.article||(this.article=e,this.connectWith(this.article,{receiver:"_articleReceivedSignal"})),document.getElementById("title").textContent=this.article.title,document.getElementById("author").textContent=this.article.author;var t=new o.Services.Date(this.article.publishedAt);document.getElementById("pub_date").textContent=t.toString("short");var n=document.getElementById("text");n.innerHTML="";var r=(new o.Helpers.Text).simpleFormat(this.article.content);n.insertAdjacentHTML("beforeend",r)}},{key:"_articleReceivedSignal",value:function(){var e,t=(e=regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t,e.next="updating"===e.t0?3:"updated"===e.t0?7:11;break;case 3:return"Author is currently editing article. Be aware of possible changes.",new f({warning:"Author is currently editing article. Be aware of possible changes."}).render(),e.abrupt("break",11);case 7:return e.next=9,this.article.reload();case 9:this.article.applyChanges(),this.renderArticle();case 11:case"end":return e.stop()}},e,this)}),function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){zr(i,r,o,a,c,"next",e)}function c(e){zr(i,r,o,a,c,"throw",e)}a(void 0)})});return function(e){return t.apply(this,arguments)}}()}])&&Nr(n.prototype,r),i&&Nr(n,i),t}();function Vr(e){return(Vr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ur(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function Fr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Wr(e,t){return!t||"object"!==Vr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Hr(e){return(Hr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Jr(e,t){return(Jr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Yr=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Wr(this,Hr(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Jr(e,t)}(t,o["Controllers"].Base),n=t,(r=[{key:"show",value:function(){var e,t=(e=regeneratorRuntime.mark(function e(){var t,n,r,o,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new oe({articleId:this.params.id}),(n=new Mr({comment:t})).render(),e.next=5,Ae.find(this.params.id);case 5:return r=e.sent,L.dispatch(P([r])),n.renderArticle(r),e.next=10,oe.get("count",{articleId:this.params.id});case 10:return o=e.sent,e.next=13,oe.all({articleId:this.params.id,total:o.total});case 13:i=e.sent,L.dispatch(I(i,this.params.id)),Object(b.render)(m.a.createElement(Ir,{articleId:this.params.id,comments:i}),document.getElementById("comments")),Object(b.render)(m.a.createElement(Ar,{articleId:this.params.id,comments:i}),document.getElementById("comments_count"));case 17:case"end":return e.stop()}},e,this)}),function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){Ur(i,r,o,a,c,"next",e)}function c(e){Ur(i,r,o,a,c,"throw",e)}a(void 0)})});return function(){return t.apply(this,arguments)}}()}])&&Fr(n.prototype,r),i&&Fr(n,i),t}();function $r(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function Gr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Kr(){var e=Gr(Object(y.useState)(1),2),t=e[0],n=e[1],r=Gr(Object(y.useState)(!1),2),o=r[0],i=r[1];function a(e){return c.apply(this,arguments)}function c(){var e;return e=regeneratorRuntime.mark(function e(r){var o,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),n(o=t+1),a=null,e.prev=4,e.next=7,Ae.get("all",{page:o});case 7:a=e.sent,e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(4),alert("Invalid URL: ".concat(e.t0)),e.abrupt("return");case 14:a.resources.length>0?L.dispatch(k(a.resources)):i(!0);case 15:case"end":return e.stop()}},e,null,[[4,10]])}),(c=function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){$r(i,r,o,a,c,"next",e)}function c(e){$r(i,r,o,a,c,"throw",e)}a(void 0)})}).apply(this,arguments)}return o?m.a.createElement("span",null,"No more posts."):m.a.createElement("a",{href:"#",id:"load_more",onClick:a},"Load more…")}function Qr(e){var t=e.article,n=new o.Services.Date(t.publishedAt).toString("short");return m.a.createElement("article",{id:"article_".concat(t.id)},m.a.createElement("h2",null,t.title),m.a.createElement("p",null,m.a.createElement("i",null,t.author," wrote this on ",n," /"," ",m.a.createElement("a",{href:"/articles/".concat(t.id,"#comments"),className:"comments_quantity"},t.commentsCount," comment",1===t.commentsCount?"":"s"))),m.a.createElement("p",null,t.content),m.a.createElement("p",null,m.a.createElement("a",{href:"/articles/".concat(t.id)},"Continued…")))}Qr.propTypes={article:ae.a.instanceOf(Ae).isRequired};var Xr=Qr;function Zr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function eo(e){var t=Zr(Object(y.useState)(e.articles),2),n=t[0],r=t[1];Object(y.useEffect)(function(){var e=L.subscribe(function(){return r(L.getState().articles)});return function(){e()}});var o=n.map(function(e){return m.a.createElement(Xr,{key:e.id,article:e})});return m.a.createElement(m.a.Fragment,null,o)}eo.propTypes={articles:ae.a.arrayOf(ae.a.instanceOf(Ae)).isRequired};var to=eo;function no(e){return(no="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ro(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function oo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function io(e,t){return!t||"object"!==no(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ao(e){return(ao=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function co(e,t){return(co=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var uo=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),io(this,ao(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&co(e,t)}(t,o["Controllers"].Base),n=t,(r=[{key:"index",value:function(){var e,t=(e=regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return Object(b.render)(m.a.createElement(Kr,null),document.getElementById("load_more_wrapper")),e.next=3,Ae.get("all",{page:1});case 3:t=e.sent,L.dispatch(P(t.resources)),Object(b.render)(m.a.createElement(to,{articles:t.resources}),document.getElementById("articles"));case 6:case"end":return e.stop()}},e)}),function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){ro(i,r,o,a,c,"next",e)}function c(e){ro(i,r,o,a,c,"throw",e)}a(void 0)})});return function(){return t.apply(this,arguments)}}()}])&&oo(n.prototype,r),i&&oo(n,i),t}();function lo(e){return(lo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function so(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fo(e,t){return!t||"object"!==lo(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function po(e){return(po=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function yo(e,t){return(yo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var mo=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),fo(this,po(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yo(e,t)}(t,o["Views"].Base),n=t,(r=[{key:"render",value:function(){new o.UI.Form({for:new lt,delegator:this,callbackSuccess:"_created"}).render()}},{key:"receivedSignal",value:function(e){switch(e){case"confirming":this._confirming();break;case"confirmed":this._confirmed()}}},{key:"_created",value:function(e){this.connectWith(new lt({id:e.id})),document.querySelector("form").style.display="none",document.getElementById("sign_in_paragraph").classList.remove("none"),document.getElementById("verification_info").classList.remove("none"),new f({notice:e.notice}).render()}},{key:"_confirming",value:function(){document.getElementById("verification_info").textContent=document.getElementById("verification_progress").textContent}},{key:"_confirmed",value:function(){window.location.href="/user/sessions/new?event=confirmed"}}])&&so(n.prototype,r),i&&so(n,i),t}();function bo(e){return(bo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ho(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function vo(e,t){return!t||"object"!==bo(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function wo(e){return(wo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function go(e,t){return(go=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var _o=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),vo(this,wo(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&go(e,t)}(t,o["Controllers"].Base),n=t,(r=[{key:"new",value:function(){(new mo).render()}}])&&ho(n.prototype,r),i&&ho(n,i),t}();function Oo(e){return(Oo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function So(e,t){return!t||"object"!==Oo(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Eo(e){return(Eo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ko(e,t){return(ko=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.assign(o.Controllers.Base.prototype,p);var Po=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),So(this,Eo(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ko(e,t)}(t,o["Controllers"].Base),n=t,(r=[{key:"initialize",value:function(){this.setScope("main")}}])&&jo(n.prototype,r),i&&jo(n,i),t}();Object.assign(Po,{Articles:Yr,Pages:uo,Users:_o});var xo=Po;function Ro(e){return(Ro="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Io(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Co(e,t){return!t||"object"!==Ro(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function To(e){return(To=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ao(e,t){return(Ao=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Bo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){zo(e,t,n[t])})}return e}function zo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function No(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Do(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function Lo(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){Do(i,r,o,a,c,"next",e)}function c(e){Do(i,r,o,a,c,"throw",e)}a(void 0)})}}var qo=function(){var e=Lo(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.id,o.Env.namespaceController.constructor===Vt){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,Ae.find({id:n,abbr:!0});case 5:r=e.sent,L.dispatch(k([r]));case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),Mo=function(){var e=Lo(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.id,o.Env.namespaceController.constructor!==Er){e.next=8;break}return e.next=4,Ae.find({id:n,abbr:!0,resource:"admin"});case 4:r=e.sent,L.dispatch({type:h,articles:[r]}),e.next=12;break;case 8:return e.next=10,Ae.find({id:n,abbr:!0});case 10:i=e.sent,L.dispatch(k([i]));case 12:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),Vo=function(){var e=Lo(regeneratorRuntime.mark(function e(t){var n,r,i,a,c,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.id,r={id:n,abbr:!0},o.Env.namespaceController.constructor===Er&&(r.resource="admin"),i=Ht(L.getState(),n),a=No(i,2),c=a[0],u=a[1],c){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,Ae.find(r);case 8:c=e.sent,L.dispatch(x(c,u));case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),Uo=function(e,t){var n=e.article_id,r=No(Ht(L.getState(),n),2),o=r[0],i=r[1];if(o){var a=new Ae(Bo({},o,{commentsCount:o.commentsCount+t}));L.dispatch(x(a,i))}},Fo=function(){var e=Lo(regeneratorRuntime.mark(function e(t){var n,r,i,a,c,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.article_id,r=t.id,i={articleId:n,id:r},o.Env.namespaceController.constructor===xo&&(i.resource="main"),a=Ht(L.getState(),n),c=No(a,1),c[0]){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,oe.find(i);case 8:u=e.sent,L.dispatch(R([u],n));case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),Wo=function(e){var t=e.article_id,n=e.id;L.dispatch(function(e,t){return{type:O,id:e,articleId:t}}(n,t))},Ho=function(){var e=Lo(regeneratorRuntime.mark(function e(t){var n,r,o,i,a,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.article_id,r=t.id,o=Jt(L.getState(),r,{parentId:n}),i=No(o,2),a=i[0],c=i[1],a){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,a.reload();case 6:a.applyChanges(),L.dispatch(C(new oe(Bo({},a)),n,c));case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),Jo=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Co(this,To(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ao(e,t)}(t,o["Views"].Base),n=t,(r=[{key:"receivedSignal",value:function(){var e=Lo(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t,e.next="Article created"===e.t0?3:"Article published"===e.t0?5:"Article updated"===e.t0?7:"Article.Comment created"===e.t0?9:"Article.Comment destroyed"===e.t0?12:"Article.Comment updated"===e.t0?15:"User created"===e.t0?17:22;break;case 3:return qo(n),e.abrupt("break",22);case 5:return Mo(n),e.abrupt("break",22);case 7:return Vo(n),e.abrupt("break",22);case 9:return Uo(n,1),Fo(n),e.abrupt("break",22);case 12:return Uo(n,-1),Wo(n),e.abrupt("break",22);case 15:return Ho(n),e.abrupt("break",22);case 17:return e.next=19,lt.find(n.id);case 19:return r=e.sent,L.dispatch({type:E,users:[r]}),e.abrupt("break",22);case 22:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"call",value:function(){this.connectWith([Ae,oe,lt])}}])&&Io(n.prototype,r),i&&Io(n,i),t}();o.Deps.cable=Object(i.createConsumer)(),o.Deps.NotificationCenter=Ft;var Yo=new Jo;new o.Loco({notifications:{enable:!0,log:!0,size:10},postInit:function(){Yo.call(),"test"===document.querySelector("body").getAttribute("data-rails-env")&&o.Env.loco.getWire().setPollingTime(1e3)}}).init();n(154);function $o(e){return($o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Go(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ko(e,t){return!t||"object"!==$o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Qo(e){return(Qo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Xo(e,t){return(Xo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Zo,ei,ti,ni=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ko(this,Qo(t).call(this))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xo(e,t)}(t,o["Validators"].Base),n=t,(r=[{key:"validate",value:function(){if(null!=this.val)switch($o(this.val)){case"string":var e=this._getVulgarWord();if(!new RegExp("".concat(e),["i"]).exec(this.val))return;this._addErrorMessage();break;default:throw new TypeError("Vulgarity validator is applicable only for strings and ".concat(this.attr," isn't."))}}},{key:"_addErrorMessage",value:function(){var e=o.I18n[o.Env.loco.getLocale()].errors.messages.vulgarity;this.obj.addErrorMessage(e,{for:this.attr})}},{key:"_getVulgarWord",value:function(){switch(o.Env.loco.getLocale()){case"pl":return"kurwa";case"en":return"fuck"}}}])&&Go(n.prototype,r),i&&Go(n,i),t}();ti="Vulgarity",(ei="identity")in(Zo=ni)?Object.defineProperty(Zo,ei,{value:ti,enumerable:!0,configurable:!0,writable:!0}):Zo[ei]=ti;var ri=ni;Object.assign(o.Validators,{Vulgarity:ri}),o.I18n.pl={variants:{few:function(e){var t=parseInt(o.Utils.String.last(String(e)));-1!==[2,3,4].indexOf(t)&&(2!==String(e).length||String(e)[0])}},models:{},attributes:{},ui:{form:{sending:"Wysyłam...",success:"Sukces",errors:{connection:"Błąd z połączeniem",invalid_data:"Nieprawidłowe dane"}}},date:{formats:{default:"%d-%m-%Y",short:"%d %b",long:"%B %d, %Y"},day_names:["niedziela","poniedziałek","wtorek","środa","czwartek","piątek","sobota"],abbr_day_names:["nie","pon","wto","śro","czw","pią","sob"],month_names:["styczeń","luty","marzec","kwiecień","maj","czerwiec","lipiec","sierpień","wrzesień","październik","listopad","grudzień"],abbr_month_names:["sty","lut","mar","kwi","maj","cze","lip","sie","wrz","paź","lis","gru"]},errors:{messages:{accepted:"musi zostać zaakceptowane",blank:"nie może być puste",confirmation:"nie zgadza się z polem %{attribute}",empty:"nie może być puste",equal_to:"musi być równe %{count}",even:"musi być parzyste",exclusion:"jest zarezerwowane",greater_than:"musi być większe od %{count}",greater_than_or_equal_to:"musi być większe lub równe %{count}",inclusion:"nie znajduje się na liście dopuszczalnych wartości",invalid:"jest nieprawidłowe",less_than:"musi być mniejsze od %{count}",less_than_or_equal_to:"musi być mniejsze lub równe %{count}",not_a_number:"nie jest liczbą",not_an_integer:"musi być liczbą całkowitą",odd:"musi być nieparzyste",present:"musi być puste",too_long:{few:"jest za długie (maksymalnie %{count} znaki)",many:"jest za długie (maksymalnie %{count} znaków)",one:"jest za długie (maksymalnie jeden znak)",other:"jest za długie (maksymalnie %{count} znaków)"},too_short:{few:"jest za krótkie (przynajmniej %{count} znaki)",many:"jest za krótkie (przynajmniej %{count} znaków)",one:"jest za krótkie (przynajmniej jeden znak)",other:"jest za krótkie (przynajmniej %{count} znaków)"},wrong_length:{few:"ma nieprawidłową długość (powinna wynosić %{count} znaki)",many:"ma nieprawidłową długość (powinna wynosić %{count} znaków)",one:"ma nieprawidłową długość (powinna wynosić jeden znak)",other:"ma nieprawidłową długość (powinna wynosić %{count} znaków)"},other_than:"musi być inna niż %{count}"}}},o.I18n.pl.models.User="Użytkownik",o.I18n.pl.attributes.User={password:"Hasło",passwordConfirmation:"Powtórz hasło"},o.I18n.en.errors.messages.vulgarity="contains strong language.",o.I18n.pl.errors.messages.vulgarity="zawiera mocny język.",Object.assign(o.Controllers,{Admin:Er,Main:xo,User:Vt}),Object.assign(Ae,{Comment:oe}),Object.assign(Ot,{Member:et}),Object.assign(o.Models,{Article:Ae,Room:Ot,User:lt}),window.test={Channels:o.Channels,Env:o.Env}}});
//# sourceMappingURL=application.js.map