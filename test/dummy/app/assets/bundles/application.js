!function(){var e,t={278:function(e){var t;self,t=()=>(()=>{"use strict";var e={d:(t,r)=>{for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function n(e){var t=function(e){if("object"!=r(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==r(t)?t:t+""}e.r(t),e.d(t,{Config:()=>o,I18n:()=>i,Models:()=>Le,Validators:()=>Pe,connector:()=>He});const o=new(function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.localeVar="en",this.protocolWithHostVar=null,this.scopeVar=null},(t=[{key:"locale",get:function(){return this.localeVar},set:function(e){this.localeVar=e}},{key:"protocolWithHost",get:function(){return this.protocolWithHostVar},set:function(e){e?"/"===e[e.length-1]?this.protocolWithHostVar=e.slice(0,e.length-1):this.protocolWithHostVar=e:this.protocolWithHostVar=null}},{key:"scope",get:function(){return this.scopeVar},set:function(e){this.scopeVar=e}}])&&function(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,n(o.key),o)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}()),i={en:{variants:{},models:{},attributes:{},errors:{messages:{accepted:"must be accepted",blank:"can't be blank",confirmation:"doesn't match %{attribute}",empty:"can't be empty",equal_to:"must be equal to %{count}",even:"must be even",exclusion:"is reserved",greater_than:"must be greater than %{count}",greater_than_or_equal_to:"must be greater than or equal to %{count}",inclusion:"is not included in the list",invalid:"is invalid",less_than:"must be less than %{count}",less_than_or_equal_to:"must be less than or equal to %{count}",not_a_number:"is not a number",not_an_integer:"must be an integer",odd:"must be odd",present:"must be blank",too_long:{one:"is too long (maximum is 1 character)",other:"is too long (maximum is %{count} characters)"},too_short:{one:"is too short (minimum is 1 character)",other:"is too short (minimum is %{count} characters)"},wrong_length:{one:"is the wrong length (should be 1 character)",other:"is the wrong length (should be %{count} characters)"},other_than:"must be other than %{count}"}}}};function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}var s={},c=function(e,t){if(-1!==e.indexOf(t))return null;var r=function(e){var t=e.length;return e.find(function(e,r){if(null===e)return t=r,!0}),t}(e);return e[r]=t,r},u=function(e,t,r){var n;void 0!==(null===(n=s)||void 0===n||null===(n=n[e])||void 0===n||null===(n=n[t])||void 0===n?void 0:n[r])&&(s[e][t][r]=null)},l=function(e){var t=e.getIdentity();void 0===s[t]&&(s[t]={}),void 0===s[t][e.id]&&(s[t][e.id]=[]),s[t][e.id][0]=e};const f={get imap(){return s},clear:function(){return s={}},subscribe:function(e){var t=function(){};if("object"===a(e.to)){var r=function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).with;l(t);var r=s[t.getIdentity()][t.id];return c(r,e)}(e.with,{with:e.to});return null===r?t:function(){u(e.to.getIdentity(),e.to.id,r)}}if("function"==typeof e.to){var n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};void 0===s[e]&&(s[e]={}),void 0===s[e].collection&&(s[e].collection=[]);var r=s[e].collection;return c(r,t.to)}(e.to.getIdentity(),{to:e.with});return null===n?t:function(){u(e.to.getIdentity(),"collection",n)}}},unsubscribe:u,add:l,find:function(e,t){return void 0!==s[e]&&null!=s[e][t]?s[e][t][0]:null},findConnected:function(e,t){return void 0!==s[e]&&void 0!==s[e][t]&&s[e][t].length>1?s[e][t].slice(1):[]}};function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,p(n.key),n)}}function p(e){var t=function(e){if("object"!=d(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=d(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==d(t)?t:t+""}var y=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.obj=null,this.attr=null,this.val=null,this.opts=null},r=[{key:"instance",value:function(e,t,r){var n=this.identity;null==this.sharedInstances[n]&&(this.sharedInstances[n]=new Pe[n]);var o=this.sharedInstances[n];return o.assignAttribs(e,t,r),o}}],(t=[{key:"assignAttribs",value:function(e,t,r){this.obj=e,this.attr=t,this.val=this.obj[this.attr],this.opts=r}}])&&m(e.prototype,t),r&&m(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}();const h=y;function b(e){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(e)}function v(e){var t=function(e){if("object"!=b(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=b(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==b(t)?t:t+""}function g(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(g=function(){return!!e})()}function w(e){return w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},w(e)}function _(e,t){return _=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},_(e,t)}y.sharedInstances={};var E=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){return t=w(t),function(e,t){if(t&&("object"==b(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,g()?Reflect.construct(t,[],w(e).constructor):t.apply(e,void 0))}(this,t)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_(e,t)}(t,e),r=t,(n=[{key:"validate",value:function(){if("string"===b(this.val)){if(null!=this.val&&0===this.val.length)return}else if(null==this.val)return;this._addErrorMessage()}},{key:"_addErrorMessage",value:function(){var e=null!=this.opts.message?this.opts.message:i[o.locale].errors.messages.present;this.obj.addErrorMessage(e,{for:this.attr})}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,v(n.key),n)}}(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(h);const S=E;function O(e){return O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},O(e)}function j(e){var t=function(e){if("object"!=O(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=O(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==O(t)?t:t+""}function k(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(k=function(){return!!e})()}function P(e){return P=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},P(e)}function I(e,t){return I=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},I(e,t)}E.identity="Absence";var T=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){return t=P(t),function(e,t){if(t&&("object"==O(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,k()?Reflect.construct(t,[],P(e).constructor):t.apply(e,void 0))}(this,t)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&I(e,t)}(t,e),r=t,(n=[{key:"validate",value:function(){var e=this.obj[this._properAttr()];null!=this.val&&null!=e&&this.val===e||this._addErrorMessage()}},{key:"_addErrorMessage",value:function(){var e=this.attr.charAt(0).toUpperCase()+this.attr.slice(1),t=i[o.locale].attributes[this.obj.getIdentity()],r=t&&t[this.attr]||e,n=null!=this.opts.message?this.opts.message:i[o.locale].errors.messages.confirmation;n=n.replace("%{attribute}",r),this.obj.addErrorMessage(n,{for:this._properAttr()})}},{key:"_properAttr",value:function(){return"".concat(this.attr,"Confirmation")}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,j(n.key),n)}}(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(h);const A=T;function C(e){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},C(e)}function R(e){var t=function(e){if("object"!=C(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=C(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==C(t)?t:t+""}function M(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(M=function(){return!!e})()}function N(e){return N=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},N(e)}function z(e,t){return z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},z(e,t)}T.identity="Confirmation";var x=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){return t=N(t),function(e,t){if(t&&("object"==C(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,M()?Reflect.construct(t,[],N(e).constructor):t.apply(e,void 0))}(this,t)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&z(e,t)}(t,e),r=t,(n=[{key:"validate",value:function(){-1!==(this.opts.in||this.opts.within||[]).indexOf(this.val)&&this._addErrorMessage()}},{key:"_addErrorMessage",value:function(){var e=null!=this.opts.message?this.opts.message:i[o.locale].errors.messages.exclusion;this.obj.addErrorMessage(e,{for:this.attr})}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,R(n.key),n)}}(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(h);const B=x;function q(e){return q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},q(e)}function D(e){var t=function(e){if("object"!=q(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=q(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==q(t)?t:t+""}function $(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return($=function(){return!!e})()}function L(e){return L=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},L(e)}function H(e,t){return H=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},H(e,t)}x.identity="Exclusion";var U=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){return t=L(t),function(e,t){if(t&&("object"==q(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,$()?Reflect.construct(t,[],L(e).constructor):t.apply(e,void 0))}(this,t)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&H(e,t)}(t,e),r=t,(n=[{key:"validate",value:function(){null==this.opts.with.exec(this.val||"")&&this._addErrorMessage()}},{key:"_addErrorMessage",value:function(){var e=null!=this.opts.message?this.opts.message:i[o.locale].errors.messages.invalid;this.obj.addErrorMessage(e,{for:this.attr})}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,D(n.key),n)}}(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(h);const F=U;function W(e){return W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},W(e)}function V(e){var t=function(e){if("object"!=W(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=W(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==W(t)?t:t+""}function J(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(J=function(){return!!e})()}function G(e){return G=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},G(e)}function Y(e,t){return Y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Y(e,t)}U.identity="Format";var X=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){return t=G(t),function(e,t){if(t&&("object"==W(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,J()?Reflect.construct(t,[],G(e).constructor):t.apply(e,void 0))}(this,t)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Y(e,t)}(t,e),r=t,(n=[{key:"validate",value:function(){-1===(this.opts.in||this.opts.within||[]).indexOf(this.val)&&this._addErrorMessage()}},{key:"_addErrorMessage",value:function(){var e=null!=this.opts.message?this.opts.message:i[o.locale].errors.messages.inclusion;this.obj.addErrorMessage(e,{for:this.attr})}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,V(n.key),n)}}(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(h);const Z=X;function K(e){return K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},K(e)}function Q(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function ee(e){var t=function(e){if("object"!=K(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=K(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==K(t)?t:t+""}function te(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(te=function(){return!!e})()}function re(e){return re=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},re(e)}function ne(e,t){return ne=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ne(e,t)}X.identity="Inclusion";var oe=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){return t=re(t),function(e,t){if(t&&("object"==K(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,te()?Reflect.construct(t,[],re(e).constructor):t.apply(e,void 0))}(this,t)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ne(e,t)}(t,e),r=t,(n=[{key:"validate",value:function(){if(null!=this.val){var e=null,t=function(e){return function(e){if(Array.isArray(e))return e}(e)||function(e){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,n,o,i,a=[],s=!0,c=!1;try{for(o=(t=t.call(e)).next;!(s=(r=o.call(t)).done)&&(a.push(r.value),2!==a.length);s=!0);}catch(e){c=!0,n=e}finally{try{if(!s&&null!=t.return&&(i=t.return(),Object(i)!==i))return}finally{if(c)throw n}}return a}}(e)||function(e){if(e){if("string"==typeof e)return Q(e,2);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Q(e,2):void 0}}(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(this._range()),r=t[0],n=t[1];null!=r&&null!=n&&r===n&&this.val.length!==r?e=this._selectErrorMessage("wrong_length",r):null!=r&&this.val.length<r?e=this._selectErrorMessage("too_short",r):null!=n&&this.val.length>n&&(e=this._selectErrorMessage("too_long",n)),null!==e&&this.obj.addErrorMessage(e,{for:this.attr})}}},{key:"_range",value:function(){return[this.opts.minimum||this.opts.is||null!=this.opts.within&&this.opts.within[0]||null,this.opts.maximum||this.opts.is||null!=this.opts.within&&this.opts.within[1]||null]}},{key:"_selectErrorMessage",value:function(e,t){if(1===t)return i[o.locale].errors.messages[e].one;for(var r=null,n=0,a=["few","many"];n<a.length;n++){var s=a[n];if(this._checkVariant(s,t)){r=i[o.locale].errors.messages[e][s];break}}return null==r&&(r=i[o.locale].errors.messages[e].other),null!=this.opts.message&&(r=this.opts.message),/%\{count\}/.exec(r)&&(r=r.replace("%{count}",t)),r}},{key:"_checkVariant",value:function(e,t){if(null!=i[o.locale].variants[e])return i[o.locale].variants[e](t)}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ee(n.key),n)}}(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(h);const ie=oe;function ae(e){return ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ae(e)}function se(e){var t=function(e){if("object"!=ae(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=ae(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ae(t)?t:t+""}function ce(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(ce=function(){return!!e})()}function ue(e){return ue=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ue(e)}function le(e,t){return le=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},le(e,t)}oe.identity="Length";var fe=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){return t=ue(t),function(e,t){if(t&&("object"==ae(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,ce()?Reflect.construct(t,[],ue(e).constructor):t.apply(e,void 0))}(this,t)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&le(e,t)}(t,e),r=t,(n=[{key:"validate",value:function(){isNaN(this.val)?this._addNaNErrorMessage():null!=this.opts.only_integer&&Number(this.val)!==parseInt(this.val,10)?this._addIntErrorMessage():null!=this.opts.greater_than&&Number(this.val)<=this.opts.greater_than?this._addGreatherThanErrorMessage():null!=this.opts.greater_than_or_equal_to&&Number(this.val)<this.opts.greater_than_or_equal_to?this._addGreatherThanOrEqualToErrorMessage():null!=this.opts.equal_to&&Number(this.val)!==this.opts.equal_to?this._addEqualToErrorMessage():null!=this.opts.less_than&&Number(this.val)>=this.opts.less_than?this._addLessThanErrorMessage():null!=this.opts.less_than_or_equal_to&&Number(this.val)>this.opts.less_than_or_equal_to?this._addLessThanOrEqualToErrorMessage():null!=this.opts.other_than&&Number(this.val)===this.opts.other_than?this._addOtherThanErrorMessage():null!=this.opts.odd&&Number(this.val)%2!=1?this._addOddErrorMessage():null!=this.opts.even&&Number(this.val)%2!=0&&this._addEvenErrorMessage()}},{key:"_addNaNErrorMessage",value:function(){var e=null!=this.opts.message?this.opts.message:i[o.locale].errors.messages.not_a_number;this.obj.addErrorMessage(e,{for:this.attr})}},{key:"_addIntErrorMessage",value:function(){var e=i[o.locale].errors.messages.not_an_integer;this.obj.addErrorMessage(e,{for:this.attr})}},{key:"_addGreatherThanErrorMessage",value:function(){var e=i[o.locale].errors.messages.greater_than;e=e.replace("%{count}",this.opts.greater_than),this.obj.addErrorMessage(e,{for:this.attr})}},{key:"_addGreatherThanOrEqualToErrorMessage",value:function(){var e=i[o.locale].errors.messages.greater_than_or_equal_to;e=e.replace("%{count}",this.opts.greater_than_or_equal_to),this.obj.addErrorMessage(e,{for:this.attr})}},{key:"_addEqualToErrorMessage",value:function(){var e=i[o.locale].errors.messages.equal_to;e=e.replace("%{count}",this.opts.equal_to),this.obj.addErrorMessage(e,{for:this.attr})}},{key:"_addLessThanErrorMessage",value:function(){var e=i[o.locale].errors.messages.less_than;e=e.replace("%{count}",this.opts.less_than),this.obj.addErrorMessage(e,{for:this.attr})}},{key:"_addLessThanOrEqualToErrorMessage",value:function(){var e=i[o.locale].errors.messages.less_than_or_equal_to;e=e.replace("%{count}",this.opts.less_than_or_equal_to),this.obj.addErrorMessage(e,{for:this.attr})}},{key:"_addOtherThanErrorMessage",value:function(){var e=i[o.locale].errors.messages.other_than;e=e.replace("%{count}",this.opts.other_than),this.obj.addErrorMessage(e,{for:this.attr})}},{key:"_addOddErrorMessage",value:function(){var e=i[o.locale].errors.messages.odd;this.obj.addErrorMessage(e,{for:this.attr})}},{key:"_addEvenErrorMessage",value:function(){var e=i[o.locale].errors.messages.even;this.obj.addErrorMessage(e,{for:this.attr})}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,se(n.key),n)}}(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(h);const de=fe;function me(e){return me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},me(e)}function pe(e){var t=function(e){if("object"!=me(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=me(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==me(t)?t:t+""}function ye(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(ye=function(){return!!e})()}function he(e){return he=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},he(e)}function be(e,t){return be=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},be(e,t)}fe.identity="Numericality";var ve=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){return t=he(t),function(e,t){if(t&&("object"==me(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,ye()?Reflect.construct(t,[],he(e).constructor):t.apply(e,void 0))}(this,t)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&be(e,t)}(t,e),r=t,(n=[{key:"validate",value:function(){if("string"===me(this.val)){if(null!=this.val&&this.val.length>0)return}else if(null!=this.val)return;this._addErrorMessage()}},{key:"_addErrorMessage",value:function(){var e=null!=this.opts.message?this.opts.message:i[o.locale].errors.messages.blank;this.obj.addErrorMessage(e,{for:this.attr})}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pe(n.key),n)}}(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(h);const ge=ve;function we(e){return we="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},we(e)}function _e(e){var t=function(e){if("object"!=we(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=we(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==we(t)?t:t+""}function Ee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Ee=function(){return!!e})()}function Se(e){return Se=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Se(e)}function Oe(e,t){return Oe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Oe(e,t)}ve.identity="Presence";var je=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){return t=Se(t),function(e,t){if(t&&("object"==we(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Ee()?Reflect.construct(t,[],Se(e).constructor):t.apply(e,void 0))}(this,t)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Oe(e,t)}(t,e),r=t,(n=[{key:"validate",value:function(){return ie.instance(this.obj,this.attr,this.opts).validate()}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_e(n.key),n)}}(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(h);const ke=je;je.identity="Size";const Pe={Absence:S,Base:h,Confirmation:A,Exclusion:B,Format:F,Inclusion:Z,Length:ie,Numericality:de,Presence:ge,Size:ke};var Ie=function(e,t,r){var n,o,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=function(e){var t={};if(!e)return t;var r=["resource","total","count"];return Object.keys(e).forEach(function(n){-1===r.indexOf(n)&&(t[n]=e[n])}),t}(r),s="GET"===e?"".concat(t,"?").concat((n=a,o="",Object.keys(n).forEach(function(e){""!==o&&(o="".concat(o,"&")),o="".concat(o).concat(e,"=").concat(encodeURIComponent(n[e]))}),o)):t,c=document.querySelector("meta[name='csrf-token']"),u=new XMLHttpRequest;return u.withCredentials=!0===i.cookiesByCORS,u.open(e,s),u.setRequestHeader("Accept","application/json"),u.setRequestHeader("Content-Type","application/json"),c&&u.setRequestHeader("X-CSRF-Token",c.content),null!=i.authorizationHeader&&u.setRequestHeader("Authorization",i.authorizationHeader),u.send(JSON.stringify(a)),u};function Te(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Ae(e,t,r){return(t=ze(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ce(e){return Ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ce(e)}function Re(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Me(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Me(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function Me(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Ne(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ze(n.key),n)}}function ze(e){var t=function(e){if("object"!=Ce(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Ce(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ce(t)?t:t+""}var xe=function(){return e=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this.errors=null,this.resource=t.resource,null!=this.constructor.attributes&&this.__initAttributes(),null!=t&&this.__assignAttributes(t)},t=[{key:"setResource",value:function(e){this.resource=e}},{key:"getIdentity",value:function(){return this.constructor.getIdentity()}},{key:"getAttrRemoteName",value:function(e){return null==this.constructor.attributes||null==this.constructor.attributes[e]?null:this.constructor.attributes[e].remoteName||e}},{key:"getAttrName",value:function(e){if(null==this.constructor.attributes)return e;if(null!=this.constructor.attributes[e])return e;for(var t in this.constructor.attributes)if(this.constructor.attributes[t].remoteName===e)return t;return e}},{key:"getAttrType",value:function(e){return null==this.constructor.attributes||null==this.constructor.attributes[e]?null:this.constructor.attributes[e].type}},{key:"assignAttr",value:function(e,t){var r=this.getAttrType(e);if(null!=t){switch(r){case"Date":t=new Date(Date.parse(t));break;case"Integer":case"Int":t=parseInt(t,10);break;case"Float":t=parseFloat(t);break;case"Boolean":case"Bool":t="boolean"==typeof t?t:Boolean(parseInt(t,10));break;case"Number":t=Number(t);break;case"String":t=String(t)}this[e]=t}else this[e]=null}},{key:"attributes",value:function(){var e={id:this.id};if(null==this.constructor.attributes)return e;for(var t in this.constructor.attributes)e[t]=this[t];return e}},{key:"isValid",value:function(){if(null==this.constructor.attributes)return!0;for(var e in this.errors=null,this.constructor.attributes){var t=this.constructor.attributes[e];if(null!=t&&null!=t.validations)for(var r in t.validations){var n=t.validations[r];if((null==this.id||"create"!==n.on)&&(null!=this.id||"update"!==n.on)&&(null==n.if||n.if(this))){var o=r.charAt(0).toUpperCase()+r.slice(1);if(null!=Pe[o]){var i=this.__processedValidationSettings(n);Pe[o].instance(this,e,i).validate()}else console.warn('"'.concat(o,'" validator is not implemented!'))}}}if(null!=this.constructor.validate){var a,s=Re(this.constructor.validate);try{for(s.s();!(a=s.n()).done;){var c=a.value;"function"==typeof this[c]&&this[c]()}}catch(e){s.e(e)}finally{s.f()}}return null==this.errors}},{key:"isInvalid",value:function(){return!this.isValid()}},{key:"isEmpty",value:function(){var e=this.attributes();for(var t in e)if(null!==this[t])return!1;return!0}},{key:"addErrorMessage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};null==this.errors&&(this.errors={});var r=t.for;null==this.errors[r]&&(this.errors[r]=[]),this.errors[r].push(e)}},{key:"save",value:function(){var e=this,t=null!=this.id?"PUT":"POST",r=Ie(t,this.__getResourceUrl(),this.serialize(),this.constructor.__requestOpts());return new Promise(function(t,n){r.onerror=function(e){return n(e)},r.onload=function(r){var n=JSON.parse(r.target.response);n.success||null!=n.errors&&e.__assignRemoteErrorMessages(n.errors),t(n)}})}},{key:"updateAttribute",value:function(e){var t=this,r=Ie("PUT",this.__getResourceUrl(),this.serialize(e),this.constructor.__requestOpts());return new Promise(function(e,n){r.onerror=function(e){return n(e)},r.onload=function(r){if(r.target.status>=200&&r.target.status<400){var o=JSON.parse(r.target.response);if(o.success)return void e(o);null!=o.errors&&t.__assignRemoteErrorMessages(o.errors),e(o)}else r.target.status>=500&&n(r)}})}},{key:"serialize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(null==this.constructor.attributes)return{};var t={},r=this.constructor.getRemoteName().toLowerCase();t[r]={};var n={};for(var o in null!=e?n[e]=null:n=this.constructor.attributes,n){var i=this.getAttrRemoteName(o);t[r][i]=this[o]}return t}},{key:"reload",value:function(){var e,t={id:this.id,resource:this.resource},r=Re(this.constructor.getResourcesUrlParams({resource:this.resource}));try{for(r.s();!(e=r.n()).done;){var n=e.value;t[n]=this[n]}}catch(e){r.e(e)}finally{r.f()}return this.constructor.find(t)}},{key:"changes",value:function(){var e={},t=f.find(this.getIdentity(),this.id),r=this.attributes();for(var n in r){var o=r[n];if(o!==t[n]){if(null!=o&&o.constructor===Date&&t[n]-o===0)continue;o!==t[n]&&(e[n]={is:t[n],was:o})}}return e}},{key:"applyChanges",value:function(){var e=this.changes();for(var t in e)this[t]=e[t].is}},{key:"toKey",value:function(){return"".concat(this.getIdentity().toLowerCase(),"_").concat(this.id)}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.__send("GET",e,t)}},{key:"post",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.__send("POST",e,t)}},{key:"put",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.__send("PUT",e,t)}},{key:"patch",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.__send("PATCH",e,t)}},{key:"delete",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.__send("DELETE",e,t)}},{key:"__send",value:function(e,t,r){var n=this.__getResourceUrl();null!=t&&(n="".concat(n,"/").concat(t));var o=Ie(e,n,r,this.constructor.__requestOpts());return new Promise(function(e,t){o.onerror=function(e){return t(e)},o.onload=function(r){if(r.target.status>=200&&r.target.status<400){var n=JSON.parse(r.target.response);e(n)}else r.target.status>=500&&t(r)}})}},{key:"__assignAttributes",value:function(e){for(var t in e){var r=e[t],n=this.getAttrName(t);this.assignAttr(n,r)}}},{key:"__initAttributes",value:function(){for(var e in this.constructor.attributes)this[e]=null}},{key:"__assignRemoteErrorMessages",value:function(e){for(var t in e){var r,n=e[t],o=this.getAttrName(t),i=Re(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.addErrorMessage(a,{for:o})}}catch(e){i.e(e)}finally{i.f()}}}},{key:"__getResourceUrl",value:function(){var e=this.constructor.__getResourcesUrl({resource:this.resource,obj:this});return null==this.id?e:"".concat(e,"/").concat(this.id)}},{key:"__processedValidationSettings",value:function(e){var t={};for(var r in e){var n=e[r];t[r]="function"==typeof n?n(this):n}return t}}],r=[{key:"getIdentity",value:function(){if(null!=this.identity)return this.identity;throw new Error("Specify Model's identity!")}},{key:"getRemoteName",value:function(){return null!=this.remoteName?this.remoteName:this.getIdentity()}},{key:"all",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.get("all",e)}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.__send("GET",e,t)}},{key:"post",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.__send("POST",e,t)}},{key:"put",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.__send("PUT",e,t)}},{key:"patch",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.__send("PATCH",e,t)}},{key:"delete",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.__send("DELETE",e,t)}},{key:"find",value:function(e){var t,r=this,n={};"object"===Ce(e)?(n=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Te(Object(r),!0).forEach(function(t){Ae(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Te(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},e),t=e.id,delete n.id):t=e;var o="".concat(this.__getResourcesUrl(n),"/").concat(t),i=Ie("GET",o,n,this.__requestOpts());return new Promise(function(t,n){i.onerror=function(e){return n(e)},i.onload=function(n){if(404!==n.target.status){var o=JSON.parse(n.target.response);t(r.__initFromJSON(o,e.resource))}else t(null)}})}},{key:"getAttribRemoteName",value:function(e){return null==this.attributes||null==this.attributes[e]?null:null==this.attributes[e].remoteName?e:this.attributes[e].remoteName}},{key:"getResourcesUrlParams",value:function(e){for(var t,r=this.__getResourcesUrl({resource:e.resource}),n=/:(\w+)\/?/,o=[];t=n.exec(r);)o.push(t[1]),r=r.replace(t[0],t[1]);return o}},{key:"__getResourcesUrl",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e=null==this.resources?"/".concat(this.getRemoteName().toLowerCase(),"s"):t.resource?this.resources[t.resource].url:null!=o.scope&&null!=this.resources&&null!=this.resources[o.scope]?this.resources[o.scope].url:this.resources.url,null!=this.protocolWithHost?e="".concat(this.protocolWithHost).concat(e):null!=o.protocolWithHost&&(e="".concat(o.protocolWithHost).concat(e));var r=/:([a-zA-Z]+)\/?/.exec(e);return null==r||(null!=t[r[1]]?(e=e.replace(":".concat(r[1]),t[r[1]]),delete t[r[1]]):null!=t.obj&&null!=t.obj[r[1]]&&(e=e.replace(":".concat(r[1]),t.obj[r[1]]))),e}},{key:"__requestOpts",value:function(){return{authorizationHeader:o.authorizationHeader||this.authorizationHeader,cookiesByCORS:null!=this.cookiesByCORS?this.cookiesByCORS:o.cookiesByCORS}}},{key:"__page",value:function(e,t,r){var n=this,o=t.url;t.params[t.pageParam]=e;var i=Ie(t.method,o,t.params,this.__requestOpts());return new Promise(function(e,o){i.onerror=function(e){return o(e)},i.onload=function(o){var i=JSON.parse(o.target.response);if(Array.isArray(i)){var a,s=Re(i);try{for(s.s();!(a=s.n()).done;){var c=a.value,u=n.__initFromJSON(c,t.resource);r.push(u)}}catch(e){s.e(e)}finally{s.f()}}else if(null!=i.resources){r.constructor===Array&&(r={resources:[],count:0});var l,f=Re(i.resources);try{for(f.s();!(l=f.n()).done;){var d=l.value,m=n.__initFromJSON(d,t.resource);r.resources.push(m)}}catch(e){f.e(e)}finally{f.f()}r.count=i.count}else for(var p in i)Object.prototype.hasOwnProperty.call(i,p)&&(r[p]=i[p]);e(r)}})}},{key:"__paginate",value:function(e){var t=this,r={method:e.method,url:e.url,params:e.params,pageParam:e.pageParam,resource:e.resource};return this.__page(e.pageNum||1,r,[]).then(function(n){var o=n.count||e.total,i=Promise.resolve(n);if(null!=e.pageNum)return i;if(o<=e.perPage)return i;var a=parseInt(o/e.perPage,10);if(a!==o/e.perPage&&(a+=1),1===a)return i;for(var s=2;s<=a;s+=1)(function(e){i=i.then(function(){return t.__page(e,r,n)})})(s);return i})}},{key:"__getPaginationParam",value:function(e){var t="page";return null!=e&&null!=this.resources&&this.resources[e]?this.resources[e].paginate&&this.resources[e].paginate.param||t:null!=o.scope&&null!=this.resources&&null!=this.resources[o.scope]?this.resources[o.scope]&&this.resources[o.scope].paginate&&this.resources[o.scope].paginate.param||t:null!=this.resources&&null!=this.resources.paginate&&null!=this.resources.paginate.param?this.resources.paginate.param:t}},{key:"__getPaginationPer",value:function(e){return null!=e&&null!=this.resources&&this.resources[e]?this.resources[e].paginate&&this.resources[e].paginate.per:null!=o.scope&&null!=this.resources&&null!=this.resources[o.scope]?this.resources[o.scope]&&this.resources[o.scope].paginate&&this.resources[o.scope].paginate.per:null!=this.resources&&null!=this.resources.paginate&&null!=this.resources.paginate.per?this.resources.paginate.per:null}},{key:"__send",value:function(e,t,r){var n=this.__getResourcesUrl(r);"all"!==t&&(n="".concat(n,"/").concat(t));var o={method:e,url:n,params:r,resource:r.resource,perPage:this.__getPaginationPer(r.resource),pageNum:r.page,pageParam:this.__getPaginationParam(r.resource),total:r.total||r.count};return this.__paginate(o)}},{key:"__initFromJSON",value:function(e,t){var r=new this(e);return r.resource=t,f.add(r),r}}],t&&Ne(e.prototype,t),r&&Ne(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}();const Be=xe;function qe(e){return qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qe(e)}function De(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function $e(e,t,r){return(t=function(e){var t=function(e){if("object"!=qe(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=qe(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==qe(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Be.prototype.clone=function(){return new this.constructor(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?De(Object(r),!0).forEach(function(t){$e(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):De(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},this.attributes()))};const Le={Base:Be};var He={IdentityMap:f,Models:Le};return t})(),e.exports=t()},728:function(e,t,r){"use strict";r(559),document.addEventListener("turbo:before-render",e=>{const{namespace:t,controller:r,action:n}=e.detail.newBody.dataset;document.body.dataset.namespace=t,document.body.dataset.controller=r,document.body.dataset.action=n});var n=r(742),o=r(278),i=class{setScope(e){o.Config.scope=e}},a=r(540),s=r(338);const c="ADD_ARTICLES",u="PREPEND_ARTICLES",l="REMOVE_ARTICLE",f="SET_ARTICLES",d="UPDATE_ARTICLE",m="ADD_COMMENTS",p="REMOVE_COMMENT",y="SET_COMMENTS",h="UPDATE_COMMENT",b="PREPEND_USERS";function v(e){return{type:c,articles:e}}function g(e){return{type:f,articles:e}}function w(e,t){return{type:d,article:e,index:t}}function _(e,t){return{type:y,comments:e,articleId:t}}function E(e,t,r){return{type:h,comment:e,articleId:t,index:r}}var S=r(644),O=r(932),j=(0,O.jM)((e=[],t)=>{switch(t.type){case c:{const r=t.articles.filter(t=>!e.some(e=>e.id===t.id));return void e.push(...r)}case u:return t.articles.concat(e);case l:return e.filter(e=>e.id!==t.id);case f:return t.articles;case d:e[t.index]=t.article;break;default:return e}}),k=(0,O.jM)((e={},t)=>{switch(t.type){case m:void 0===e[t.articleId]&&(e[t.articleId]=[]),e[t.articleId]=e[t.articleId].concat(t.comments);break;case p:if(null==e[t.articleId])return e;e[t.articleId]=e[t.articleId].filter(e=>e.id!==t.id);break;case y:e[t.articleId]=t.comments;break;case h:{const r=t.articleId;let n=t.index;if(!n){const o=e[r].find(e=>e.id===t.comment.id);n=e[r].indexOf(o)}e[r][n]=t.comment;break}default:return e}}),P=(0,O.jM)((e=[],t)=>{switch(t.type){case"SET_USERS":return t.users;case b:return t.users.concat(e);default:return e}}),I=(0,S.HY)({articles:j,comments:k,users:P}),T=(0,S.Yl)(I);class A extends o.Models.Base{static identity="Article";static resources={url:"/user/articles",paginate:{per:5},main:{url:"/articles",paginate:{per:3}},admin:{url:"/admin/articles",paginate:{per:4}}};static attributes={title:{validations:{presence:!0,length:{within:[3,255]}}},content:{validations:{presence:!0,length:{minimum:100}},remoteName:"text"},createdAt:{type:"Date",remoteName:"created_at"},updatedAt:{type:"Date",remoteName:"updated_at"},commentsCount:{type:"Int",remoteName:"comments_count"},publishedAt:{type:"Date",remoteName:"published_at"},published:{},adminReview:{remoteName:"admin_review"},adminRate:{type:"Int",remoteName:"admin_rate"},categoryId:{type:"Int",remoteName:"category_id"},adminReviewStartedAt:{remoteName:"admin_review_started_at"}};static validate=["vulgarityLevel"];constructor(e){super(e),this.published=null!=this.publishedAt}vulgarityLevel(){(null!=this.title&&/fuck/i.exec(this.title)||null!=this.content&&/fuck/i.exec(this.content))&&this.addErrorMessage("Article contains strong language.",{for:"base"})}setDefaultValuesForAdminReview(){this.adminRate=null==this.adminRate?3:this.adminRate,this.categoryId=null==this.categoryId?6:this.categoryId,this.adminReviewStartedAt=Date.now()}}var C=A;class R extends o.Models.Base{static identity="Article.Comment";static remoteName="Comment";static resources={url:"/user/articles/:articleId/comments",paginate:{per:10},main:{url:"/articles/:articleId/comments",paginate:{per:5,param:"page-num"}},admin:{url:"/admin/articles/:articleId/comments",paginate:{per:5}}};static attributes={author:{validations:{presence:!0}},text:{validations:{presence:!0,vulgarity:!0}},articleId:{type:"Int",validations:{presence:!0},remoteName:"article_id"},createdAt:{type:"Date",remoteName:"created_at"},updatedAt:{type:"Date",remoteName:"updated_at"},emotion:{type:"Int"},pinned:{type:"Boolean"},adminRate:{type:"Int",remoteName:"admin_rate"},approved:{type:"Boolean"}};constructor(e){super(e)}}var M=R,N=r(874),z=r(556),x=r.n(z),B=class{constructor(e,t=o.Config.locale){this.date=e,this.skope=o.I18n[t].date}toString(e="default"){const t=this.skope.formats;switch(e){case"default":return this.strftime(t.default);case"short":return this.strftime(t.short);case"long":return this.strftime(t.long);default:console.log("Services.Date#toString: unknown format.")}}strftime(e){e=(e=e.replace("%Y",this.date.getFullYear())).replace("%y",this.date.getFullYear().toString().substr(-2,2));let t=this.date.getMonth()+1;return t=t>=10?t:`0${t}`,(e=(e=(e=(e=(e=(e=e.replace("%m",t)).replace("%b",this.skope.abbr_month_names[this.date.getMonth()])).replace("%B",this.skope.month_names[this.date.getMonth()])).replace("%d",this.date.getDate()>=10?this.date.getDate():`0${this.date.getDate()}`)).replace("%H",this.date.getHours()>=10?this.date.getHours():`0${this.date.getHours()}`)).replace("%M",this.date.getMinutes()>=10?this.date.getMinutes():`0${this.date.getMinutes()}`)).replace("%S",this.date.getSeconds()>=10?this.date.getSeconds():`0${this.date.getSeconds()}`)}};function q({comment:e}){const t=new B(e.createdAt).strftime("%d %b %y");return a.createElement("p",{id:`comment_${e.id}`},a.createElement("b",null,e.author)," on ",a.createElement("i",null,t)," (",a.createElement("a",{href:`/admin/articles/${e.articleId}/comments/${e.id}/edit`},"edit"),")",a.createElement("br",null),e.text)}q.propTypes={comment:x().instanceOf(M).isRequired};var D=q;function $({comments:e}){return 0===e.length?a.createElement("p",null,"No comments"):a.createElement(a.Fragment,null,e.map(e=>a.createElement(D,{comment:e,key:e.id})))}$.propTypes={comments:x().arrayOf(x().instanceOf(M)).isRequired};var L=$;const H=e=>{document.getElementById("article_author").textContent=e.author,document.getElementById("article_title").textContent=e.title,document.getElementById("article_text").textContent=e.content},U=e=>async function(t){if("updated"===t){const t=await e.reload();H(t)}};var F=r(228);function W({article:e}){const t=new B(e.publishedAt).toString("short");return a.createElement("article",{id:`article_${e.id}`},a.createElement("h2",null,e.title),a.createElement("p",null,a.createElement("i",null,e.author," wrote this on ",t," /"," ",a.createElement("span",{className:"comments_quantity"},e.commentsCount," comment",1===e.commentsCount?"":"s"))),a.createElement("p",null,e.content),a.createElement("p",null,a.createElement("a",{href:`/admin/articles/${e.id}/edit`},"Review")))}W.propTypes={article:x().instanceOf(C).isRequired};var V=W;function J(e){const[t,r]=(0,a.useState)(e.articles);(0,a.useEffect)(()=>{const e=T.subscribe(()=>r(T.getState().articles));return()=>{e()}},[]);const n=t.map(e=>a.createElement(V,{key:e.id,article:e}));return a.createElement(a.Fragment,null,n)}J.propTypes={articles:x().arrayOf(x().instanceOf(C)).isRequired};var G=J;const Y=async()=>{const e=await C.find(n.helpers.params.id);(e=>{(0,N.subscribe)({to:e,with:U(e)}),H(e)})(e),(e=>{e.setDefaultValuesForAdminReview(),new F.UI.Form({id:"edit_article_form",for:e}).render()})(e)};const X=()=>window.location.href="/admin";class Z extends o.Models.Base{static identity="User";static resources={url:"/users",admin:{url:"/admin/users"}};static paginate={per:10};static attributes={email:{validations:{presence:!0,format:{with:/^([^@\s]+)@((?:[-a-z0-9]+\.)+[a-z]{2,})$/i}}},username:{validations:{presence:!0,format:{with:/^[a-z][a-z0-9_-]*$/i}}},password:{validations:{presence:{on:"create"},confirmation:!0}},passwordConfirmation:{remoteName:"password_confirmation"},confirmed:{},createdAt:{type:"Date",remoteName:"created_at"},updatedAt:{type:"Date",remoteName:"updated_at"}};constructor(e){super(e)}}var K=Z,Q=r(997);const ee=e=>function(t,r,n={}){let o=t[e];if(n.parentId&&(o=o[n.parentId]),void 0===o)return[null,null];const i=o.find(e=>e.id===r);return i?[i,o.indexOf(i)]:[null,null]},te=ee("articles"),re=ee("comments"),ne=(e,t)=>e.comments[t];function oe({comment:e}){const t=new B(e.createdAt).strftime("%d %b %y");return a.createElement("p",{id:`comment_${e.id}`},a.createElement("b",null,e.author)," on ",a.createElement("i",null,t)," wrote:",a.createElement("br",null),e.text)}oe.propTypes={comment:x().instanceOf(M).isRequired};var ie=oe;function ae(e){const t=e.articleId,[r,n]=(0,a.useState)(e.comments);(0,a.useEffect)(()=>{const e=T.subscribe(()=>{n(ne(T.getState(),t))});return()=>{e()}},[]);const o=r.map(e=>a.createElement(ie,{key:e.id,comment:e}));return 0===r.length?a.createElement("p",{id:"no_comments"},"No comments."):a.createElement(a.Fragment,null,o)}ae.propTypes={articleId:x().number.isRequired,comments:x().arrayOf(x().instanceOf(M)).isRequired};var se=ae;function ce(e){const[t,r]=(0,a.useState)(e.comments);return(0,a.useEffect)(()=>{const t=T.subscribe(()=>{r(ne(T.getState(),e.articleId))});return()=>{t()}},[]),a.createElement(a.Fragment,null,`${t.length} comment${1===t.length?"":"s"}`)}ce.propTypes={articleId:x().number.isRequired,comments:x().arrayOf(x().instanceOf(M)).isRequired};var ue=ce;const le=(e,t,r)=>{null!=e[t]&&(r.classList.add(t),document.querySelector(".flash p").textContent=e[t])};var fe=(e={})=>{const{hide:t}=e,r=document.querySelector(".flash");(e=>{e.classList.remove("notice"),e.classList.remove("alert"),e.classList.remove("warning")})(r),le(e,"notice",r),le(e,"alert",r),le(e,"warning",r),r.classList.remove("none"),t&&((e=4e3)=>{setTimeout(()=>{document.querySelector(".flash").classList.add("none")},e)})()};const de=e=>async function(t){switch(t){case"updating":fe({warning:"Author is currently editing article. Be aware of possible changes."});break;case"updated":{const t=await e.reload();me(t,!0)}}},me=(e,t=!1)=>{!1===t&&(0,N.subscribe)({to:e,with:de(e)}),document.getElementById("title").textContent=e.title,document.getElementById("author").textContent=e.author;const r=new B(e.publishedAt);document.getElementById("pub_date").textContent=r.toString("short");const n=document.getElementById("text");n.innerHTML="";const o=((i=(i=(i=e.content).replace(/\r\n?/,"\n")).trim()).length>0&&(i="<p>"+(i=(i=i.replace(/\n\n+/g,"</p><p>")).replace(/\n/g,"<br>"))+"</p>"),i);var i;n.insertAdjacentHTML("beforeend",o)};var pe={renderArticle:me,renderForm:e=>{new F.UI.Form({for:e,initObj:!0,id:"new_comment"}).render()}};function ye(){const[e,t]=(0,a.useState)(1),[r,n]=(0,a.useState)(!1);return r?a.createElement("span",null,"No more posts."):a.createElement("a",{href:"#",id:"load_more",onClick:async function(r){r.preventDefault();const o=e+1;t(o);let i=null;try{i=await C.get("all",{page:o})}catch(r){return void alert(`Invalid URL: ${r}`)}i.resources.length>0?T.dispatch(v(i.resources)):n(!0)}},"Load more")}function he({article:e}){const t=new B(e.publishedAt).toString("short");return a.createElement("article",{id:`article_${e.id}`},a.createElement("h2",null,e.title),a.createElement("p",null,a.createElement("i",null,e.author," wrote this on ",t," /"," ",a.createElement("a",{href:`/articles/${e.id}#comments`,className:"comments_quantity"},e.commentsCount," comment",1===e.commentsCount?"":"s"))),a.createElement("p",null,e.content),a.createElement("p",null,a.createElement("a",{href:`/articles/${e.id}`},"Continued")))}he.propTypes={article:x().instanceOf(C).isRequired};var be=he;function ve(e){const[t,r]=(0,a.useState)(e.articles);(0,a.useEffect)(()=>{const e=T.subscribe(()=>r(T.getState().articles));return()=>{e()}},[]);const n=t.map(e=>a.createElement(be,{key:e.id,article:e}));return a.createElement(a.Fragment,null,n)}ve.propTypes={articles:x().arrayOf(x().instanceOf(C)).isRequired};var ge=ve;const we=e=>{switch(e){case"confirming":document.getElementById("verification_info").textContent=document.getElementById("verification_progress").textContent;break;case"confirmed":window.location.href="/user/sessions/new?event=confirmed"}},_e=e=>{nt.getWire().token=e.access_token,(0,N.subscribe)({to:new K({id:e.id}),with:we}),document.querySelector("form").style.display="none",document.getElementById("sign_in_paragraph").classList.remove("none"),document.getElementById("verification_info").classList.remove("none"),fe({notice:e.notice})};class Ee extends i{initialize(){this.setScope("main")}}Ee.Articles=class{async show(){const e=new M({articleId:n.helpers.params.id});pe.renderForm(e),(async()=>{const e=await C.find(n.helpers.params.id);T.dispatch(g([e])),pe.renderArticle(e)})(),(async()=>{const e=await M.get("count",{articleId:n.helpers.params.id}),t=await M.all({articleId:n.helpers.params.id,total:e.total});T.dispatch(_(t,n.helpers.params.id)),(0,s.createRoot)(document.getElementById("comments")).render(a.createElement(se,{articleId:n.helpers.params.id,comments:t})),(0,s.createRoot)(document.getElementById("comments_count")).render(a.createElement(ue,{articleId:n.helpers.params.id,comments:t}))})()}},Ee.Pages=class{async index(){(0,s.createRoot)(document.getElementById("load_more_wrapper")).render(a.createElement(ye,null));const e=await C.get("all",{page:1});T.dispatch(g(e.resources)),(0,s.createRoot)(document.getElementById("articles")).render(a.createElement(ge,{articles:e.resources}))}},Ee.Users=class{new(){new F.UI.Form({for:new K,callbackSuccess:_e}).render()}};var Se=Ee;class Oe extends o.Models.Base{static identity="Room.Member";static resources={url:"/user/rooms/:roomId/members",paginate:{per:100}};constructor(e){super(e)}}var je=Oe;class ke extends o.Models.Base{static identity="Room";constructor(e){super(e)}}var Pe=ke;let Ie=[];const Te=({id:e,name:t,members_count:r,joined:n})=>`\n  <tr id="room_${e}">\n    <td>${t}</td>\n    <td class="members">${r}</td>\n    <td>\n      <a\n        rel="nofollow"\n        data-turbo-method="patch"\n        href="${n?`/user/rooms/${e}/leave`:`/user/rooms/${e}/join`}"\n      >\n        ${n?"Leave":"Join"}\n      </a>\n      |\n      <a\n        rel="nofollow"\n        data-turbo-method="delete"\n        data-turbo-confirm="R U sure?"\n        href="/user/rooms/${e}"\n      >\n        Destroy\n      </a>\n    </td>\n  </tr>\n  `,Ae=e=>{document.querySelector("#rooms_list tbody").insertAdjacentHTML("beforeend",Te(e))},Ce=(e,t,r)=>{const n=Ie.find(t=>t.id===e);n.members_count+=t,r===(()=>{const e=document.getElementById("current-user-data");return JSON.parse(e.textContent)})().id&&(n.joined=t>0),(e=>{const t=Ie.find(t=>t.id===e);document.getElementById(`room_${e}`).innerHTML=Te(t)})(e)},Re=(e,t)=>{switch(e){case"Room member_joined":Ce(t.room_id,1,t.member.id);break;case"Room member_left":Ce(t.room_id,-1,t.member.id);break;case"Room created":t.room.members_count=0,Ie.push(t.room),Ae(t.room);break;case"Room destroyed":{const e=document.getElementById(`room_${t.room_id}`);e.parentNode.removeChild(e)}}};const Me=e=>{if(document.querySelector(`#members li#user_${e.id}`))return;const t=`<li id='user_${e.id}'>${e.username}</li>`;document.getElementById("members").insertAdjacentHTML("beforeend",t)},Ne=e=>function(t,r){switch(t){case"Room member_joined":if(r.room_id!==e)return;Me(r.member);break;case"Room member_left":if(r.room_id!==e)return;(e=>{const t=document.querySelector(`#members li#user_${e.id}`);t.parentNode.removeChild(t)})(r.member)}};var ze={render:e=>{(e=>{document.querySelector("[data-behavior~=room-speaker]").addEventListener("keypress",t=>{13===t.keyCode&&(t.preventDefault(),nt.emit({type:"NEW_MESSAGE",txt:t.target.value,room_id:e,message_type:document.querySelector("[name='message_type']:checked").value}),t.target.value="")})})(e);const t=(e=>{const t=setInterval(()=>{nt.emit({type:"HEARTBEAT",room_id:e}),console.log("heartbeat",e)},3e3);return()=>clearInterval(t)})(e),r=(0,N.subscribe)({to:Pe,with:Ne(e)});return()=>{t(),r()}},renderMembers:e=>{for(const t of e)Me(t)},receivedMessage:(e,t)=>{const r=`<p class="msg"><b>${t}</b>: ${e}</p>`;document.getElementById("messages").insertAdjacentHTML("beforeend",r)},disconnected:()=>{fe({alert:"You have been disconnected from the server. You might have lost some ephemeral messages.",hide:!1})}},xe=class{constructor(){this.view=null,this.unsubscribe=null}deinitialize(){null!==this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null)}index(){this.unsubscribe=function(){let e=document.getElementById("rooms-data");return Ie=JSON.parse(e.textContent),Ie.forEach(e=>Ae(e)),(0,N.subscribe)({to:Pe,with:Re})}()}async show(){this.view=ze,this.unsubscribe=ze.render(n.helpers.params.id);const e=await je.all({roomId:n.helpers.params.id});ze.renderMembers(e.resources)}};const Be=e=>{document.getElementById("article_title").textContent=e.title,document.getElementById("article_text").textContent=e.content;const t=document.getElementById("publish_article");t&&null!=e.publishedAt?t.style.display="none":t&&(t.style.display="")},qe=e=>async function(t){switch(t){case"updated":await e.reload(),e.applyChanges(),Be(e);break;case"destroyed":window.location.href="/user/articles?message=deleted"}};function De({comment:e,isAdmin:t=!1}){const[r,n]=(0,a.useState)(!1),o=new B(e.createdAt).strftime("%d %b %y"),i=async t=>{t.preventDefault(),n(!0),e.approved=!0,(await e.updateAttribute("approved")).ok&&T.dispatch(E(new M({...e,approved:!0}),e.articleId))};return a.createElement("p",{id:`comment_${e.id}`},a.createElement("b",null,e.author)," on ",a.createElement("i",null,o),t?(()=>{let t;return t=e.approved?a.createElement(a.Fragment,null,a.createElement("span",null,"approved")," |"," "):r?a.createElement(a.Fragment,null,a.createElement("span",null,"approving...")," |"," "):a.createElement(a.Fragment,null,a.createElement("a",{href:`/user/articles/${e.articleId}/comments/${e.id}/approve`,className:"approve",onClick:i},"approve")," ","|"," "),a.createElement(a.Fragment,null," ","(",t,a.createElement("a",{href:`/user/articles/${e.articleId}/comments/${e.id}/edit`},"edit")," ","|"," ",a.createElement("a",{href:`/user/articles/${e.articleId}/comments/${e.id}`,"data-method":"delete","data-confirm":"Are you sure?"},"delete"),")")})():"",a.createElement("br",null),e.text)}De.propTypes={comment:x().instanceOf(M).isRequired,isAdmin:x().bool};var $e=De;function Le(e){const t=e.articleId,r=e.isAdmin||!1,[n,o]=(0,a.useState)(e.comments);if((0,a.useEffect)(()=>{const e=T.subscribe(()=>o(ne(T.getState(),t)));return()=>{e()}},[]),0===n.length)return a.createElement("p",null,"No comments.");const i=n.map(e=>a.createElement($e,{key:e.id,comment:e,isAdmin:r}));return a.createElement(a.Fragment,null,i)}Le.propTypes={articleId:x().number.isRequired,isAdmin:x().bool,comments:x().arrayOf(x().instanceOf(M)).isRequired};var He=Le;const Ue=e=>async function(t,r){switch(t){case"updating":document.querySelector("h1").getAttribute("data-mark")!==r.mark&&fe({warning:"Uuups someone else started editing this article."});break;case"updated":await e.reload(),(e=>{for(const[t]of Object.entries(e.changes())){const r=document.querySelector(`a.apply_changes[data-for=${e.getAttrRemoteName(t)}]`);r&&r.classList.remove("none")}})(e);break;case"destroyed":window.location.href="/user/articles?message=deleted"}};var Fe=e=>{T.dispatch(v([e]));const t=(0,N.subscribe)({to:e,with:Ue(e)}),r=new F.UI.Form({for:e});return r.render(),(e=>{for(const t of Array.from(document.querySelectorAll("a.apply_changes")))t.addEventListener("click",t=>{t.preventDefault();const r=e.getObj(),n=r.getAttrName(t.target.getAttribute("data-for"));r[n]=r.changes()[n].is,e.fill(n),t.target.classList.add("none")})})(r),t};function We({article:e,onArticleDestroyed:t}){return a.createElement("tr",{id:`article_${e.id}`},a.createElement("td",{className:"title"},e.title),a.createElement("td",null,e.content),a.createElement("td",{className:"comments_quantity"},e.commentsCount),a.createElement("td",{className:"published"},e.publishedAt?"yes":"no"),a.createElement("td",null,a.createElement("a",{href:`/user/articles/${e.id}`},"Show")," |",a.createElement("a",{href:`/user/articles/${e.id}/edit`},"Edit")," |",a.createElement("a",{href:`/user/articles/${e.id}`,className:"delete_article",onClick:async r=>{if(r.preventDefault(),!confirm("Are you sure?"))return;const n=await e.delete(null);var o;n.success&&T.dispatch((o=n.id,{type:l,id:o})),t(n)}},"Delete")))}We.propTypes={article:x().instanceOf(C).isRequired,onArticleDestroyed:x().func.isRequired};var Ve=We;function Je(e){const[t,r]=(0,a.useState)(e.articles);(0,a.useEffect)(()=>{const e=T.subscribe(()=>r(T.getState().articles));return()=>{e()}},[]);const n=t.map(t=>a.createElement(Ve,{key:t.id,article:t,onArticleDestroyed:e.onArticleDestroyed}));return a.createElement(a.Fragment,null,n)}Je.propTypes={articles:x().arrayOf(x().instanceOf(C)).isRequired,onArticleDestroyed:x().func.isRequired};var Ge=Je;const Ye=e=>{e.success?fe({notice:e.notice}):fe({alert:e.alert})};class Xe extends i{initialize(){this.setScope(null)}}Xe.Articles=class{initialize(){this.unsubscribe=null}deinitialize(){null!==this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null)}async index(){"deleted"===n.helpers.params.message&&fe({alert:"Article has been deleted."});const e=await C.get("all");T.dispatch(g(e.resources)),(0,s.createRoot)(document.getElementById("article_list")).render(a.createElement(Ge,{articles:e.resources,onArticleDestroyed:Ye}))}show(){(async()=>{const e=await C.find(n.helpers.params.id);T.dispatch(g([e])),(e=>{null!==e&&((0,N.subscribe)({to:e,with:qe(e)}),(e=>{document.getElementById("publish_article").addEventListener("click",async t=>{t.preventDefault(),t.target.textContent="Publishing...";try{await e.put("publish"),document.getElementById("publish_article").outerHTML="<span>Published!</span>"}catch{document.getElementById("publish_article").textContent="Publish",fe({alert:"Connection error!"})}})})(e),(e=>{const t=document.getElementById("edit_link").getAttribute("href");document.getElementById("edit_link").setAttribute("href",t.replace("/0/",`/${e}/`))})(e.id),Be(e))})(e)})(),(async()=>{const e=await M.all({articleId:n.helpers.params.id});T.dispatch(_(e.resources,n.helpers.params.id)),(0,s.createRoot)(document.getElementById("comments")).render(a.createElement(He,{articleId:n.helpers.params.id,comments:e.resources}))})()}new(){this.unsubscribe=Fe(new C)}async edit(){(async e=>{const t=await M.all({articleId:e});T.dispatch(_(t.resources,e)),(0,s.createRoot)(document.getElementById("comments")).render(a.createElement(He,{articleId:e,comments:t.resources,isAdmin:!0}))})(n.helpers.params.id);const e=await C.find(n.helpers.params.id);this.unsubscribe=Fe(e)}},Xe.Rooms=xe;var Ze=Xe;const Ke=()=>dt().namespaceController.constructor===Ze,Qe=()=>dt().namespaceController.constructor===ut,et=()=>Ke()&&null!==dt().controller&&dt().controller.constructor===xe&&"show"===dt().action,tt=({article_id:e},t)=>{const[r,n]=te(T.getState(),e);if(!r)return;const o=new C({...r,commentsCount:r.commentsCount+t});T.dispatch(w(o,n))};(0,N.connectWithModel)(o.connector),C.Comment=M,Pe.Member=je;const rt=(0,N.init)({cable:(0,Q.Be)(),models:{Article:C,Room:Pe,User:K},notificationCenter:async e=>{switch(void 0!==e.loco&&"disconnected"===e.loco&&et()&&dt().controller.view.disconnected(),e.type){case"PING":Ke()&&alert("Ping!");break;case"NEW_MESSAGE":(et()?dt().controller.view.receivedMessage:()=>{})(e.message,e.author);break;case"Article created":(async({id:e})=>{if(!Ke())return;const t=await C.find({id:e,abbr:!0});T.dispatch(v([t]))})(e.payload);break;case"Article published":(async({id:e})=>{if(Qe()){const t=await C.find({id:e,abbr:!0,resource:"admin"});T.dispatch(function(e){return{type:u,articles:e}}([t]))}else{const t=await C.find({id:e,abbr:!0});T.dispatch(v([t]))}})(e.payload);break;case"Article updated":(async({id:e})=>{const t={id:e,abbr:!0};Qe()&&(t.resource="admin");let[r,n]=te(T.getState(),e);r&&(r=await C.find(t),T.dispatch(w(r,n)))})(e.payload);break;case"Article.Comment created":(async({article_id:e,id:t})=>{const r={articleId:e,id:t};dt().namespaceController.constructor===Se&&(r.resource="main");const[n]=te(T.getState(),e);if(!n)return;const o=await M.find(r);null!==o&&(T.dispatch(function(e,t){return{type:m,articleId:t,comments:e}}([o],e)),tt({article_id:e},1))})(e.payload);break;case"Article.Comment destroyed":tt(e.payload,-1),(({article_id:e,id:t})=>{T.dispatch(function(e,t){return{type:p,id:e,articleId:t}}(t,e))})(e.payload);break;case"Article.Comment updated":(async({article_id:e,id:t})=>{const[r,n]=re(T.getState(),t,{parentId:e});if(!r)return;const o=await r.reload();T.dispatch(E(o,e,n))})(e.payload);break;case"USER_CONFIRMED":window.location.href="/user/sessions/new?event=confirmed";break;case"User created":{const t=await K.find(e.payload.id);T.dispatch(function(e){return{type:b,users:e}}([t]));break}}},notifications:{log:!0,size:10},postInit:()=>{"test"===document.querySelector("body").getAttribute("data-rails-env")&&rt.getWire().setPollingTime(1e3)}});var nt=rt;const ot=({user:e})=>a.createElement("tr",{id:`user_${e.id}`},a.createElement("td",null,e.email),a.createElement("td",null,e.username),a.createElement("td",{className:"confirmed"},e.confirmed?"Yes":"No"),a.createElement("td",null,a.createElement("a",{href:`/admin/users/${e.id}`},"Show")," |"," ",a.createElement("a",{href:`/admin/users/${e.id}/edit`},"Edit")," |"," ",a.createElement("a",{href:`/admin/users/${e.id}`,"data-method":"delete","data-confirm":"Are you sure?"},"Delete")," ","|"," ",a.createElement("a",{href:"#",onClick:t=>((e,t)=>{e.preventDefault(),nt.emit({type:"PING",user_id:t})})(t,e.id)},"Ping")));ot.propTypes={user:x().instanceOf(K).isRequired};var it=ot;function at(e){const[t,r]=(0,a.useState)(e.users);(0,a.useEffect)(()=>{const e=T.subscribe(()=>r(T.getState().users));return()=>{e()}},[]);const n=t.map(e=>a.createElement(it,{key:`user_${e.id}`,user:e}));return a.createElement(a.Fragment,null,n)}at.propTypes={users:x().arrayOf(x().instanceOf(K)).isRequired};var st=at;class ct extends i{initialize(){this.setScope("admin")}}ct.Articles=class{async published(){const e=await C.get("published");T.dispatch(g(e.resources)),(0,s.createRoot)(document.getElementById("articles")).render(a.createElement(G,{articles:e.resources}))}async edit(){Y(),(async()=>{(e=>{(0,s.createRoot)(document.getElementById("comments")).render(a.createElement(L,{comments:e}))})((await M.all({articleId:n.helpers.params.id})).resources)})()}},ct.Comments=class{edit(){((e={})=>{const t=new F.UI.Form({for:new M({id:e.commentId,resource:"admin"}),id:`edit_comment_${e.commentId}`,initObj:!0});t.render(),window.test={commentFormObj:t.getObj()}})({commentId:n.helpers.params.id})}},ct.Sessions=class{new(){new F.UI.Form({id:"sign_in_admin",callbackSuccess:X}).render()}},ct.Users=class{async index(){const e=await K.get("all");T.dispatch(function(e){return{type:b,users:e}}(e.resources)),(0,s.createRoot)(document.querySelector("table tbody")).render(a.createElement(st,{users:e.resources}))}async show(){(e=>{document.getElementById("user_email").textContent=e.email,document.getElementById("user_username").textContent=e.username,document.getElementById("user_confirmed").textContent=e.confirmed?"Yes":"No",(e=>{const t=document.getElementById("edit_link"),r=t.getAttribute("href");t.setAttribute("href",r.replace("/0/",`/${e.id}/`))})(e)})(await K.find(n.helpers.params.id))}edit(){var e;e=new K({id:n.helpers.params.id}),new F.UI.Form({for:e,initObj:!0,id:"admin_user_form"}).render()}};var ut=ct;const lt={Admin:ut,Main:Se,User:Ze};let ft=null;document.addEventListener("turbo:load",()=>{ft=(0,n.init)(lt)}),["turbo:click","turbo:submit-start"].forEach(e=>{document.addEventListener(e,()=>{null!==ft&&null!=ft.controller.cleanup&&(ft.controller.cleanup(),ft.controller.cleanup=null)})});var dt=()=>ft;(0,F.connect)({getLocale:()=>o.Config.locale,loco:nt,I18n:o.I18n}),o.Validators.Vulgarity=class extends o.Validators.Base{static identity="Vulgarity";constructor(){super()}validate(){if(null!=this.val)switch(typeof this.val){case"string":{const e=this._getVulgarWord();if(!new RegExp(`${e}`,["i"]).exec(this.val))return;this._addErrorMessage();break}default:throw new TypeError(`Vulgarity validator is applicable only for strings and ${this.attr} isn't.`)}}_addErrorMessage(){const e=o.I18n[o.Config.locale].errors.messages.vulgarity;this.obj.addErrorMessage(e,{for:this.attr})}_getVulgarWord(){switch(o.Config.locale){case"pl":return"kurwa";case"en":return"fuck"}}},o.I18n.pl={variants:{few(e){const t=parseInt((r=String(e))[r.length-1]);var r;-1!==[2,3,4].indexOf(t)&&(2!==String(e).length||String(e)[0])}},models:{},attributes:{},ui:{form:{sending:"Wysyam...",success:"Sukces",errors:{connection:"Bd z poczeniem",invalid_data:"Nieprawidowe dane"}}},date:{formats:{default:"%d-%m-%Y",short:"%d %b",long:"%B %d, %Y"},day_names:["niedziela","poniedziaek","wtorek","roda","czwartek","pitek","sobota"],abbr_day_names:["nie","pon","wto","ro","czw","pi","sob"],month_names:["stycze","luty","marzec","kwiecie","maj","czerwiec","lipiec","sierpie","wrzesie","padziernik","listopad","grudzie"],abbr_month_names:["sty","lut","mar","kwi","maj","cze","lip","sie","wrz","pa","lis","gru"]},errors:{messages:{accepted:"musi zosta zaakceptowane",blank:"nie moe by puste",confirmation:"nie zgadza si z polem %{attribute}",empty:"nie moe by puste",equal_to:"musi by rwne %{count}",even:"musi by parzyste",exclusion:"jest zarezerwowane",greater_than:"musi by wiksze od %{count}",greater_than_or_equal_to:"musi by wiksze lub rwne %{count}",inclusion:"nie znajduje si na licie dopuszczalnych wartoci",invalid:"jest nieprawidowe",less_than:"musi by mniejsze od %{count}",less_than_or_equal_to:"musi by mniejsze lub rwne %{count}",not_a_number:"nie jest liczb",not_an_integer:"musi by liczb cakowit",odd:"musi by nieparzyste",present:"musi by puste",too_long:{few:"jest za dugie (maksymalnie %{count} znaki)",many:"jest za dugie (maksymalnie %{count} znakw)",one:"jest za dugie (maksymalnie jeden znak)",other:"jest za dugie (maksymalnie %{count} znakw)"},too_short:{few:"jest za krtkie (przynajmniej %{count} znaki)",many:"jest za krtkie (przynajmniej %{count} znakw)",one:"jest za krtkie (przynajmniej jeden znak)",other:"jest za krtkie (przynajmniej %{count} znakw)"},wrong_length:{few:"ma nieprawidow dugo (powinna wynosi %{count} znaki)",many:"ma nieprawidow dugo (powinna wynosi %{count} znakw)",one:"ma nieprawidow dugo (powinna wynosi jeden znak)",other:"ma nieprawidow dugo (powinna wynosi %{count} znakw)"},other_than:"musi by inna ni %{count}"}}},o.I18n.pl.models.User="Uytkownik",o.I18n.pl.attributes.User={password:"Haso",passwordConfirmation:"Powtrz haso"},o.I18n.en.errors.messages.vulgarity="contains strong language.",o.I18n.pl.errors.messages.vulgarity="zawiera mocny jzyk.",o.I18n.en.date={formats:{default:"%Y-%m-%d",short:"%b %d",long:"%B %d, %Y"},day_names:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],abbr_day_names:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],month_names:["January","February","March","April","May","June","July","August","September","October","November","December"],abbr_month_names:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},window.test={getLine:()=>nt.getLine(),getWire:()=>nt.getWire()}},874:function(e){var t;self,t=()=>(()=>{"use strict";var e={d:(t,r)=>{for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function n(e){var t=function(e){if("object"!=r(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==r(t)?t:t+""}e.r(t),e.d(t,{connectWithModel:()=>H,init:()=>$,subscribe:()=>L});const o=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)},t=[{key:"toURIParams",value:function(e){var t="";for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=e[r];""!==t&&(t+="&"),t+="".concat(r,"=").concat(encodeURIComponent(n))}return t}}],t&&function(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,n(o.key),o)}}(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();var i=null,a=null,s=[];const c=function(e){return!!s.includes(e)||(s.unshift(e),s.length>100&&s.pop(),!1)};function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}const f=function(e){var t,r=function(e){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,t){if(e){if("string"==typeof e)return u(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(e,t):void 0}}(e))){t&&(e=t);var r=0,n=function(){};return{s:n,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,a=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return i=e.done,e},e:function(e){a=!0,o=e},f:function(){try{i||null==t.return||t.return()}finally{if(a)throw o}}}}(function(){if(!a||"object"!==l(a))return[];for(var e=[],t=/^[A-Z]/,r=0,n=Object.keys(a);r<n.length;r++){var o=n[r];if(t.test(o)&&"Base"!==o){e.push(o);for(var i=a[o],s=0,c=Object.keys(i);s<c.length;s++){var u=c[s];t.test(u)&&e.push("".concat(o,".").concat(u))}}}return e}());try{for(r.s();!(t=r.n()).done;){var n=t.value.split(".");if(1===n.length){var o,i=a[n[0]];if((null==i||null===(o=i.getRemoteName)||void 0===o?void 0:o.call(i))===e)return i}else if(2===n.length){var s,c,f=null===(s=a[n[0]])||void 0===s?void 0:s[n[1]];if((null==f||null===(c=f.getRemoteName)||void 0===c?void 0:c.call(f))===e)return f}}}catch(e){r.e(e)}finally{r.f()}};function d(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=m(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function m(e,t){if(e){if("string"==typeof e)return p(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?p(e,t):void 0}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var y=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;null!=e&&e(null==n?t:{type:n,payload:t},r)};const h=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.log&&console.log(e);var r,n=function(e){if(Array.isArray(e))return e}(r=e)||function(e){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,n,o,i,a=[],s=!0,c=!1;try{for(o=(t=t.call(e)).next;!(s=(r=o.call(t)).done)&&(a.push(r.value),4!==a.length);s=!0);}catch(e){c=!0,n=e}finally{try{if(!s&&null!=t.return&&(i=t.return(),Object(i)!==i))return}finally{if(c)throw n}}return a}}(r)||m(r,4)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),o=n[0],a=n[1],s=n[2],u=n[3];if(c(u.loco.idempotency_key))return!1;if(delete u.loco,null==o&&null==s)return y(t.notificationCenter,u,t.emit),!0;var l=f(o);return void 0===l?(y(t.notificationCenter,u,t.emit,"".concat(o," ").concat(s)),!1):(function(e,t,r,n,o,a){var s=e.getIdentity();y(o,n,a,"".concat(s," ").concat(r)),void 0!==i.imap[s]&&(void 0!==i.imap[s][t]&&function(e,t,r,n,o){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;null===a&&(a=new n({id:e}));var s,c=d(i.findConnected(o,e));try{for(c.s();!(s=c.n()).done;)(0,s.value)(t,r)}catch(e){c.e(e)}finally{c.f()}}(t,r,n,e,s),void 0!==i.imap[s].collection&&0!==i.imap[s].collection.length&&function(e,t,r){var n,o=d(i.imap[r].collection.filter(function(e){return null!==e}));try{for(o.s();!(n=o.n()).done;)(0,n.value)("".concat(r," ").concat(e),t)}catch(e){o.e(e)}finally{o.f()}}(r,n,s))}(l,a,s,u,t.notificationCenter,t.emit),!0)};function b(e){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(e)}function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,s=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(e,t)||g(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){if(e){if("string"==typeof e)return w(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?w(e,t):void 0}}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function _(e){var t=function(e){if("object"!=b(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=b(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==b(t)?t:t+""}var E=function(){return e=function e(t,r,n){var o,i,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.pollingTime=null!==(o=t.pollingTime)&&void 0!==o?o:3e3,this.log=!!t.log,this.ssl=t.ssl,this.location=null!==(i=t.location)&&void 0!==i?i:"notification-center",this.size=null!==(a=t.size)&&void 0!==a?a:100,this.protocolWithHost=t.protocolWithHost,this.notificationCenter=r,this.reqOpts=n,this.syncTime=null,this.token=null,this.pollingInterval=null,this.uuid=null,this.line=null},t=[{key:"setLine",value:function(e){this.line=e}},{key:"setPollingTime",value:function(e){var t;this.pollingTime=e,null!==(t=this.line)&&void 0!==t&&t.isConnected||(this.disconnect(),this.connect())}},{key:"connect",value:function(){var e=this;this.check(),this.pollingInterval=setInterval(function(){var t;null!==(t=e.line)&&void 0!==t&&t.isConnected?e.disconnect():e.check()},this.pollingTime)}},{key:"disconnect",value:function(){window.clearInterval(this.pollingInterval)}},{key:"check",value:function(){var e,t,r,n,i=this,a=(e="".concat(this._getURL(),"?").concat(o.toURIParams(this._requestParams())),t=this.reqOpts,r=document.querySelector("meta[name='csrf-token']"),(n=new XMLHttpRequest).withCredentials=!0===t.cookiesByCORS,n.open("GET",e),n.setRequestHeader("Accept","application/json"),r&&n.setRequestHeader("X-CSRF-Token",r.content),null!=t.authorizationHeader&&n.setRequestHeader("Authorization",t.authorizationHeader),n);a.onload=function(e){if(e.target.status>=200&&e.target.status<400){var t=JSON.parse(e.target.response);i.syncTime=t[1];var r=t[0];if(0===r.length)return;var n,o=function(e){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=g(e))){t&&(e=t);var r=0,n=function(){};return{s:n,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,a=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return i=e.done,e},e:function(e){a=!0,o=e},f:function(){try{i||null==t.return||t.return()}finally{if(a)throw o}}}}(r);try{for(o.s();!(n=o.n()).done;){var a=n.value;h(a,{log:i.log,notificationCenter:i.notificationCenter,emit:function(e){var t;return null===(t=i.line)||void 0===t?void 0:t.send(e)}})}}catch(e){o.e(e)}finally{o.f()}r.length===i.size&&i.check()}},a.send()}},{key:"_requestParams",value:function(){var e={synced_at:this.syncTime};return null!=this.token&&(e.token=this.token),null!=this.uuid&&(e.uuid=this.uuid),e}},{key:"_getURL",value:function(){var e=v(window.location.href.split("/"),3),t=e[0],r=e[2];if(null!=this.protocolWithHost){var n=v(this.protocolWithHost.split("//"),2);t=n[0],r=n[1]}return null!=this.ssl&&(t=this.ssl?"https:":"http:"),"".concat(t,"//").concat(r,"/").concat(this.location)}}],t&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_(n.key),n)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();const S=E;function O(e){return O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},O(e)}function j(e){return j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},j(e)}function k(e){var t=function(e){if("object"!=j(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=j(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==j(t)?t:t+""}var P=function(){return e=function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.client=t,this.notificationCenter=r,this.wire=n,this.isConnected=!1,this.disconnectWire=!1},t=[{key:"connect",value:function(){this.client.connect(this)}},{key:"disconnect",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).all,t=void 0!==e&&e;return this.disconnectWire=t,this.client.disconnect()}},{key:"send",value:function(e){return!!this.isConnected&&this.client.send(e)}},{key:"pong",value:function(){var e=this;setTimeout(function(){return e.send({loco:{pong:!0}})},3e3)}},{key:"connected",value:function(){console.log("WS connected"),this.isConnected=!0,null!==this.wire&&this.wire.check(),this.notificationCenter({loco:"connected"}),this.pong()}},{key:"disconnected",value:function(){console.log("WS disconnected"),this.isConnected=!1,null!==this.wire&&(this.wire.uuid=null,this.disconnectWire||this.wire.connect()),this.disconnectWire=!1,this.notificationCenter({loco:"disconnected"})}},{key:"rejected",value:function(){console.log("WS rejected"),this.notificationCenter({loco:"rejected"})}},{key:"received",value:function(e){if(null!=e.loco){var t=function(e,t){if(!0===e.ping&&t.pong(),null!=t.wire)return"string"==typeof e.sync_time&&(t.wire.syncTime=e.sync_time),"string"==typeof e.uuid&&(console.log("uuid: ".concat(e.uuid)),t.wire.uuid=e.uuid),"object"===O(e.notification)&&"Array"===e.notification.constructor.name&&h(e.notification,{log:t.wire.log,notificationCenter:t.notificationCenter,emit:t.send}),"string"!=typeof e.idempotency_key||!c(e.idempotency_key)}(e.loco,this);if(!0!==t)return;delete e.loco}0!==Object.keys(e).length&&this.notificationCenter(e)}}],t&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,k(n.key),n)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();const I=P;function T(e){return T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},T(e)}function A(e){var t=function(e){if("object"!=T(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=T(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==T(t)?t:t+""}var C=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.consumer=t,this.subscription=null},t=[{key:"connect",value:function(e){this.subscription=this.consumer.subscriptions.create({channel:"Loco::NotificationCenterChannel"},{connected:function(){e.connected()},disconnected:function(){e.disconnected()},rejected:function(){e.rejected()},received:function(t){e.received(t)}})}},{key:"disconnect",value:function(){this.consumer.disconnect()}},{key:"send",value:function(e){this.subscription.send(e)}}],t&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,A(n.key),n)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();const R=C;function M(e){return M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},M(e)}function N(e){var t=function(e){if("object"!=M(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=M(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==M(t)?t:t+""}function z(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var x=new WeakSet;function B(e){return null!=e.wsClient?e.wsClient:null!=e.cable?new R(e.cable):null}function q(e){(document.attachEvent?"complete"===document.readyState:"loading"!==document.readyState)?e():document.addEventListener("DOMContentLoaded",e)}const D=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),function(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}(this,x),this.models=t,this.wire=null,this.line=null},(t=[{key:"getModels",value:function(){return this.models}},{key:"getLine",value:function(){return this.line}},{key:"getWire",value:function(){return this.wire}},{key:"setAuthorizationHeader",value:function(e){for(var t in this.models)Object.prototype.hasOwnProperty.call(this.models,t)&&(this.models[t].authorizationHeader=e)}},{key:"init",value:function(e){var t,r=null!==(t=e.notifications)&&void 0!==t?t:{};if(r.protocolWithHost=e.protocolWithHost,!1!==r.enable){var n={cookiesByCORS:e.cookiesByCORS,authorizationHeader:e.authorizationHeader};this.wire=new S(r,e.notificationCenter,n),this.wire.connect()}var o=z(x,this,B).call(this,e);null!=o&&(this.line=new I(o,e.notificationCenter,this.wire),this.line.connect(),this.wire&&this.wire.setLine(this.line)),z(x,this,q).call(this,function(){var t;null===(t=e.postInit)||void 0===t||t.call(e)})}},{key:"emit",value:function(e){return this.line.send(e)}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,N(n.key),n)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();var $=function(e){var t=function(e){var t=e.models||{};if(null===a)return t;for(var r=0,n=Object.keys(t);r<n.length;r++){var o=n[r];a[o]=t[o]}return t}(e),r=new D(t);return r.init(e),r},L=function(){},H=function(e){var t,r;t=e.IdentityMap,(i=t).clear(),r=e.Models,a=r,L=e.IdentityMap.subscribe};return t})(),e.exports=t()}},r={};function n(e){var o=r[e];if(void 0!==o)return o.exports;var i=r[e]={exports:{}};return t[e](i,i.exports,n),i.exports}n.m=t,e=[],n.O=function(t,r,o,i){if(!r){var a=1/0;for(l=0;l<e.length;l++){r=e[l][0],o=e[l][1],i=e[l][2];for(var s=!0,c=0;c<r.length;c++)(!1&i||a>=i)&&Object.keys(n.O).every(function(e){return n.O[e](r[c])})?r.splice(c--,1):(s=!1,i<a&&(a=i));if(s){e.splice(l--,1);var u=o();void 0!==u&&(t=u)}}return t}i=i||0;for(var l=e.length;l>0&&e[l-1][2]>i;l--)e[l]=e[l-1];e[l]=[r,o,i]},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.e=function(){return Promise.resolve()},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},function(){var e={543:0};n.O.j=function(t){return 0===e[t]};var t=function(t,r){var o,i,a=r[0],s=r[1],c=r[2],u=0;if(a.some(function(t){return 0!==e[t]})){for(o in s)n.o(s,o)&&(n.m[o]=s[o]);if(c)var l=c(n)}for(t&&t(r);u<a.length;u++)i=a[u],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return n.O(l)},r=self.webpackChunk=self.webpackChunk||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var o=n.O(void 0,[121],function(){return n(728)});o=n.O(o)}();