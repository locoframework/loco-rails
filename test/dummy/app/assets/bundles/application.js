!function(e){function t(t){for(var r,a,c=t[0],u=t[1],l=t[2],s=0,p=[];s<c.length;s++)a=c[s],o[a]&&p.push(o[a][0]),o[a]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(e[r]=u[r]);for(f&&f(t);p.length;)p.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,c=1;c<n.length;c++){var u=n[c];0!==o[u]&&(r=!1)}r&&(i.splice(t--,1),e=a(a.s=n[0]))}return e}var r={},o={0:0},i=[];function a(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=r,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="";var c=window.webpackJsonp=window.webpackJsonp||[],u=c.push.bind(c);c.push=t,c=c.slice();for(var l=0;l<c.length;l++)t(c[l]);var f=u;i.push([144,1]),n()}({100:function(e,t,n){},101:function(e,t,n){},144:function(e,t,n){"use strict";n.r(t);n(100),n(101);var r=n(97);n.n(r).a.start();var o=n(1),i=n(98);n(5),n(6),n(7),n(4),n(31),n(10),n(11),n(3),n(8),n(9);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var s=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=u(this,l(t).call(this,n))).notice=n.notice,e.alert=n.alert,e.warning=n.warning,e.hide=n.hide,e}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(t,o["Views"].Base),n=t,(r=[{key:"setNotice",value:function(e){this.notice=e}},{key:"setAlert",value:function(e){this.alert=e}},{key:"setWarning",value:function(e){this.warning=e}},{key:"render",value:function(){var e=document.querySelector(".flash");e.classList.remove("notice"),e.classList.remove("alert"),e.classList.remove("warning"),null!=this.notice?(e.classList.add("notice"),document.querySelector(".flash p").textContent=this.notice):null!=this.alert?(e.classList.add("alert"),document.querySelector(".flash p").textContent=this.alert):null!=this.warning&&(e.classList.add("warning"),document.querySelector(".flash p").textContent=this.warning),e.classList.remove("none"),this.hide&&this.hideAfterTime()}},{key:"hideAfterTime",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4e3;setTimeout(function(){document.querySelector(".flash").classList.add("none")},e)}}])&&c(n.prototype,r),i&&c(n,i),t}(),p={disconnectedForTooLong:function(){new s({alert:"You have been disconnected from the server for too long. Reload page!",hide:!1}).render()}},y=(n(27),n(0)),m=n.n(y),b=n(16),d="ADD_ARTICLES",h="PREPEND_ARTICLES",v="REMOVE_ARTICLE",w="SET_ARTICLES",g="UPDATE_ARTICLE",_="ADD_COMMENTS",O="REMOVE_COMMENT",j="SET_COMMENTS",S="UPDATE_COMMENT",E="PREPEND_USERS";function k(e){return{type:d,articles:e}}function P(e){return{type:w,articles:e}}function I(e,t){return{type:g,article:e,index:t}}function C(e,t){return{type:j,comments:e,articleId:t}}function T(e,t,n){return{type:S,comment:e,articleId:t,index:n}}var A=n(51),x=(n(24),n(49),n(32)),R=Object(x.a)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case d:return e.concat(t.articles);case h:return t.articles.concat(e);case v:return e.filter(function(e){return e.id!==t.id});case w:return t.articles;case g:e[t.index]=t.article;break;default:return e}}),B=(n(63),Object(x.a)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case _:e[t.articleId]=e[t.articleId].concat(t.comments);break;case O:if(null==e[t.articleId])return e;e[t.articleId]=e[t.articleId].filter(function(e){return e.id!==t.id});break;case j:e[t.articleId]=t.comments;break;case S:var n=t.articleId,r=t.index;if(!r){var o=e[n].find(function(e){return e.id===t.comment.id});r=e[n].indexOf(o)}e[n][r]=t.comment;break;default:return e}})),z=Object(x.a)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USERS":return t.users;case E:return t.users.concat(e);default:return e}}),N=Object(A.a)({articles:R,comments:B,users:z}),D=Object(A.b)(N);function L(e){return(L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function q(e,t){return!t||"object"!==L(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function M(e){return(M=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function V(e,t){return(V=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var U=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),q(this,M(t).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&V(e,t)}(t,o["Views"].Base),t}();n(90);function F(e){return(F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function W(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function H(e,t){return!t||"object"!==F(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function J(e){return(J=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Y(e,t){return(Y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var $=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=H(this,J(t).call(this,n))).article=null,e}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Y(e,t)}(t,o["Views"].Base),n=t,(r=[{key:"renderArticle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null==this.article&&(this.connectWith(e,{receiver:"articleReceivedSignal"}),this.article=e),document.getElementById("article_title").textContent=this.article.title,document.getElementById("article_text").textContent=this.article.content;var t=document.getElementById("publish_article");t&&null!=this.article.publishedAt?t.style.display="none":t&&(t.style.display=""),this._handlePublishing(),this._updateEditLink()}},{key:"articleReceivedSignal",value:function(e){var t=this;switch(e){case"updated":this.article.reload().then(function(){t.article.applyChanges(),t.renderArticle()});break;case"destroyed":window.location.href="/user/articles?message=deleted"}}},{key:"_handlePublishing",value:function(){var e=this;document.getElementById("publish_article").addEventListener("click",function(t){t.preventDefault(),t.target.textContent="Publishing...",e.article.put("publish").then(function(){return document.getElementById("publish_article").outerHTML="<span>Published!</span>"}).catch(function(){t.target.textContent="Publish",new s({alert:"Connection error!"}).render()})})}},{key:"_updateEditLink",value:function(){var e=document.getElementById("edit_link").getAttribute("href");document.getElementById("edit_link").setAttribute("href",e.replace("/0/","/".concat(this.article.id,"/")))}}])&&W(n.prototype,r),i&&W(n,i),t}();n(123),n(125),n(131);function G(e){return(G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function K(e,t){return!t||"object"!==G(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Q(e){return(Q=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function X(e,t){return(X=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Z(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ee=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),K(this,Q(t).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&X(e,t)}(t,o["Models"].Base),t}();Z(ee,"identity","Article.Comment"),Z(ee,"remoteName","Comment"),Z(ee,"resources",{url:"/user/articles/:articleId/comments",paginate:{per:10},main:{url:"/articles/:articleId/comments",paginate:{per:5,param:"page-num"}},admin:{url:"/admin/articles/:articleId/comments",paginate:{per:5}}}),Z(ee,"attributes",{author:{validations:{presence:!0}},text:{validations:{presence:!0,vulgarity:!0}},articleId:{type:"Int",validations:{presence:!0},remoteName:"article_id"},createdAt:{type:"Date",remoteName:"created_at"},updatedAt:{type:"Date",remoteName:"updated_at"},emotion:{type:"Int"},pinned:{type:"Boolean"},adminRate:{type:"Int",remoteName:"admin_rate"},approved:{type:"Boolean"}});var te=ee,ne=(n(28),n(2)),re=n.n(ne),oe=function(e,t){return e.comments[t]};n(92),n(93),n(94);function ie(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ae(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function ce(e){var t,n=e.comment,r=e.isAdmin,i=void 0!==r&&r,a=ae(Object(y.useState)(!1),2),c=a[0],u=a[1],l=new o.Services.Date(n.createdAt).strftime("%d %b %y"),f=function(e){e.preventDefault(),u(!0),n.approved=!0,n.updateAttribute("approved").then(function(e){e.ok&&D.dispatch(T(new te(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){ie(e,t,n[t])})}return e}({},n,{approved:!0})),n.articleId))})};return m.a.createElement("p",{id:"comment_".concat(n.id)},m.a.createElement("b",null,n.author)," on ",m.a.createElement("i",null,l),i?(t=n.approved?m.a.createElement(m.a.Fragment,null,m.a.createElement("span",null,"approved")," |"," "):c?m.a.createElement(m.a.Fragment,null,m.a.createElement("span",null,"approving...")," |"," "):m.a.createElement(m.a.Fragment,null,m.a.createElement("a",{href:"/user/articles/".concat(n.articleId,"/comments/").concat(n.id,"/approve"),className:"approve",onClick:f},"approve")," ","|"," "),m.a.createElement(m.a.Fragment,null," ","(",t,m.a.createElement("a",{href:"/user/articles/".concat(n.articleId,"/comments/").concat(n.id,"/edit")},"edit")," ","|"," ",m.a.createElement("a",{href:"/user/articles/".concat(n.articleId,"/comments/").concat(n.id),"data-method":"delete","data-confirm":"Are you sure?"},"delete"),")")):"",m.a.createElement("br",null),n.text)}ce.propTypes={comment:re.a.instanceOf(te).isRequired,isAdmin:re.a.bool};var ue=ce;function le(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function fe(e){var t=e.articleId,n=e.isAdmin||!1,r=le(Object(y.useState)(e.comments),2),o=r[0],i=r[1];if(Object(y.useEffect)(function(){var e=D.subscribe(function(){return i(oe(D.getState(),t))});return function(){e()}}),0===o.length)return m.a.createElement("p",null,"No comments.");var a=o.map(function(e){return m.a.createElement(ue,{key:e.id,comment:e,isAdmin:n})});return m.a.createElement(m.a.Fragment,null,a)}fe.propTypes={articleId:re.a.number.isRequired,isAdmin:re.a.bool,comments:re.a.arrayOf(re.a.instanceOf(te)).isRequired};var se=fe;function pe(e){return(pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ye(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function me(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function be(e,t){return!t||"object"!==pe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function de(e){return(de=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function he(e,t){return(he=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ve=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=be(this,de(t).call(this,n))).article=null,e.form=null,e.changes=null,e}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&he(e,t)}(t,o["Views"].Base),n=t,(r=[{key:"render",value:function(e){D.dispatch(k([e])),this.article=e,this.connectWith(this.article),this._handleApplyingChanges(),this.form=new o.UI.Form({for:this.article}),this.form.render()}},{key:"renderComments",value:function(e){te.all({articleId:e}).then(function(t){D.dispatch(C(t.resources,e)),Object(b.render)(m.a.createElement(se,{articleId:e,comments:t.resources,isAdmin:!0}),document.getElementById("comments"))})}},{key:"receivedSignal",value:function(e,t){var n=this;switch(e){case"updating":if(document.querySelector("h1").getAttribute("data-mark")!==t.mark)new s({warning:"Uuups someone else started editing this article."}).render();break;case"updated":this.article.reload().then(function(){n.changes=n.article.changes(),n._displayChanges()});break;case"destroyed":window.location.href="/user/articles?message=deleted"}}},{key:"_displayChanges",value:function(){for(var e=0,t=Object.entries(this.changes);e<t.length;e++){var n=ye(t[e],1)[0],r=document.querySelector("a.apply_changes[data-for=".concat(this.article.getAttrRemoteName(n),"]"));r&&r.classList.remove("none")}}},{key:"_handleApplyingChanges",value:function(){for(var e=this,t=0,n=Array.from(document.querySelectorAll("a.apply_changes"));t<n.length;t++){n[t].addEventListener("click",function(t){t.preventDefault();var n=e.article.getAttrName(t.target.getAttribute("data-for"));e.article[n]=e.changes[n].is,e.form.fill(n),t.target.classList.add("none")})}}}])&&me(n.prototype,r),i&&me(n,i),t}();function we(e){return(we="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ge(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _e(e,t){return!t||"object"!==we(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Oe(e){return(Oe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function je(e,t){return(je=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Se(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ee=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=_e(this,Oe(t).call(this,e))).published=null!=n.publishedAt,n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&je(e,t)}(t,o["Models"].Base),n=t,(r=[{key:"vulgarityLevel",value:function(){(null!=this.title&&/fuck/i.exec(this.title)||null!=this.content&&/fuck/i.exec(this.content))&&this.addErrorMessage("Article contains strong language.",{for:"base"})}},{key:"setDefaultValuesForAdminReview",value:function(){this.adminRate=null==this.adminRate?3:this.adminRate,this.categoryId=null==this.categoryId?6:this.categoryId,this.adminReviewStartedAt=Date.now()}}])&&ge(n.prototype,r),i&&ge(n,i),t}();Se(Ee,"identity","Article"),Se(Ee,"resources",{url:"/user/articles",paginate:{per:5},main:{url:"/articles",paginate:{per:3}},admin:{url:"/admin/articles",paginate:{per:4}}}),Se(Ee,"attributes",{title:{validations:{presence:!0,length:{within:[3,255]}}},content:{validations:{presence:!0,length:{minimum:100}},remoteName:"text"},createdAt:{type:"Date",remoteName:"created_at"},updatedAt:{type:"Date",remoteName:"updated_at"},commentsCount:{type:"Int",remoteName:"comments_count"},publishedAt:{type:"Date",remoteName:"published_at"},published:{},adminReview:{remoteName:"admin_review"},adminRate:{type:"Int",remoteName:"admin_rate"},categoryId:{type:"Int",remoteName:"category_id"},adminReviewStartedAt:{remoteName:"admin_review_started_at"}}),Se(Ee,"validate",["vulgarityLevel"]);var ke=Ee;function Pe(e){var t=e.article,n=e.onArticleDestroyed;return m.a.createElement("tr",{id:"article_".concat(t.id)},m.a.createElement("td",null,t.title),m.a.createElement("td",null,t.content),m.a.createElement("td",{className:"comments_quantity"},t.commentsCount),m.a.createElement("td",{className:"published"},t.publishedAt?"yes":"no"),m.a.createElement("td",null,m.a.createElement("a",{href:"/user/articles/".concat(t.id)},"Show")," |",m.a.createElement("a",{href:"/user/articles/".concat(t.id,"/edit")},"Edit")," |",m.a.createElement("a",{href:"/user/articles/".concat(t.id),className:"delete_article",onClick:function(e){e.preventDefault(),confirm("Are you sure?")&&t.delete(null).then(function(e){var t;e.success&&D.dispatch((t=e.id,{type:v,id:t})),n(e)})}},"Delete")))}Pe.propTypes={article:re.a.instanceOf(ke).isRequired,onArticleDestroyed:re.a.func.isRequired};var Ie=Pe;function Ce(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Te(e){var t=Ce(Object(y.useState)(e.articles),2),n=t[0],r=t[1];Object(y.useEffect)(function(){var e=D.subscribe(function(){return r(D.getState().articles)});return function(){e()}});var o=n.map(function(t){return m.a.createElement(Ie,{key:t.id,article:t,onArticleDestroyed:e.onArticleDestroyed})});return m.a.createElement(m.a.Fragment,null,o)}Te.propTypes={articles:re.a.arrayOf(re.a.instanceOf(ke)).isRequired,onArticleDestroyed:re.a.func.isRequired};var Ae=Te;function xe(e){return(xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Re(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Be(e,t){return!t||"object"!==xe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ze(e){return(ze=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ne(e,t){return(Ne=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var De=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Be(this,ze(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ne(e,t)}(t,o["Controllers"].Base),n=t,(r=[{key:"initialize",value:function(){this.layout=new U}},{key:"onArticleDestroyed",value:function(e){var t=new s;e.success?t.setNotice(e.notice):t.setAlert(e.alert),t.render()}},{key:"index",value:function(){var e=this;"deleted"===this.params.message&&new s({alert:"Article has been deleted."}).render();ke.get("all").then(function(t){D.dispatch(P(t.resources)),Object(b.render)(m.a.createElement(Ae,{articles:t.resources,onArticleDestroyed:e.onArticleDestroyed}),document.getElementById("article_list"))})}},{key:"show",value:function(){var e=this;this.showView=new $,ke.find(this.params.id).then(function(t){D.dispatch(P([t])),e.showView.renderArticle(t)}),te.all({articleId:this.params.id}).then(function(t){D.dispatch(C(t.resources,e.params.id)),Object(b.render)(m.a.createElement(se,{articleId:e.params.id,comments:t.resources}),document.getElementById("comments"))})}},{key:"new",value:function(){(new ve).render(new ke)}},{key:"edit",value:function(){var e=new ve;ke.find(this.params.id).then(function(t){return e.render(t)}),e.renderComments(this.params.id)}}])&&Re(n.prototype,r),i&&Re(n,i),t}();function Le(e){return(Le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qe(e,t){return!t||"object"!==Le(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Me(e){return(Me=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ve(e,t){return(Ve=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ue(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Fe=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),qe(this,Me(t).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ve(e,t)}(t,o["Models"].Base),t}();Ue(Fe,"identity","Room.Member"),Ue(Fe,"resources",{url:"/user/rooms/:roomId/members",paginate:{per:100}}),Ue(Fe,"attributes",{}),Ue(Fe,"validate",[]);var We=Fe;n(136),n(95);function He(e){return(He="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Je(e,t){return!t||"object"!==He(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ye(e){return(Ye=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ge(e,t,n){return t&&$e(e.prototype,t),n&&$e(e,n),e}function Ke(e,t){return(Ke=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Qe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Xe=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Je(this,Ye(t).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ke(e,t)}(t,o["Models"].Base),Ge(t,null,[{key:"receivedSignal",value:function(e){console.log("User.receivedSignal: ".concat(e))}}]),Ge(t,[{key:"receivedSignal",value:function(e){console.log("User#receivedSignal: ".concat(e))}}]),t}();Qe(Xe,"identity","User"),Qe(Xe,"resources",{url:"/users",admin:{url:"/admin/users"}}),Qe(Xe,"paginate",{per:10}),Qe(Xe,"attributes",{email:{validations:{presence:!0,format:{with:/^([^@\s]+)@((?:[-a-z0-9]+\.)+[a-z]{2,})$/i}}},username:{validations:{presence:!0,format:{with:/^[a-z][a-z0-9_-]*$/i}}},password:{validations:{presence:{on:"create"},confirmation:!0}},passwordConfirmation:{remoteName:"password_confirmation"},confirmed:{},createdAt:{type:"Date",remoteName:"created_at"},updatedAt:{type:"Date",remoteName:"updated_at"}});var Ze=Xe;function et(e){return(et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function nt(e,t){return!t||"object"!==et(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function rt(e){return(rt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ot(e,t){return(ot=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var it=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),nt(this,rt(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ot(e,t)}(t,o["Views"].Base),n=t,(r=[{key:"render",value:function(){this.connectWith(Ze)}},{key:"receivedSignal",value:function(e,t){switch(e){case"Room member_joined":this._memberJoined(t.room_id);break;case"Room member_left":this._memberLeft(t.room_id);break;case"Room created":var n=this._renderRoom(t.room);document.getElementById("rooms_list").insertAdjacentHTML("beforeend",n);break;case"Room destroyed":var r=document.getElementById("room_".concat(t.room_id));r.parentNode.removeChild(r)}}},{key:"_memberJoined",value:function(e){var t=this._membersNode(e);t.textContent=parseInt(t.text())+1}},{key:"_memberLeft",value:function(e){var t=this._membersNode(e);t.textContent=parseInt(t.text())-1}},{key:"_membersNode",value:function(e){document.querySelector("#room_".concat(e," td.members"))}},{key:"_renderRoom",value:function(e){"\n    <tr id='room_".concat(e.id,"'>\n      <td>").concat(e.name,"</td>\n      <td class='members'>0</td>\n      <td>\n        <a rel='nofollow' data-method='patch' href='/user/rooms/").concat(e.id,"/join'>Join</a> |\n        <a data-confirm='R U sure?' rel='nofollow' data-method='delete'\n          href='/user/rooms/").concat(e.id,"'>Destroy</a>\n      </td>\n    </tr>\n    ")}}])&&tt(n.prototype,r),i&&tt(n,i),t}();function at(e){return(at="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ct(e,t){return!t||"object"!==at(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ut(e){return(ut=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function lt(e,t){return(lt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ft(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var st=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ct(this,ut(t).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&lt(e,t)}(t,o["Models"].Base),t}();ft(st,"identity","Room"),ft(st,"resources",{}),ft(st,"attributes",{}),ft(st,"validate",[]);var pt=st;function yt(e){return(yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function bt(e,t){return!t||"object"!==yt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function dt(e){return(dt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ht(e,t){return(ht=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var vt=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=bt(this,dt(t).call(this,n))).roomId=n.id,e}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ht(e,t)}(t,o["Views"].Base),n=t,(r=[{key:"render",value:function(){this.connectWith(pt),this._handleSendingMessage()}},{key:"renderMembers",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=e[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;this._memberJoined(a)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}}},{key:"receivedMessage",value:function(e,t){var n="<p><b>".concat(t,"</b>: ").concat(e,"</p>");document.getElementById("messages").insertAdjacentHTML("beforeend",n)}},{key:"receivedSignal",value:function(e,t){switch(e){case"Room member_joined":if(t.room_id!==this.roomId)return;this._memberJoined(t.member);break;case"Room member_left":if(t.room_id!==this.roomId)return;this._memberLeft(t.member)}}},{key:"_handleSendingMessage",value:function(){var e=this;document.querySelector("[data-behavior~=room-speaker]").addEventListener("keypress",function(t){13===t.keyCode&&(t.preventDefault(),o.Env.loco.emit({signal:"message",txt:t.target.value,room_id:e.roomId}),t.target.value="")})}},{key:"_memberJoined",value:function(e){var t="<li id='user_".concat(e.id,"'>").concat(e.username,"</li>");document.getElementById("members").insertAdjacentHTML("beforeend",t)}},{key:"_memberLeft",value:function(e){var t=document.querySelector("#members li#user_".concat(e.id));t.parentNode.removeChild(t)}}])&&mt(n.prototype,r),i&&mt(n,i),t}();function wt(e){return(wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function gt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _t(e,t){return!t||"object"!==wt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ot(e){return(Ot=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function jt(e,t){return(jt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var St=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),_t(this,Ot(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jt(e,t)}(t,o["Controllers"].Base),n=t,(r=[{key:"initialize",value:function(){}},{key:"index",value:function(){(new it).render()}},{key:"show",value:function(){var e=new vt({id:this.params.id});this.setView("show",e),e.render(),We.all({roomId:this.params.id}).then(function(t){return e.renderMembers(t.resources)})}}])&&gt(n.prototype,r),i&&gt(n,i),t}();function Et(e){return(Et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kt(e,t){return!t||"object"!==Et(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Pt(e){return(Pt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function It(e,t){return(It=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.assign(o.Controllers.Base.prototype,p);var Ct=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),kt(this,Pt(t).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&It(e,t)}(t,o["Controllers"].Base),t}();Object.assign(Ct,{Articles:De,Rooms:St});var Tt=Ct;function At(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var xt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"receivedSignal",value:function(e){switch(e.signal){case"ping":this._pingSignal();break;case"message":this._messageSignal(e)}}},{key:"_pingSignal",value:function(){o.Env.namespaceController.constructor===Tt&&alert("Ping!")}},{key:"_messageSignal",value:function(e){var t=this._getRoomView();t&&t.receivedMessage(e.message,e.author)}},{key:"_getRoomView",value:function(){return o.Env.namespaceController.constructor===Tt&&(o.Env.controller.constructor===St&&("show"===o.Env.action&&o.Env.controller.getView("show")))}}])&&At(t.prototype,n),r&&At(t,r),e}(),Rt=function(e){return function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=t[e];r.parentId&&(o=o[r.parentId]);var i=o.find(function(e){return e.id===n});return i?[i,o.indexOf(i)]:[null,null]}},Bt=Rt("articles"),zt=Rt("comments");function Nt(e){var t=e.comment,n=new o.Services.Date(t.createdAt).strftime("%d %b %y");return m.a.createElement("p",{id:"comment_".concat(t.id)},m.a.createElement("b",null,t.author)," on ",m.a.createElement("i",null,n)," (",m.a.createElement("a",{href:"/admin/articles/".concat(t.articleId,"/comments/").concat(t.id,"/edit")},"edit"),")",m.a.createElement("br",null),t.text)}Nt.propTypes={comment:re.a.instanceOf(te).isRequired};var Dt=Nt;function Lt(e){var t=e.comments;return 0===t.length?m.a.createElement("p",null,"No comments"):m.a.createElement(m.a.Fragment,null,t.map(function(e){return m.a.createElement(Dt,{comment:e,key:e.id})}))}Lt.propTypes={comments:re.a.arrayOf(re.a.instanceOf(te)).isRequired};var qt=Lt;function Mt(e){return(Mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Vt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ut(e,t){return!t||"object"!==Mt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ft(e){return(Ft=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Wt(e,t){return(Wt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ht=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Ut(this,Ft(t).call(this,n))).article=null,e}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wt(e,t)}(t,o["Views"].Base),n=t,(r=[{key:"receivedSignal",value:function(e){var t=this;switch(e){case"updated":this.article.reload().then(function(){t.article.applyChanges(),t._renderArticle()})}}},{key:"render",value:function(e){this.article=e,this.connectWith(e),this._renderArticle()}},{key:"renderComments",value:function(e){Object(b.render)(m.a.createElement(qt,{comments:e}),document.getElementById("comments"))}},{key:"_renderArticle",value:function(){document.getElementById("article_author").textContent=this.article.author,document.getElementById("article_title").textContent=this.article.title,document.getElementById("article_text").textContent=this.article.content}}])&&Vt(n.prototype,r),i&&Vt(n,i),t}();function Jt(e){return(Jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Yt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $t(e,t){return!t||"object"!==Jt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Gt(e){return(Gt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Kt(e,t){return(Kt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Qt=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),$t(this,Gt(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Kt(e,t)}(t,o["Views"].Base),n=t,(r=[{key:"render",value:function(e){e.setDefaultValuesForAdminReview(),new o.UI.Form({id:"edit_article_form",for:e}).render()}}])&&Yt(n.prototype,r),i&&Yt(n,i),t}();n(50);function Xt(e){var t=e.article,n=new o.Services.Date(t.publishedAt).toString("short");return m.a.createElement("article",{id:"article_".concat(t.id)},m.a.createElement("h2",null,t.title),m.a.createElement("p",null,m.a.createElement("i",null,t.author," wrote this on ",n," /"," ",m.a.createElement("span",{className:"comments_quantity"},t.commentsCount," comment",1===t.commentsCount?"":"s"))),m.a.createElement("p",null,t.content),m.a.createElement("p",null,m.a.createElement("a",{href:"/admin/articles/".concat(t.id,"/edit")},"Review")))}Xt.propTypes={article:re.a.instanceOf(ke).isRequired};var Zt=Xt;function en(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function tn(e){var t=en(Object(y.useState)(e.articles),2),n=t[0],r=t[1];Object(y.useEffect)(function(){var e=D.subscribe(function(){return r(D.getState().articles)});return function(){e()}});var o=n.map(function(e){return m.a.createElement(Zt,{key:e.id,article:e})});return m.a.createElement(m.a.Fragment,null,o)}tn.propTypes={articles:re.a.arrayOf(re.a.instanceOf(ke)).isRequired};var nn=tn;function rn(e){return(rn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function on(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function an(e,t){return!t||"object"!==rn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function cn(e){return(cn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function un(e,t){return(un=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ln=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),an(this,cn(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&un(e,t)}(t,o["Controllers"].Base),n=t,(r=[{key:"published",value:function(){ke.get("published").then(function(e){D.dispatch(P(e.resources)),Object(b.render)(m.a.createElement(nn,{articles:e.resources}),document.getElementById("articles"))})}},{key:"edit",value:function(){var e=new Ht;ke.find(this.params.id).then(function(t){e.render(t),(new Qt).render(t)}),te.all({articleId:this.params.id}).then(function(t){e.renderComments(t.resources)})}}])&&on(n.prototype,r),i&&on(n,i),t}();function fn(e){return(fn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pn(e,t){return!t||"object"!==fn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function yn(e){return(yn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function mn(e,t){return(mn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var bn=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),pn(this,yn(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mn(e,t)}(t,o["Views"].Base),n=t,(r=[{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new o.UI.Form({for:new te({id:e.commentId,resource:"admin"}),id:"edit_comment_".concat(e.commentId),initObj:!0});t.render(),o.Env.test={commentFormObj:t.getObj()}}}])&&sn(n.prototype,r),i&&sn(n,i),t}();function dn(e){return(dn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function vn(e,t){return!t||"object"!==dn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function wn(e){return(wn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function gn(e,t){return(gn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var _n=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),vn(this,wn(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gn(e,t)}(t,o["Controllers"].Base),n=t,(r=[{key:"edit",value:function(){(new bn).render({commentId:this.params.id})}}])&&hn(n.prototype,r),i&&hn(n,i),t}();function On(e){return(On="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Sn(e,t){return!t||"object"!==On(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function En(e){return(En=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function kn(e,t){return(kn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Pn=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Sn(this,En(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kn(e,t)}(t,o["Views"].Base),n=t,(r=[{key:"render",value:function(){new o.UI.Form({id:"sign_in_admin",delegator:this,callbackSuccess:"_signedIn"}).render()}},{key:"_signedIn",value:function(){window.location.href="/admin"}}])&&jn(n.prototype,r),i&&jn(n,i),t}();function In(e){return(In="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Cn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Tn(e,t){return!t||"object"!==In(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function An(e){return(An=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function xn(e,t){return(xn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Rn=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Tn(this,An(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xn(e,t)}(t,o["Controllers"].Base),n=t,(r=[{key:"new",value:function(){(new Pn).render()}}])&&Cn(n.prototype,r),i&&Cn(n,i),t}(),Bn=function(e){var t=e.user;return m.a.createElement("tr",{id:"user_".concat(t.id)},m.a.createElement("td",null,t.email),m.a.createElement("td",null,t.username),m.a.createElement("td",{className:"confirmed"},t.confirmed?"Yes":"No"),m.a.createElement("td",null,m.a.createElement("a",{href:"/admin/users/".concat(t.id)},"Show")," |"," ",m.a.createElement("a",{href:"/admin/users/".concat(t.id,"/edit")},"Edit")," |"," ",m.a.createElement("a",{href:"/admin/users/".concat(t.id),"data-method":"delete","data-confirm":"Are you sure?"},"Delete")," ","|"," ",m.a.createElement("a",{href:"#",onClick:function(e){return function(e,t){e.preventDefault(),o.Env.loco.emit({signal:"ping",user_id:t})}(e,t.id)}},"Ping")))};Bn.propTypes={user:re.a.instanceOf(Ze).isRequired};var zn=Bn;function Nn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Dn(e){var t=Nn(Object(y.useState)(e.users),2),n=t[0],r=t[1];Object(y.useEffect)(function(){var e=D.subscribe(function(){return r(D.getState().users)});return function(){e()}});var o=n.map(function(e){return m.a.createElement(zn,{key:"user_".concat(e.id),user:e})});return m.a.createElement(m.a.Fragment,null,o)}Dn.propTypes={users:re.a.arrayOf(re.a.instanceOf(Ze)).isRequired};var Ln=Dn;function qn(e){return(qn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Mn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Vn(e,t){return!t||"object"!==qn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Un(e){return(Un=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Fn(e,t){return(Fn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Wn=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Vn(this,Un(t).call(this,n))).user=n.user,e}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fn(e,t)}(t,o["Views"].Base),n=t,(r=[{key:"render",value:function(){document.getElementById("user_email").textContent=this.user.email,document.getElementById("user_username").textContent=this.user.username,document.getElementById("user_confirmed").textContent=this.user.confirmed?"Yes":"No",this._updateEditLink()}},{key:"_updateEditLink",value:function(){var e=document.getElementById("edit_link"),t=e.getAttribute("href");e.setAttribute("href",t.replace("/0/","/#{@user.id}/"))}}])&&Mn(n.prototype,r),i&&Mn(n,i),t}();function Hn(e){return(Hn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Jn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Yn(e,t){return!t||"object"!==Hn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $n(e){return($n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Gn(e,t){return(Gn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Kn=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Yn(this,$n(t).call(this,n))).user=n.user,e}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gn(e,t)}(t,o["Views"].Base),n=t,(r=[{key:"render",value:function(){new o.UI.Form({for:this.user,initObj:!0,id:"admin_user_form"}).render()}}])&&Jn(n.prototype,r),i&&Jn(n,i),t}();function Qn(e){return(Qn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Zn(e,t){return!t||"object"!==Qn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function er(e){return(er=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function tr(e,t){return(tr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var nr=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Zn(this,er(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tr(e,t)}(t,o["Controllers"].Base),n=t,(r=[{key:"index",value:function(){Ze.get("all").then(function(e){var t;D.dispatch((t=e.resources,{type:E,users:t})),Object(b.render)(m.a.createElement(Ln,{users:e.resources}),document.querySelector("table tbody"))})}},{key:"show",value:function(){Ze.find(this.params.id).then(function(e){return new Wn({user:e}).render()})}},{key:"edit",value:function(){new Kn({user:new Ze({id:this.params.id})}).render()}}])&&Xn(n.prototype,r),i&&Xn(n,i),t}();function rr(e){return(rr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function or(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ir(e,t){return!t||"object"!==rr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ar(e){return(ar=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function cr(e,t){return(cr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.assign(o.Controllers.Base.prototype,p);var ur=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ir(this,ar(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&cr(e,t)}(t,o["Controllers"].Base),n=t,(r=[{key:"initialize",value:function(){this.setScope("admin")}}])&&or(n.prototype,r),i&&or(n,i),t}();Object.assign(ur,{Articles:ln,Comments:_n,Sessions:Rn,Users:nr});var lr=ur;function fr(e){var t=e.comment,n=new o.Services.Date(t.createdAt).strftime("%d %b %y");return m.a.createElement("p",{id:"comment_".concat(t.id)},m.a.createElement("b",null,t.author)," on ",m.a.createElement("i",null,n)," wrote:",m.a.createElement("br",null),t.text)}fr.propTypes={comment:re.a.instanceOf(te).isRequired};var sr=fr;function pr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function yr(e){var t=e.articleId,n=pr(Object(y.useState)(e.comments),2),r=n[0],o=n[1];Object(y.useEffect)(function(){var e=D.subscribe(function(){o(oe(D.getState(),t))});return function(){e()}});var i=r.map(function(e){return m.a.createElement(sr,{key:e.id,comment:e})});return 0===r.length?m.a.createElement("p",{id:"no_comments"},"No comments."):m.a.createElement(m.a.Fragment,null,i)}yr.propTypes={articleId:re.a.number.isRequired,comments:re.a.arrayOf(re.a.instanceOf(te)).isRequired};var mr=yr;function br(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function dr(e){var t=br(Object(y.useState)(e.comments),2),n=t[0],r=t[1];return Object(y.useEffect)(function(){var t=D.subscribe(function(){r(oe(D.getState(),e.articleId))});return function(){t()}}),m.a.createElement(m.a.Fragment,null,"".concat(n.length," comment").concat(1===n.length?"":"s"))}dr.propTypes={articleId:re.a.number.isRequired,comments:re.a.arrayOf(re.a.instanceOf(te)).isRequired};var hr=dr;function vr(e){return(vr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function gr(e,t){return!t||"object"!==vr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _r(e){return(_r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Or(e,t){return(Or=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var jr=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=gr(this,_r(t).call(this,n))).article=null,e.newComment=n.comment,e}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Or(e,t)}(t,o["Views"].Base),n=t,(r=[{key:"render",value:function(){new o.UI.Form({for:this.newComment,initObj:!0,id:"new_comment"}).render()}},{key:"renderArticle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.article||(this.article=e,this.connectWith(this.article,{receiver:"_articleReceivedSignal"})),document.getElementById("title").textContent=this.article.title,document.getElementById("author").textContent=this.article.author;var t=new o.Services.Date(this.article.publishedAt);document.getElementById("pub_date").textContent=t.toString("short");var n=document.getElementById("text");n.innerHTML="";var r=(new o.Helpers.Text).simpleFormat(this.article.content);n.insertAdjacentHTML("beforeend",r)}},{key:"_articleReceivedSignal",value:function(e){var t=this;switch(e){case"updating":new s({warning:"Author is currently editing article. Be aware of possible changes."}).render();break;case"updated":this.article.reload().then(function(){t.article.applyChanges(),t.renderArticle()})}}}])&&wr(n.prototype,r),i&&wr(n,i),t}();function Sr(e){return(Sr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Er(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function kr(e,t){return!t||"object"!==Sr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Pr(e){return(Pr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ir(e,t){return(Ir=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Cr=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),kr(this,Pr(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ir(e,t)}(t,o["Controllers"].Base),n=t,(r=[{key:"show",value:function(){var e=this,t=new te({articleId:this.params.id}),n=new jr({comment:t});n.render(),ke.find(this.params.id).then(function(e){D.dispatch(P([e])),n.renderArticle(e)}),te.get("count",{articleId:this.params.id}).then(function(t){te.all({articleId:e.params.id,total:t.total}).then(function(t){D.dispatch(C(t,e.params.id)),Object(b.render)(m.a.createElement(mr,{articleId:e.params.id,comments:t}),document.getElementById("comments")),Object(b.render)(m.a.createElement(hr,{articleId:e.params.id,comments:t}),document.getElementById("comments_count"))})})}}])&&Er(n.prototype,r),i&&Er(n,i),t}();function Tr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Ar(){var e=Tr(Object(y.useState)(1),2),t=e[0],n=e[1],r=Tr(Object(y.useState)(!1),2),o=r[0],i=r[1];function a(e){e.preventDefault();var r=t+1;n(r),ke.get("all",{page:r}).then(function(e){e.resources.length>0?D.dispatch(k(e.resources)):i(!0)}).catch(function(e){return alert("Invalid URL: ".concat(e))})}return o?m.a.createElement("span",null,"No more posts."):m.a.createElement("a",{href:"#",id:"load_more",onClick:a},"Load more")}function xr(e){var t=e.article,n=new o.Services.Date(t.publishedAt).toString("short");return m.a.createElement("article",{id:"article_".concat(t.id)},m.a.createElement("h2",null,t.title),m.a.createElement("p",null,m.a.createElement("i",null,t.author," wrote this on ",n," /"," ",m.a.createElement("a",{href:"/articles/".concat(t.id,"#comments"),className:"comments_quantity"},t.commentsCount," comment",1===t.commentsCount?"":"s"))),m.a.createElement("p",null,t.content),m.a.createElement("p",null,m.a.createElement("a",{href:"/articles/".concat(t.id)},"Continued")))}xr.propTypes={article:re.a.instanceOf(ke).isRequired};var Rr=xr;function Br(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function zr(e){var t=Br(Object(y.useState)(e.articles),2),n=t[0],r=t[1];Object(y.useEffect)(function(){var e=D.subscribe(function(){return r(D.getState().articles)});return function(){e()}});var o=n.map(function(e){return m.a.createElement(Rr,{key:e.id,article:e})});return m.a.createElement(m.a.Fragment,null,o)}zr.propTypes={articles:re.a.arrayOf(re.a.instanceOf(ke)).isRequired};var Nr=zr;function Dr(e){return(Dr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Lr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qr(e,t){return!t||"object"!==Dr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Mr(e){return(Mr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Vr(e,t){return(Vr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ur=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),qr(this,Mr(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vr(e,t)}(t,o["Controllers"].Base),n=t,(r=[{key:"index",value:function(){Object(b.render)(m.a.createElement(Ar,null),document.getElementById("load_more_wrapper")),ke.get("all",{page:1}).then(function(e){D.dispatch(P(e.resources)),Object(b.render)(m.a.createElement(Nr,{articles:e.resources}),document.getElementById("articles"))})}}])&&Lr(n.prototype,r),i&&Lr(n,i),t}();function Fr(e){return(Fr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Hr(e,t){return!t||"object"!==Fr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Jr(e){return(Jr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Yr(e,t){return(Yr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var $r=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Hr(this,Jr(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Yr(e,t)}(t,o["Views"].Base),n=t,(r=[{key:"render",value:function(){new o.UI.Form({for:new Ze,delegator:this,callbackSuccess:"_created"}).render()}},{key:"receivedSignal",value:function(e){switch(e){case"confirming":this._confirming();break;case"confirmed":this._confirmed()}}},{key:"_created",value:function(e){this.connectWith(new Ze({id:e.id})),document.querySelector("form").style.display="none",document.getElementById("sign_in_paragraph").classList.remove("none"),document.getElementById("verification_info").classList.remove("none"),new s({notice:e.notice}).render()}},{key:"_confirming",value:function(){document.getElementById("verification_info").textContent=document.getElementById("verification_progress").textContent}},{key:"_confirmed",value:function(){window.location.href="/user/sessions/new?event=confirmed"}}])&&Wr(n.prototype,r),i&&Wr(n,i),t}();function Gr(e){return(Gr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Kr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Qr(e,t){return!t||"object"!==Gr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Xr(e){return(Xr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Zr(e,t){return(Zr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var eo=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Qr(this,Xr(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Zr(e,t)}(t,o["Controllers"].Base),n=t,(r=[{key:"new",value:function(){(new $r).render()}}])&&Kr(n.prototype,r),i&&Kr(n,i),t}();function to(e){return(to="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function no(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ro(e,t){return!t||"object"!==to(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function oo(e){return(oo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function io(e,t){return(io=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.assign(o.Controllers.Base.prototype,p);var ao=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ro(this,oo(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&io(e,t)}(t,o["Controllers"].Base),n=t,(r=[{key:"initialize",value:function(){this.setScope("main")}}])&&no(n.prototype,r),i&&no(n,i),t}();Object.assign(ao,{Articles:Cr,Pages:Ur,Users:eo});var co=ao;function uo(e){return(uo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fo(e,t){return!t||"object"!==uo(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function so(e){return(so=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function po(e,t){return(po=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function yo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){mo(e,t,n[t])})}return e}function mo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function bo(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var ho=function(e){var t=e.id;o.Env.namespaceController.constructor===lr?ke.find({id:t,abbr:!0,resource:"admin"}).then(function(e){D.dispatch({type:h,articles:[e]})}):ke.find({id:t,abbr:!0}).then(function(e){return D.dispatch(k([e]))})},vo=function(e,t){var n=e.article_id,r=bo(Bt(D.getState(),n),2),o=r[0],i=r[1];if(o){var a=new ke(yo({},o,{commentsCount:o.commentsCount+t}));D.dispatch(I(a,i))}},wo=function(e){var t=e.article_id,n=e.id,r={articleId:t,id:n};o.Env.namespaceController.constructor===co&&(r.resource="main"),bo(Bt(D.getState(),t),1)[0]&&te.find(r).then(function(e){return D.dispatch(function(e,t){return{type:_,articleId:t,comments:e}}([e],t))})},go=function(e){var t=e.article_id,n=e.id;D.dispatch(function(e,t){return{type:O,id:e,articleId:t}}(n,t))},_o=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),fo(this,so(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&po(e,t)}(t,o["Views"].Base),n=t,(r=[{key:"receivedSignal",value:function(e,t){switch(e){case"Article created":n=t.id,o.Env.namespaceController.constructor===Tt&&ke.find({id:n,abbr:!0}).then(function(e){return D.dispatch(k([e]))});break;case"Article published":ho(t);break;case"Article updated":!function(e){var t=e.id,n={id:t,abbr:!0};o.Env.namespaceController.constructor===lr&&(n.resource="admin");var r=bo(Bt(D.getState(),t),2),i=r[0],a=r[1];i&&ke.find(n).then(function(e){return D.dispatch(I(e,a))})}(t);break;case"Article.Comment created":vo(t,1),wo(t);break;case"Article.Comment destroyed":vo(t,-1),go(t);break;case"Article.Comment updated":!function(e){var t=e.article_id,n=e.id,r=bo(zt(D.getState(),n,{parentId:t}),2),o=r[0],i=r[1];o&&o.reload().then(function(){o.applyChanges(),D.dispatch(T(new te(yo({},o)),t,i))})}(t);break;case"User created":Ze.find(t.id).then(function(e){return D.dispatch({type:E,users:[e]})})}var n}},{key:"call",value:function(){this.connectWith([ke,te,Ze])}}])&&lo(n.prototype,r),i&&lo(n,i),t}();o.Deps.cable=Object(i.createConsumer)(),o.Deps.NotificationCenter=xt;var Oo=new _o;new o.Loco({notifications:{enable:!0,log:!0,size:10},postInit:function(){Oo.call(),"test"===document.querySelector("body").getAttribute("data-rails-env")&&o.Env.loco.getWire().setPollingTime(1e3)}}).init();n(139);function jo(e){return(jo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function So(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Eo(e,t){return!t||"object"!==jo(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ko(e){return(ko=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Po(e,t){return(Po=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Io,Co,To,Ao=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Eo(this,ko(t).call(this))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Po(e,t)}(t,o["Validators"].Base),n=t,(r=[{key:"validate",value:function(){if(null!=this.val)switch(jo(this.val)){case"string":var e=this._getVulgarWord();if(!new RegExp("".concat(e),["i"]).exec(this.val))return;this._addErrorMessage();break;default:throw new TypeError("Vulgarity validator is applicable only for strings and ".concat(this.attr," isn't."))}}},{key:"_addErrorMessage",value:function(){var e=o.I18n[o.Env.loco.getLocale()].errors.messages.vulgarity;this.obj.addErrorMessage(e,{for:this.attr})}},{key:"_getVulgarWord",value:function(){switch(o.Env.loco.getLocale()){case"pl":return"kurwa";case"en":return"fuck"}}}])&&So(n.prototype,r),i&&So(n,i),t}();To="Vulgarity",(Co="identity")in(Io=Ao)?Object.defineProperty(Io,Co,{value:To,enumerable:!0,configurable:!0,writable:!0}):Io[Co]=To;var xo=Ao;Object.assign(o.Validators,{Vulgarity:xo}),o.I18n.pl={variants:{few:function(e){var t=parseInt(o.Utils.String.last(String(e)));-1!==[2,3,4].indexOf(t)&&(2!==String(e).length||String(e)[0])}},models:{},attributes:{},ui:{form:{sending:"Wysyam...",success:"Sukces",errors:{connection:"Bd z poczeniem",invalid_data:"Nieprawidowe dane"}}},date:{formats:{default:"%d-%m-%Y",short:"%d %b",long:"%B %d, %Y"},day_names:["niedziela","poniedziaek","wtorek","roda","czwartek","pitek","sobota"],abbr_day_names:["nie","pon","wto","ro","czw","pi","sob"],month_names:["stycze","luty","marzec","kwiecie","maj","czerwiec","lipiec","sierpie","wrzesie","padziernik","listopad","grudzie"],abbr_month_names:["sty","lut","mar","kwi","maj","cze","lip","sie","wrz","pa","lis","gru"]},errors:{messages:{accepted:"musi zosta zaakceptowane",blank:"nie moe by puste",confirmation:"nie zgadza si z polem %{attribute}",empty:"nie moe by puste",equal_to:"musi by rwne %{count}",even:"musi by parzyste",exclusion:"jest zarezerwowane",greater_than:"musi by wiksze od %{count}",greater_than_or_equal_to:"musi by wiksze lub rwne %{count}",inclusion:"nie znajduje si na licie dopuszczalnych wartoci",invalid:"jest nieprawidowe",less_than:"musi by mniejsze od %{count}",less_than_or_equal_to:"musi by mniejsze lub rwne %{count}",not_a_number:"nie jest liczb",not_an_integer:"musi by liczb cakowit",odd:"musi by nieparzyste",present:"musi by puste",too_long:{few:"jest za dugie (maksymalnie %{count} znaki)",many:"jest za dugie (maksymalnie %{count} znakw)",one:"jest za dugie (maksymalnie jeden znak)",other:"jest za dugie (maksymalnie %{count} znakw)"},too_short:{few:"jest za krtkie (przynajmniej %{count} znaki)",many:"jest za krtkie (przynajmniej %{count} znakw)",one:"jest za krtkie (przynajmniej jeden znak)",other:"jest za krtkie (przynajmniej %{count} znakw)"},wrong_length:{few:"ma nieprawidow dugo (powinna wynosi %{count} znaki)",many:"ma nieprawidow dugo (powinna wynosi %{count} znakw)",one:"ma nieprawidow dugo (powinna wynosi jeden znak)",other:"ma nieprawidow dugo (powinna wynosi %{count} znakw)"},other_than:"musi by inna ni %{count}"}}},o.I18n.pl.models.User="Uytkownik",o.I18n.pl.attributes.User={password:"Haso",passwordConfirmation:"Powtrz haso"},o.I18n.en.errors.messages.vulgarity="contains strong language.",o.I18n.pl.errors.messages.vulgarity="zawiera mocny jzyk.",Object.assign(o.Controllers,{Admin:lr,Main:co,User:Tt}),Object.assign(ke,{Comment:te}),Object.assign(pt,{Member:We}),Object.assign(o.Models,{Article:ke,Room:pt,User:Ze}),window.test={Channels:o.Channels,Env:o.Env}}});
//# sourceMappingURL=application.js.map