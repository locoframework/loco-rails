!function(e){function t(t){for(var r,a,c=t[0],u=t[1],s=t[2],f=0,p=[];f<c.length;f++)a=c[f],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&p.push(o[a][0]),o[a]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(e[r]=u[r]);for(l&&l(t);p.length;)p.shift()();return i.push.apply(i,s||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,c=1;c<n.length;c++){var u=n[c];0!==o[u]&&(r=!1)}r&&(i.splice(t--,1),e=a(a.s=n[0]))}return e}var r={},o={0:0},i=[];function a(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=r,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="";var c=window.webpackJsonp=window.webpackJsonp||[],u=c.push.bind(c);c.push=t,c=c.slice();for(var s=0;s<c.length;s++)t(c[s]);var l=u;i.push([158,1]),n()}({115:function(e,t,n){},116:function(e,t,n){},158:function(e,t,n){"use strict";n.r(t);n(115),n(116);var r=n(112);n.n(r).a.start();var o=n(1),i=n(113);n(5),n(6),n(7),n(4),n(35),n(10),n(11),n(2),n(8),n(9);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return c(this,t),(e=s(this,l(t).call(this,n))).notice=n.notice,e.alert=n.alert,e.warning=n.warning,e.hide=n.hide,e}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(t,e),n=t,(r=[{key:"setNotice",value:function(e){this.notice=e}},{key:"setAlert",value:function(e){this.alert=e}},{key:"setWarning",value:function(e){this.warning=e}},{key:"render",value:function(){var e=document.querySelector(".flash");e.classList.remove("notice"),e.classList.remove("alert"),e.classList.remove("warning"),null!=this.notice?(e.classList.add("notice"),document.querySelector(".flash p").textContent=this.notice):null!=this.alert?(e.classList.add("alert"),document.querySelector(".flash p").textContent=this.alert):null!=this.warning&&(e.classList.add("warning"),document.querySelector(".flash p").textContent=this.warning),e.classList.remove("none"),this.hide&&this.hideAfterTime()}},{key:"hideAfterTime",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4e3;setTimeout((function(){document.querySelector(".flash").classList.add("none")}),e)}}])&&u(n.prototype,r),o&&u(n,o),t}(o.Views.Base),y={disconnectedForTooLong:function(){new p({alert:"You have been disconnected from the server for too long. Reload page!",hide:!1}).render()}},m=(n(32),n(19),n(20),n(0)),b=n.n(m),d=n(16);function h(e){return{type:"ADD_ARTICLES",articles:e}}function v(e){return{type:"SET_ARTICLES",articles:e}}function w(e,t){return{type:"UPDATE_ARTICLE",article:e,index:t}}function g(e,t){return{type:"ADD_COMMENTS",articleId:t,comments:e}}function O(e,t){return{type:"SET_COMMENTS",comments:e,articleId:t}}function _(e,t,n){return{type:"UPDATE_COMMENT",comment:e,articleId:t,index:n}}var j=n(56),S=(n(30),n(55),n(36)),E=Object(S.a)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_ARTICLES":return e.concat(t.articles);case"PREPEND_ARTICLES":return t.articles.concat(e);case"REMOVE_ARTICLE":return e.filter((function(e){return e.id!==t.id}));case"SET_ARTICLES":return t.articles;case"UPDATE_ARTICLE":e[t.index]=t.article;break;default:return e}})),k=(n(72),Object(S.a)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_COMMENTS":e[t.articleId]=e[t.articleId].concat(t.comments);break;case"REMOVE_COMMENT":if(null==e[t.articleId])return e;e[t.articleId]=e[t.articleId].filter((function(e){return e.id!==t.id}));break;case"SET_COMMENTS":e[t.articleId]=t.comments;break;case"UPDATE_COMMENT":var n=t.articleId,r=t.index;if(!r){var o=e[n].find((function(e){return e.id===t.comment.id}));r=e[n].indexOf(o)}e[n][r]=t.comment;break;default:return e}}))),P=Object(S.a)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USERS":return t.users;case"PREPEND_USERS":return t.users.concat(e);default:return e}})),x=Object(j.a)({articles:E,comments:k,users:P}),R=Object(j.b)(x);function C(e){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function A(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function I(e,t){return!t||"object"!==C(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function T(e){return(T=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function B(e,t){return(B=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var z=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return A(this,t),I(this,T(t).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&B(e,t)}(t,e),t}(o.Views.Base);n(104);function D(e){return(D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function N(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function M(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){N(i,r,o,a,c,"next",e)}function c(e){N(i,r,o,a,c,"throw",e)}a(void 0)}))}}function L(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function V(e,t){return!t||"object"!==D(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function U(e){return(U=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function F(e,t){return(F=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var W=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return L(this,t),(e=V(this,U(t).call(this,n))).article=null,e}var n,r,o,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&F(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null==this.article&&(this.connectWith(e,{receiver:"articleReceivedSignal"}),this.article=e),document.getElementById("article_title").textContent=this.article.title,document.getElementById("article_text").textContent=this.article.content;var t=document.getElementById("publish_article");t&&null!=this.article.publishedAt?t.style.display="none":t&&(t.style.display=""),this._handlePublishing(),this._updateEditLink()}},{key:"articleReceivedSignal",value:(i=M(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t,e.next="updated"===e.t0?3:"destroyed"===e.t0?8:9;break;case 3:return e.next=5,this.article.reload();case 5:return this.article.applyChanges(),this.render(),e.abrupt("break",9);case 8:window.location.href="/user/articles?message=deleted";case 9:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"_handlePublishing",value:function(){var e=this;document.getElementById("publish_article").addEventListener("click",function(){var t=M(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),n.target.textContent="Publishing...",t.prev=2,t.next=5,e.article.put("publish");case 5:document.getElementById("publish_article").outerHTML="<span>Published!</span>",t.next=13;break;case 8:t.prev=8,t.t0=t.catch(2),document.getElementById("publish_article").textContent="Publish",new p({alert:"Connection error!"}).render();case 13:case"end":return t.stop()}}),t,null,[[2,8]])})));return function(e){return t.apply(this,arguments)}}())}},{key:"_updateEditLink",value:function(){var e=document.getElementById("edit_link").getAttribute("href");document.getElementById("edit_link").setAttribute("href",e.replace("/0/","/".concat(this.article.id,"/")))}}])&&q(n.prototype,r),o&&q(n,o),t}(o.Views.Base);n(143),n(145),n(147),n(17);function H(e){return(H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function J(e,t){return!t||"object"!==H(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Y(e){return(Y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $(e,t){return($=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function G(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var K=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),J(this,Y(t).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$(e,t)}(t,e),t}(o.Models.Base);G(K,"identity","Article.Comment"),G(K,"remoteName","Comment"),G(K,"resources",{url:"/user/articles/:articleId/comments",paginate:{per:10},main:{url:"/articles/:articleId/comments",paginate:{per:5,param:"page-num"}},admin:{url:"/admin/articles/:articleId/comments",paginate:{per:5}}}),G(K,"attributes",{author:{validations:{presence:!0}},text:{validations:{presence:!0,vulgarity:!0}},articleId:{type:"Int",validations:{presence:!0},remoteName:"article_id"},createdAt:{type:"Date",remoteName:"created_at"},updatedAt:{type:"Date",remoteName:"updated_at"},emotion:{type:"Int"},pinned:{type:"Boolean"},adminRate:{type:"Int",remoteName:"admin_rate"},approved:{type:"Boolean"}});var Q=K,X=(n(33),n(3)),Z=n.n(X),ee=function(e,t){return e.comments[t]};n(106),n(107),n(108),n(109);function te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?te(n,!0).forEach((function(t){re(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):te(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function re(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function oe(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function ie(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function ae(e){var t,n=e.comment,r=e.isAdmin,i=void 0!==r&&r,a=ie(Object(m.useState)(!1),2),c=a[0],u=a[1],s=new o.Services.Date(n.createdAt).strftime("%d %b %y"),l=function(){var e,t=(e=regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),u(!0),n.approved=!0,e.next=5,n.updateAttribute("approved");case 5:if(e.sent.ok){e.next=8;break}return e.abrupt("return");case 8:R.dispatch(_(new Q(ne({},n,{approved:!0})),n.articleId));case 9:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){oe(i,r,o,a,c,"next",e)}function c(e){oe(i,r,o,a,c,"throw",e)}a(void 0)}))});return function(e){return t.apply(this,arguments)}}();return b.a.createElement("p",{id:"comment_".concat(n.id)},b.a.createElement("b",null,n.author)," on ",b.a.createElement("i",null,s),i?(t=n.approved?b.a.createElement(b.a.Fragment,null,b.a.createElement("span",null,"approved")," |"," "):c?b.a.createElement(b.a.Fragment,null,b.a.createElement("span",null,"approving...")," |"," "):b.a.createElement(b.a.Fragment,null,b.a.createElement("a",{href:"/user/articles/".concat(n.articleId,"/comments/").concat(n.id,"/approve"),className:"approve",onClick:l},"approve")," ","|"," "),b.a.createElement(b.a.Fragment,null," ","(",t,b.a.createElement("a",{href:"/user/articles/".concat(n.articleId,"/comments/").concat(n.id,"/edit")},"edit")," ","|"," ",b.a.createElement("a",{href:"/user/articles/".concat(n.articleId,"/comments/").concat(n.id),"data-method":"delete","data-confirm":"Are you sure?"},"delete"),")")):"",b.a.createElement("br",null),n.text)}ae.propTypes={comment:Z.a.instanceOf(Q).isRequired,isAdmin:Z.a.bool};var ce=ae;function ue(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function se(e){var t=e.articleId,n=e.isAdmin||!1,r=ue(Object(m.useState)(e.comments),2),o=r[0],i=r[1];if(Object(m.useEffect)((function(){var e=R.subscribe((function(){return i(ee(R.getState(),t))}));return function(){e()}})),0===o.length)return b.a.createElement("p",null,"No comments.");var a=o.map((function(e){return b.a.createElement(ce,{key:e.id,comment:e,isAdmin:n})}));return b.a.createElement(b.a.Fragment,null,a)}se.propTypes={articleId:Z.a.number.isRequired,isAdmin:Z.a.bool,comments:Z.a.arrayOf(Z.a.instanceOf(Q)).isRequired};var le=se;function fe(e){return(fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function ye(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function me(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){ye(i,r,o,a,c,"next",e)}function c(e){ye(i,r,o,a,c,"throw",e)}a(void 0)}))}}function be(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function de(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function he(e,t){return!t||"object"!==fe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ve(e){return(ve=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function we(e,t){return(we=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ge=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return be(this,t),(e=he(this,ve(t).call(this,n))).article=null,e.form=null,e.changes=null,e}var n,r,i,a,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&we(e,t)}(t,e),n=t,(r=[{key:"render",value:function(e){R.dispatch(h([e])),this.article=e,this.connectWith(this.article),this._handleApplyingChanges(),this.form=new o.UI.Form({for:this.article}),this.form.render()}},{key:"renderComments",value:(c=me(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Q.all({articleId:t});case 2:n=e.sent,R.dispatch(O(n.resources,t)),Object(d.render)(b.a.createElement(le,{articleId:t,comments:n.resources,isAdmin:!0}),document.getElementById("comments"));case 5:case"end":return e.stop()}}),e)}))),function(e){return c.apply(this,arguments)})},{key:"receivedSignal",value:(a=me(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t,e.next="updating"===e.t0?3:"updated"===e.t0?5:"destroyed"===e.t0?10:11;break;case 3:return document.querySelector("h1").getAttribute("data-mark")!==n.mark&&new p({warning:"Uuups someone else started editing this article."}).render(),e.abrupt("break",11);case 5:return e.next=7,this.article.reload();case 7:return this.changes=this.article.changes(),this._displayChanges(),e.abrupt("break",11);case 10:window.location.href="/user/articles?message=deleted";case 11:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"_displayChanges",value:function(){for(var e=0,t=Object.entries(this.changes);e<t.length;e++){var n=pe(t[e],1)[0],r=document.querySelector("a.apply_changes[data-for=".concat(this.article.getAttrRemoteName(n),"]"));r&&r.classList.remove("none")}}},{key:"_handleApplyingChanges",value:function(){for(var e=this,t=0,n=Array.from(document.querySelectorAll("a.apply_changes"));t<n.length;t++)n[t].addEventListener("click",(function(t){t.preventDefault();var n=e.article.getAttrName(t.target.getAttribute("data-for"));e.article[n]=e.changes[n].is,e.form.fill(n),t.target.classList.add("none")}))}}])&&de(n.prototype,r),i&&de(n,i),t}(o.Views.Base);function Oe(e){return(Oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function je(e,t){return!t||"object"!==Oe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Se(e){return(Se=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ee(e,t){return(Ee=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ke(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Pe=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=je(this,Se(t).call(this,e))).published=null!=n.publishedAt,n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ee(e,t)}(t,e),n=t,(r=[{key:"vulgarityLevel",value:function(){(null!=this.title&&/fuck/i.exec(this.title)||null!=this.content&&/fuck/i.exec(this.content))&&this.addErrorMessage("Article contains strong language.",{for:"base"})}},{key:"setDefaultValuesForAdminReview",value:function(){this.adminRate=null==this.adminRate?3:this.adminRate,this.categoryId=null==this.categoryId?6:this.categoryId,this.adminReviewStartedAt=Date.now()}}])&&_e(n.prototype,r),o&&_e(n,o),t}(o.Models.Base);ke(Pe,"identity","Article"),ke(Pe,"resources",{url:"/user/articles",paginate:{per:5},main:{url:"/articles",paginate:{per:3}},admin:{url:"/admin/articles",paginate:{per:4}}}),ke(Pe,"attributes",{title:{validations:{presence:!0,length:{within:[3,255]}}},content:{validations:{presence:!0,length:{minimum:100}},remoteName:"text"},createdAt:{type:"Date",remoteName:"created_at"},updatedAt:{type:"Date",remoteName:"updated_at"},commentsCount:{type:"Int",remoteName:"comments_count"},publishedAt:{type:"Date",remoteName:"published_at"},published:{},adminReview:{remoteName:"admin_review"},adminRate:{type:"Int",remoteName:"admin_rate"},categoryId:{type:"Int",remoteName:"category_id"},adminReviewStartedAt:{remoteName:"admin_review_started_at"}}),ke(Pe,"validate",["vulgarityLevel"]);var xe=Pe;function Re(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function Ce(e){var t=e.article,n=e.onArticleDestroyed,r=function(){var e,r=(e=regeneratorRuntime.mark((function e(r){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.preventDefault(),confirm("Are you sure?")){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,t.delete(null);case 5:(o=e.sent).success&&R.dispatch({type:"REMOVE_ARTICLE",id:o.id}),n(o);case 8:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Re(i,r,o,a,c,"next",e)}function c(e){Re(i,r,o,a,c,"throw",e)}a(void 0)}))});return function(e){return r.apply(this,arguments)}}();return b.a.createElement("tr",{id:"article_".concat(t.id)},b.a.createElement("td",null,t.title),b.a.createElement("td",null,t.content),b.a.createElement("td",{className:"comments_quantity"},t.commentsCount),b.a.createElement("td",{className:"published"},t.publishedAt?"yes":"no"),b.a.createElement("td",null,b.a.createElement("a",{href:"/user/articles/".concat(t.id)},"Show")," |",b.a.createElement("a",{href:"/user/articles/".concat(t.id,"/edit")},"Edit")," |",b.a.createElement("a",{href:"/user/articles/".concat(t.id),className:"delete_article",onClick:r},"Delete")))}Ce.propTypes={article:Z.a.instanceOf(xe).isRequired,onArticleDestroyed:Z.a.func.isRequired};var Ae=Ce;function Ie(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Te(e){var t=Ie(Object(m.useState)(e.articles),2),n=t[0],r=t[1];Object(m.useEffect)((function(){var e=R.subscribe((function(){return r(R.getState().articles)}));return function(){e()}}));var o=n.map((function(t){return b.a.createElement(Ae,{key:t.id,article:t,onArticleDestroyed:e.onArticleDestroyed})}));return b.a.createElement(b.a.Fragment,null,o)}Te.propTypes={articles:Z.a.arrayOf(Z.a.instanceOf(xe)).isRequired,onArticleDestroyed:Z.a.func.isRequired};var Be=Te;function ze(e){return(ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function De(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function Ne(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){De(i,r,o,a,c,"next",e)}function c(e){De(i,r,o,a,c,"throw",e)}a(void 0)}))}}function Me(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Le(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qe(e,t){return!t||"object"!==ze(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ve(e){return(Ve=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ue(e,t){return(Ue=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Fe=function(e){function t(){return Me(this,t),qe(this,Ve(t).apply(this,arguments))}var n,r,o,i,a,c,u,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ue(e,t)}(t,e),n=t,(r=[{key:"initialize",value:function(){this.layout=new z}},{key:"onArticleDestroyed",value:function(e){var t=new p;e.success?t.setNotice(e.notice):t.setAlert(e.alert),t.render()}},{key:"index",value:(s=Ne(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"deleted"===this.params.message&&new p({alert:"Article has been deleted."}).render(),e.next=3,xe.get("all");case 3:t=e.sent,R.dispatch(v(t.resources)),Object(d.render)(b.a.createElement(Be,{articles:t.resources,onArticleDestroyed:this.onArticleDestroyed}),document.getElementById("article_list"));case 6:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"show",value:(u=Ne(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._renderArticle(),this._renderComments();case 2:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"new",value:function(){(new ge).render(new xe)}},{key:"edit",value:(c=Ne(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=new ge).renderComments(this.params.id),e.next=4,xe.find(this.params.id);case 4:n=e.sent,t.render(n);case 6:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"_renderArticle",value:(a=Ne(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,xe.find(this.params.id);case 2:t=e.sent,R.dispatch(v([t])),(new W).render(t);case 5:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"_renderComments",value:(i=Ne(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Q.all({articleId:this.params.id});case 2:t=e.sent,R.dispatch(O(t.resources,this.params.id)),Object(d.render)(b.a.createElement(le,{articleId:this.params.id,comments:t.resources}),document.getElementById("comments"));case 5:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})}])&&Le(n.prototype,r),o&&Le(n,o),t}(o.Controllers.Base);function We(e){return(We="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function He(e,t){return!t||"object"!==We(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Je(e){return(Je=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ye(e,t){return(Ye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function $e(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ge=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),He(this,Je(t).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ye(e,t)}(t,e),t}(o.Models.Base);$e(Ge,"identity","Room.Member"),$e(Ge,"resources",{url:"/user/rooms/:roomId/members",paginate:{per:100}}),$e(Ge,"attributes",{}),$e(Ge,"validate",[]);var Ke=Ge;n(152),n(110);function Qe(e){return(Qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xe(e,t){return!t||"object"!==Qe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ze(e){return(Ze=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function et(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tt(e,t,n){return t&&et(e.prototype,t),n&&et(e,n),e}function nt(e,t){return(nt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function rt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ot=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Xe(this,Ze(t).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nt(e,t)}(t,e),tt(t,null,[{key:"receivedSignal",value:function(e){console.log("User.receivedSignal: ".concat(e))}}]),tt(t,[{key:"receivedSignal",value:function(e){console.log("User#receivedSignal: ".concat(e))}}]),t}(o.Models.Base);rt(ot,"identity","User"),rt(ot,"resources",{url:"/users",admin:{url:"/admin/users"}}),rt(ot,"paginate",{per:10}),rt(ot,"attributes",{email:{validations:{presence:!0,format:{with:/^([^@\s]+)@((?:[-a-z0-9]+\.)+[a-z]{2,})$/i}}},username:{validations:{presence:!0,format:{with:/^[a-z][a-z0-9_-]*$/i}}},password:{validations:{presence:{on:"create"},confirmation:!0}},passwordConfirmation:{remoteName:"password_confirmation"},confirmed:{},createdAt:{type:"Date",remoteName:"created_at"},updatedAt:{type:"Date",remoteName:"updated_at"}});var it=ot;function at(e){return(at="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ct(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ut(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function st(e,t){return!t||"object"!==at(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function lt(e){return(lt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ft(e,t){return(ft=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var pt=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return ct(this,t),st(this,lt(t).call(this,e))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ft(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){this.connectWith(it)}},{key:"receivedSignal",value:function(e,t){switch(e){case"Room member_joined":this._memberJoined(t.room_id);break;case"Room member_left":this._memberLeft(t.room_id);break;case"Room created":var n=this._renderRoom(t.room);document.getElementById("rooms_list").insertAdjacentHTML("beforeend",n);break;case"Room destroyed":var r=document.getElementById("room_".concat(t.room_id));r.parentNode.removeChild(r)}}},{key:"_memberJoined",value:function(e){var t=this._membersNode(e);t.textContent=parseInt(t.text())+1}},{key:"_memberLeft",value:function(e){var t=this._membersNode(e);t.textContent=parseInt(t.text())-1}},{key:"_membersNode",value:function(e){document.querySelector("#room_".concat(e," td.members"))}},{key:"_renderRoom",value:function(e){"\n    <tr id='room_".concat(e.id,"'>\n      <td>").concat(e.name,"</td>\n      <td class='members'>0</td>\n      <td>\n        <a rel='nofollow' data-method='patch' href='/user/rooms/").concat(e.id,"/join'>Join</a> |\n        <a data-confirm='R U sure?' rel='nofollow' data-method='delete'\n          href='/user/rooms/").concat(e.id,"'>Destroy</a>\n      </td>\n    </tr>\n    ")}}])&&ut(n.prototype,r),o&&ut(n,o),t}(o.Views.Base);function yt(e){return(yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mt(e,t){return!t||"object"!==yt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function bt(e){return(bt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function dt(e,t){return(dt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ht(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var vt=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),mt(this,bt(t).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dt(e,t)}(t,e),t}(o.Models.Base);ht(vt,"identity","Room"),ht(vt,"resources",{}),ht(vt,"attributes",{}),ht(vt,"validate",[]);var wt=vt;function gt(e){return(gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ot(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function jt(e,t){return!t||"object"!==gt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function St(e){return(St=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Et(e,t){return(Et=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var kt=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Ot(this,t),(e=jt(this,St(t).call(this,n))).roomId=n.id,e}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Et(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){this.connectWith(wt),this._handleSendingMessage()}},{key:"renderMembers",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=e[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;this._memberJoined(a)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}}},{key:"receivedMessage",value:function(e,t){var n="<p><b>".concat(t,"</b>: ").concat(e,"</p>");document.getElementById("messages").insertAdjacentHTML("beforeend",n)}},{key:"receivedSignal",value:function(e,t){switch(e){case"Room member_joined":if(t.room_id!==this.roomId)return;this._memberJoined(t.member);break;case"Room member_left":if(t.room_id!==this.roomId)return;this._memberLeft(t.member)}}},{key:"_handleSendingMessage",value:function(){var e=this;document.querySelector("[data-behavior~=room-speaker]").addEventListener("keypress",(function(t){13===t.keyCode&&(t.preventDefault(),o.Env.loco.emit({signal:"message",txt:t.target.value,room_id:e.roomId}),t.target.value="")}))}},{key:"_memberJoined",value:function(e){var t="<li id='user_".concat(e.id,"'>").concat(e.username,"</li>");document.getElementById("members").insertAdjacentHTML("beforeend",t)}},{key:"_memberLeft",value:function(e){var t=document.querySelector("#members li#user_".concat(e.id));t.parentNode.removeChild(t)}}])&&_t(n.prototype,r),i&&_t(n,i),t}(o.Views.Base);function Pt(e){return(Pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xt(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function Rt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ct(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function At(e,t){return!t||"object"!==Pt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function It(e){return(It=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Tt(e,t){return(Tt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Bt=function(e){function t(){return Rt(this,t),At(this,It(t).apply(this,arguments))}var n,r,o,i,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Tt(e,t)}(t,e),n=t,(r=[{key:"initialize",value:function(){}},{key:"index",value:function(){(new pt).render()}},{key:"show",value:(i=regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new kt({id:this.params.id}),this.setView("show",t),t.render(),e.next=5,Ke.all({roomId:this.params.id});case 5:n=e.sent,t.renderMembers(n.resources);case 7:case"end":return e.stop()}}),e,this)})),a=function(){var e=this,t=arguments;return new Promise((function(n,r){var o=i.apply(e,t);function a(e){xt(o,n,r,a,c,"next",e)}function c(e){xt(o,n,r,a,c,"throw",e)}a(void 0)}))},function(){return a.apply(this,arguments)})}])&&Ct(n.prototype,r),o&&Ct(n,o),t}(o.Controllers.Base);function zt(e){return(zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Dt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Nt(e,t){return!t||"object"!==zt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Mt(e){return(Mt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Lt(e,t){return(Lt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.assign(o.Controllers.Base.prototype,y);var qt=function(e){function t(){return Dt(this,t),Nt(this,Mt(t).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Lt(e,t)}(t,e),t}(o.Controllers.Base);Object.assign(qt,{Articles:Fe,Rooms:Bt});var Vt=qt;function Ut(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ft=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"receivedSignal",value:function(e){switch(e.signal){case"ping":this._pingSignal();break;case"message":this._messageSignal(e)}}},{key:"_pingSignal",value:function(){o.Env.namespaceController.constructor===Vt&&alert("Ping!")}},{key:"_messageSignal",value:function(e){var t=this._getRoomView();t&&t.receivedMessage(e.message,e.author)}},{key:"_getRoomView",value:function(){return o.Env.namespaceController.constructor===Vt&&o.Env.controller.constructor===Bt&&"show"===o.Env.action&&o.Env.controller.getView("show")}}])&&Ut(t.prototype,n),r&&Ut(t,r),e}(),Wt=function(e){return function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=t[e];r.parentId&&(o=o[r.parentId]);var i=o.find((function(e){return e.id===n}));if(!i)return[null,null];var a=o.indexOf(i);return[i,a]}},Ht=Wt("articles"),Jt=Wt("comments");function Yt(e){var t=e.comment,n=new o.Services.Date(t.createdAt).strftime("%d %b %y");return b.a.createElement("p",{id:"comment_".concat(t.id)},b.a.createElement("b",null,t.author)," on ",b.a.createElement("i",null,n)," (",b.a.createElement("a",{href:"/admin/articles/".concat(t.articleId,"/comments/").concat(t.id,"/edit")},"edit"),")",b.a.createElement("br",null),t.text)}Yt.propTypes={comment:Z.a.instanceOf(Q).isRequired};var $t=Yt;function Gt(e){var t=e.comments;return 0===t.length?b.a.createElement("p",null,"No comments"):b.a.createElement(b.a.Fragment,null,t.map((function(e){return b.a.createElement($t,{comment:e,key:e.id})})))}Gt.propTypes={comments:Z.a.arrayOf(Z.a.instanceOf(Q)).isRequired};var Kt=Gt;function Qt(e){return(Qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xt(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function Zt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function en(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tn(e,t){return!t||"object"!==Qt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function nn(e){return(nn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function rn(e,t){return(rn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var on=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Zt(this,t),(e=tn(this,nn(t).call(this,n))).article=null,e}var n,r,o,i,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rn(e,t)}(t,e),n=t,(r=[{key:"receivedSignal",value:(i=regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t,e.next="updated"===e.t0?3:7;break;case 3:return e.next=5,this.article.reload();case 5:this.article.applyChanges(),this._renderArticle();case 7:case"end":return e.stop()}}),e,this)})),a=function(){var e=this,t=arguments;return new Promise((function(n,r){var o=i.apply(e,t);function a(e){Xt(o,n,r,a,c,"next",e)}function c(e){Xt(o,n,r,a,c,"throw",e)}a(void 0)}))},function(e){return a.apply(this,arguments)})},{key:"render",value:function(e){this.article=e,this.connectWith(e),this._renderArticle()}},{key:"renderComments",value:function(e){Object(d.render)(b.a.createElement(Kt,{comments:e}),document.getElementById("comments"))}},{key:"_renderArticle",value:function(){document.getElementById("article_author").textContent=this.article.author,document.getElementById("article_title").textContent=this.article.title,document.getElementById("article_text").textContent=this.article.content}}])&&en(n.prototype,r),o&&en(n,o),t}(o.Views.Base);function an(e){return(an="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function un(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function sn(e,t){return!t||"object"!==an(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ln(e){return(ln=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fn(e,t){return(fn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var pn=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return cn(this,t),sn(this,ln(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fn(e,t)}(t,e),n=t,(r=[{key:"render",value:function(e){e.setDefaultValuesForAdminReview(),new o.UI.Form({id:"edit_article_form",for:e}).render()}}])&&un(n.prototype,r),i&&un(n,i),t}(o.Views.Base);function yn(e){var t=e.article,n=new o.Services.Date(t.publishedAt).toString("short");return b.a.createElement("article",{id:"article_".concat(t.id)},b.a.createElement("h2",null,t.title),b.a.createElement("p",null,b.a.createElement("i",null,t.author," wrote this on ",n," /"," ",b.a.createElement("span",{className:"comments_quantity"},t.commentsCount," comment",1===t.commentsCount?"":"s"))),b.a.createElement("p",null,t.content),b.a.createElement("p",null,b.a.createElement("a",{href:"/admin/articles/".concat(t.id,"/edit")},"Review")))}yn.propTypes={article:Z.a.instanceOf(xe).isRequired};var mn=yn;function bn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function dn(e){var t=bn(Object(m.useState)(e.articles),2),n=t[0],r=t[1];Object(m.useEffect)((function(){var e=R.subscribe((function(){return r(R.getState().articles)}));return function(){e()}}));var o=n.map((function(e){return b.a.createElement(mn,{key:e.id,article:e})}));return b.a.createElement(b.a.Fragment,null,o)}dn.propTypes={articles:Z.a.arrayOf(Z.a.instanceOf(xe)).isRequired};var hn=dn;function vn(e){return(vn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wn(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function gn(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){wn(i,r,o,a,c,"next",e)}function c(e){wn(i,r,o,a,c,"throw",e)}a(void 0)}))}}function On(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function jn(e,t){return!t||"object"!==vn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Sn(e){return(Sn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function En(e,t){return(En=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var kn=function(e){function t(){return On(this,t),jn(this,Sn(t).apply(this,arguments))}var n,r,o,i,a,c,u;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&En(e,t)}(t,e),n=t,(r=[{key:"published",value:(u=gn(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,xe.get("published");case 2:t=e.sent,R.dispatch(v(t.resources)),Object(d.render)(b.a.createElement(hn,{articles:t.resources}),document.getElementById("articles"));case 5:case"end":return e.stop()}}),e)}))),function(){return u.apply(this,arguments)})},{key:"edit",value:(c=gn(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=new on,this._renderArticle(t),this._renderComment(t);case 3:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"_renderArticle",value:(a=gn(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,xe.find(this.params.id);case 2:n=e.sent,t.render(n),(new pn).render(n);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"_renderComment",value:(i=gn(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Q.all({articleId:this.params.id});case 2:n=e.sent,t.renderComments(n.resources);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})}])&&_n(n.prototype,r),o&&_n(n,o),t}(o.Controllers.Base);function Pn(e){return(Pn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Rn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Cn(e,t){return!t||"object"!==Pn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function An(e){return(An=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function In(e,t){return(In=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Tn=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return xn(this,t),Cn(this,An(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&In(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new o.UI.Form({for:new Q({id:e.commentId,resource:"admin"}),id:"edit_comment_".concat(e.commentId),initObj:!0});t.render(),o.Env.test={commentFormObj:t.getObj()}}}])&&Rn(n.prototype,r),i&&Rn(n,i),t}(o.Views.Base);function Bn(e){return(Bn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Dn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Nn(e,t){return!t||"object"!==Bn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Mn(e){return(Mn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ln(e,t){return(Ln=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var qn=function(e){function t(){return zn(this,t),Nn(this,Mn(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ln(e,t)}(t,e),n=t,(r=[{key:"edit",value:function(){(new Tn).render({commentId:this.params.id})}}])&&Dn(n.prototype,r),o&&Dn(n,o),t}(o.Controllers.Base);function Vn(e){return(Vn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Un(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Fn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Wn(e,t){return!t||"object"!==Vn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Hn(e){return(Hn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Jn(e,t){return(Jn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Yn=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Un(this,t),Wn(this,Hn(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Jn(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){new o.UI.Form({id:"sign_in_admin",delegator:this,callbackSuccess:"_signedIn"}).render()}},{key:"_signedIn",value:function(){window.location.href="/admin"}}])&&Fn(n.prototype,r),i&&Fn(n,i),t}(o.Views.Base);function $n(e){return($n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Gn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Kn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Qn(e,t){return!t||"object"!==$n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Xn(e){return(Xn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Zn(e,t){return(Zn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var er=function(e){function t(){return Gn(this,t),Qn(this,Xn(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Zn(e,t)}(t,e),n=t,(r=[{key:"new",value:function(){(new Yn).render()}}])&&Kn(n.prototype,r),o&&Kn(n,o),t}(o.Controllers.Base),tr=function(e){var t=e.user;return b.a.createElement("tr",{id:"user_".concat(t.id)},b.a.createElement("td",null,t.email),b.a.createElement("td",null,t.username),b.a.createElement("td",{className:"confirmed"},t.confirmed?"Yes":"No"),b.a.createElement("td",null,b.a.createElement("a",{href:"/admin/users/".concat(t.id)},"Show")," |"," ",b.a.createElement("a",{href:"/admin/users/".concat(t.id,"/edit")},"Edit")," |"," ",b.a.createElement("a",{href:"/admin/users/".concat(t.id),"data-method":"delete","data-confirm":"Are you sure?"},"Delete")," ","|"," ",b.a.createElement("a",{href:"#",onClick:function(e){return function(e,t){e.preventDefault(),o.Env.loco.emit({signal:"ping",user_id:t})}(e,t.id)}},"Ping")))};tr.propTypes={user:Z.a.instanceOf(it).isRequired};var nr=tr;function rr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function or(e){var t=rr(Object(m.useState)(e.users),2),n=t[0],r=t[1];Object(m.useEffect)((function(){var e=R.subscribe((function(){return r(R.getState().users)}));return function(){e()}}));var o=n.map((function(e){return b.a.createElement(nr,{key:"user_".concat(e.id),user:e})}));return b.a.createElement(b.a.Fragment,null,o)}or.propTypes={users:Z.a.arrayOf(Z.a.instanceOf(it)).isRequired};var ir=or;function ar(e){return(ar="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ur(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function sr(e,t){return!t||"object"!==ar(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function lr(e){return(lr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fr(e,t){return(fr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var pr=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return cr(this,t),(e=sr(this,lr(t).call(this,n))).user=n.user,e}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fr(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){document.getElementById("user_email").textContent=this.user.email,document.getElementById("user_username").textContent=this.user.username,document.getElementById("user_confirmed").textContent=this.user.confirmed?"Yes":"No",this._updateEditLink()}},{key:"_updateEditLink",value:function(){var e=document.getElementById("edit_link"),t=e.getAttribute("href");e.setAttribute("href",t.replace("/0/","/#{@user.id}/"))}}])&&ur(n.prototype,r),o&&ur(n,o),t}(o.Views.Base);function yr(e){return(yr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function br(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function dr(e,t){return!t||"object"!==yr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function hr(e){return(hr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function vr(e,t){return(vr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var wr=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return mr(this,t),(e=dr(this,hr(t).call(this,n))).user=n.user,e}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vr(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){new o.UI.Form({for:this.user,initObj:!0,id:"admin_user_form"}).render()}}])&&br(n.prototype,r),i&&br(n,i),t}(o.Views.Base);function gr(e){return(gr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Or(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function _r(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Or(i,r,o,a,c,"next",e)}function c(e){Or(i,r,o,a,c,"throw",e)}a(void 0)}))}}function jr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Sr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Er(e,t){return!t||"object"!==gr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function kr(e){return(kr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Pr(e,t){return(Pr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var xr=function(e){function t(){return jr(this,t),Er(this,kr(t).apply(this,arguments))}var n,r,o,i,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pr(e,t)}(t,e),n=t,(r=[{key:"index",value:(a=_r(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,it.get("all");case 2:t=e.sent,R.dispatch({type:"PREPEND_USERS",users:t.resources}),Object(d.render)(b.a.createElement(ir,{users:t.resources}),document.querySelector("table tbody"));case 5:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)})},{key:"show",value:(i=_r(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,it.find(this.params.id);case 2:t=e.sent,new pr({user:t}).render();case 4:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"edit",value:function(){new wr({user:new it({id:this.params.id})}).render()}}])&&Sr(n.prototype,r),o&&Sr(n,o),t}(o.Controllers.Base);function Rr(e){return(Rr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Cr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ar(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ir(e,t){return!t||"object"!==Rr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Tr(e){return(Tr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Br(e,t){return(Br=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.assign(o.Controllers.Base.prototype,y);var zr=function(e){function t(){return Cr(this,t),Ir(this,Tr(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Br(e,t)}(t,e),n=t,(r=[{key:"initialize",value:function(){this.setScope("admin")}}])&&Ar(n.prototype,r),o&&Ar(n,o),t}(o.Controllers.Base);Object.assign(zr,{Articles:kn,Comments:qn,Sessions:er,Users:xr});var Dr=zr;function Nr(e){var t=e.comment,n=new o.Services.Date(t.createdAt).strftime("%d %b %y");return b.a.createElement("p",{id:"comment_".concat(t.id)},b.a.createElement("b",null,t.author)," on ",b.a.createElement("i",null,n)," wrote:",b.a.createElement("br",null),t.text)}Nr.propTypes={comment:Z.a.instanceOf(Q).isRequired};var Mr=Nr;function Lr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function qr(e){var t=e.articleId,n=Lr(Object(m.useState)(e.comments),2),r=n[0],o=n[1];Object(m.useEffect)((function(){var e=R.subscribe((function(){o(ee(R.getState(),t))}));return function(){e()}}));var i=r.map((function(e){return b.a.createElement(Mr,{key:e.id,comment:e})}));return 0===r.length?b.a.createElement("p",{id:"no_comments"},"No comments."):b.a.createElement(b.a.Fragment,null,i)}qr.propTypes={articleId:Z.a.number.isRequired,comments:Z.a.arrayOf(Z.a.instanceOf(Q)).isRequired};var Vr=qr;function Ur(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Fr(e){var t=Ur(Object(m.useState)(e.comments),2),n=t[0],r=t[1];return Object(m.useEffect)((function(){var t=R.subscribe((function(){r(ee(R.getState(),e.articleId))}));return function(){t()}})),b.a.createElement(b.a.Fragment,null,"".concat(n.length," comment").concat(1===n.length?"":"s"))}Fr.propTypes={articleId:Z.a.number.isRequired,comments:Z.a.arrayOf(Z.a.instanceOf(Q)).isRequired};var Wr=Fr;function Hr(e){return(Hr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Jr(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function Yr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Gr(e,t){return!t||"object"!==Hr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Kr(e){return(Kr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Qr(e,t){return(Qr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Xr=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Yr(this,t),(e=Gr(this,Kr(t).call(this,n))).article=null,e.newComment=n.comment,e}var n,r,i,a,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qr(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){new o.UI.Form({for:this.newComment,initObj:!0,id:"new_comment"}).render()}},{key:"renderArticle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.article||(this.article=e,this.connectWith(this.article,{receiver:"_articleReceivedSignal"})),document.getElementById("title").textContent=this.article.title,document.getElementById("author").textContent=this.article.author;var t=new o.Services.Date(this.article.publishedAt);document.getElementById("pub_date").textContent=t.toString("short");var n=document.getElementById("text");n.innerHTML="";var r=(new o.Helpers.Text).simpleFormat(this.article.content);n.insertAdjacentHTML("beforeend",r)}},{key:"_articleReceivedSignal",value:(a=regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t,e.next="updating"===e.t0?3:"updated"===e.t0?7:11;break;case 3:return new p({warning:"Author is currently editing article. Be aware of possible changes."}).render(),e.abrupt("break",11);case 7:return e.next=9,this.article.reload();case 9:this.article.applyChanges(),this.renderArticle();case 11:case"end":return e.stop()}}),e,this)})),c=function(){var e=this,t=arguments;return new Promise((function(n,r){var o=a.apply(e,t);function i(e){Jr(o,n,r,i,c,"next",e)}function c(e){Jr(o,n,r,i,c,"throw",e)}i(void 0)}))},function(e){return c.apply(this,arguments)})}])&&$r(n.prototype,r),i&&$r(n,i),t}(o.Views.Base);function Zr(e){return(Zr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eo(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function to(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){eo(i,r,o,a,c,"next",e)}function c(e){eo(i,r,o,a,c,"throw",e)}a(void 0)}))}}function no(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ro(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function oo(e,t){return!t||"object"!==Zr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function io(e){return(io=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ao(e,t){return(ao=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var co=function(e){function t(){return no(this,t),oo(this,io(t).apply(this,arguments))}var n,r,o,i,a,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ao(e,t)}(t,e),n=t,(r=[{key:"show",value:(c=to(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=new Q({articleId:this.params.id}),(n=new Xr({comment:t})).render(),this._renderArticle(n),this._renderComments();case 5:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"_renderArticle",value:(a=to(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,xe.find(this.params.id);case 2:n=e.sent,R.dispatch(v([n])),t.renderArticle(n);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"_renderComments",value:(i=to(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Q.get("count",{articleId:this.params.id});case 2:return t=e.sent,e.next=5,Q.all({articleId:this.params.id,total:t.total});case 5:n=e.sent,R.dispatch(O(n,this.params.id)),Object(d.render)(b.a.createElement(Vr,{articleId:this.params.id,comments:n}),document.getElementById("comments")),Object(d.render)(b.a.createElement(Wr,{articleId:this.params.id,comments:n}),document.getElementById("comments_count"));case 9:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})}])&&ro(n.prototype,r),o&&ro(n,o),t}(o.Controllers.Base);function uo(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function so(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){uo(i,r,o,a,c,"next",e)}function c(e){uo(i,r,o,a,c,"throw",e)}a(void 0)}))}}function lo(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function fo(){var e=lo(Object(m.useState)(1),2),t=e[0],n=e[1],r=lo(Object(m.useState)(!1),2),o=r[0],i=r[1];function a(e){return c.apply(this,arguments)}function c(){return(c=so(regeneratorRuntime.mark((function e(r){var o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),n(o=t+1),a=null,e.prev=4,e.next=7,xe.get("all",{page:o});case 7:a=e.sent,e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(4),alert("Invalid URL: ".concat(e.t0)),e.abrupt("return");case 14:a.resources.length>0?R.dispatch(h(a.resources)):i(!0);case 15:case"end":return e.stop()}}),e,null,[[4,10]])})))).apply(this,arguments)}return o?b.a.createElement("span",null,"No more posts."):b.a.createElement("a",{href:"#",id:"load_more",onClick:a},"Load more")}function po(e){var t=e.article,n=new o.Services.Date(t.publishedAt).toString("short");return b.a.createElement("article",{id:"article_".concat(t.id)},b.a.createElement("h2",null,t.title),b.a.createElement("p",null,b.a.createElement("i",null,t.author," wrote this on ",n," /"," ",b.a.createElement("a",{href:"/articles/".concat(t.id,"#comments"),className:"comments_quantity"},t.commentsCount," comment",1===t.commentsCount?"":"s"))),b.a.createElement("p",null,t.content),b.a.createElement("p",null,b.a.createElement("a",{href:"/articles/".concat(t.id)},"Continued")))}po.propTypes={article:Z.a.instanceOf(xe).isRequired};var yo=po;function mo(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function bo(e){var t=mo(Object(m.useState)(e.articles),2),n=t[0],r=t[1];Object(m.useEffect)((function(){var e=R.subscribe((function(){return r(R.getState().articles)}));return function(){e()}}));var o=n.map((function(e){return b.a.createElement(yo,{key:e.id,article:e})}));return b.a.createElement(b.a.Fragment,null,o)}bo.propTypes={articles:Z.a.arrayOf(Z.a.instanceOf(xe)).isRequired};var ho=bo;function vo(e){return(vo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wo(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function go(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Oo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _o(e,t){return!t||"object"!==vo(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function jo(e){return(jo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function So(e,t){return(So=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Eo=function(e){function t(){return go(this,t),_o(this,jo(t).apply(this,arguments))}var n,r,o,i,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&So(e,t)}(t,e),n=t,(r=[{key:"index",value:(i=regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object(d.render)(b.a.createElement(fo,null),document.getElementById("load_more_wrapper")),e.next=3,xe.get("all",{page:1});case 3:t=e.sent,R.dispatch(v(t.resources)),Object(d.render)(b.a.createElement(ho,{articles:t.resources}),document.getElementById("articles"));case 6:case"end":return e.stop()}}),e)})),a=function(){var e=this,t=arguments;return new Promise((function(n,r){var o=i.apply(e,t);function a(e){wo(o,n,r,a,c,"next",e)}function c(e){wo(o,n,r,a,c,"throw",e)}a(void 0)}))},function(){return a.apply(this,arguments)})}])&&Oo(n.prototype,r),o&&Oo(n,o),t}(o.Controllers.Base);function ko(e){return(ko="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Po(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ro(e,t){return!t||"object"!==ko(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Co(e){return(Co=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ao(e,t){return(Ao=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Io=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Po(this,t),Ro(this,Co(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ao(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){new o.UI.Form({for:new it,delegator:this,callbackSuccess:"_created"}).render()}},{key:"receivedSignal",value:function(e){switch(e){case"confirming":this._confirming();break;case"confirmed":this._confirmed()}}},{key:"_created",value:function(e){this.connectWith(new it({id:e.id})),document.querySelector("form").style.display="none",document.getElementById("sign_in_paragraph").classList.remove("none"),document.getElementById("verification_info").classList.remove("none"),new p({notice:e.notice}).render()}},{key:"_confirming",value:function(){document.getElementById("verification_info").textContent=document.getElementById("verification_progress").textContent}},{key:"_confirmed",value:function(){window.location.href="/user/sessions/new?event=confirmed"}}])&&xo(n.prototype,r),i&&xo(n,i),t}(o.Views.Base);function To(e){return(To="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bo(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Do(e,t){return!t||"object"!==To(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function No(e){return(No=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Mo(e,t){return(Mo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Lo=function(e){function t(){return Bo(this,t),Do(this,No(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Mo(e,t)}(t,e),n=t,(r=[{key:"new",value:function(){(new Io).render()}}])&&zo(n.prototype,r),o&&zo(n,o),t}(o.Controllers.Base);function qo(e){return(qo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Vo(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Uo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Fo(e,t){return!t||"object"!==qo(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Wo(e){return(Wo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ho(e,t){return(Ho=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.assign(o.Controllers.Base.prototype,y);var Jo=function(e){function t(){return Vo(this,t),Fo(this,Wo(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ho(e,t)}(t,e),n=t,(r=[{key:"initialize",value:function(){this.setScope("main")}}])&&Uo(n.prototype,r),o&&Uo(n,o),t}(o.Controllers.Base);Object.assign(Jo,{Articles:co,Pages:Eo,Users:Lo});var Yo=Jo;function $o(e){return($o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Go(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ko(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Qo(e,t){return!t||"object"!==$o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Xo(e){return(Xo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Zo(e,t){return(Zo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ei(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ti(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ei(n,!0).forEach((function(t){ni(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ei(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ni(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ri(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function oi(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function ii(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){oi(i,r,o,a,c,"next",e)}function c(e){oi(i,r,o,a,c,"throw",e)}a(void 0)}))}}var ai=function(){var e=ii(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.id,o.Env.namespaceController.constructor===Vt){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,xe.find({id:n,abbr:!0});case 5:r=e.sent,R.dispatch(h([r]));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ci=function(){var e=ii(regeneratorRuntime.mark((function e(t){var n,r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.id,o.Env.namespaceController.constructor!==Dr){e.next=8;break}return e.next=4,xe.find({id:n,abbr:!0,resource:"admin"});case 4:r=e.sent,R.dispatch({type:"PREPEND_ARTICLES",articles:[r]}),e.next=12;break;case 8:return e.next=10,xe.find({id:n,abbr:!0});case 10:i=e.sent,R.dispatch(h([i]));case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ui=function(){var e=ii(regeneratorRuntime.mark((function e(t){var n,r,i,a,c,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.id,r={id:n,abbr:!0},o.Env.namespaceController.constructor===Dr&&(r.resource="admin"),i=Ht(R.getState(),n),a=ri(i,2),c=a[0],u=a[1],c){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,xe.find(r);case 8:c=e.sent,R.dispatch(w(c,u));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),si=function(e,t){var n=e.article_id,r=ri(Ht(R.getState(),n),2),o=r[0],i=r[1];if(o){var a=new xe(ti({},o,{commentsCount:o.commentsCount+t}));R.dispatch(w(a,i))}},li=function(){var e=ii(regeneratorRuntime.mark((function e(t){var n,r,i,a,c,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.article_id,r=t.id,i={articleId:n,id:r},o.Env.namespaceController.constructor===Yo&&(i.resource="main"),a=Ht(R.getState(),n),c=ri(a,1),c[0]){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,Q.find(i);case 8:u=e.sent,R.dispatch(g([u],n));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fi=function(){var e=ii(regeneratorRuntime.mark((function e(t){var n,r,o,i,a,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.article_id,r=t.id,o=Jt(R.getState(),r,{parentId:n}),i=ri(o,2),a=i[0],c=i[1],a){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,a.reload();case 6:a.applyChanges(),R.dispatch(_(new Q(ti({},a)),n,c));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),pi=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Go(this,t),Qo(this,Xo(t).call(this,e))}var n,r,o,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Zo(e,t)}(t,e),n=t,(r=[{key:"receivedSignal",value:(i=ii(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t,e.next="Article created"===e.t0?3:"Article published"===e.t0?5:"Article updated"===e.t0?7:"Article.Comment created"===e.t0?9:"Article.Comment destroyed"===e.t0?12:"Article.Comment updated"===e.t0?15:"User created"===e.t0?17:22;break;case 3:return ai(n),e.abrupt("break",22);case 5:return ci(n),e.abrupt("break",22);case 7:return ui(n),e.abrupt("break",22);case 9:return si(n,1),li(n),e.abrupt("break",22);case 12:return si(n,-1),i=void 0,a=void 0,i=(o=n).article_id,a=o.id,R.dispatch(function(e,t){return{type:"REMOVE_COMMENT",id:e,articleId:t}}(a,i)),e.abrupt("break",22);case 15:return fi(n),e.abrupt("break",22);case 17:return e.next=19,it.find(n.id);case 19:return r=e.sent,R.dispatch({type:"PREPEND_USERS",users:[r]}),e.abrupt("break",22);case 22:case"end":return e.stop()}var o,i,a}),e)}))),function(e,t){return i.apply(this,arguments)})},{key:"call",value:function(){this.connectWith([xe,Q,it])}}])&&Ko(n.prototype,r),o&&Ko(n,o),t}(o.Views.Base);o.Deps.cable=Object(i.createConsumer)(),o.Deps.NotificationCenter=Ft;var yi=new pi;new o.Loco({notifications:{enable:!0,log:!0,size:10},postInit:function(){yi.call(),"test"===document.querySelector("body").getAttribute("data-rails-env")&&o.Env.loco.getWire().setPollingTime(1e3)}}).init();n(155);function mi(e){return(mi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function di(e,t){return!t||"object"!==mi(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function hi(e){return(hi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function vi(e,t){return(vi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var wi,gi,Oi,_i=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),di(this,hi(t).call(this))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vi(e,t)}(t,e),n=t,(r=[{key:"validate",value:function(){if(null!=this.val)switch(mi(this.val)){case"string":var e=this._getVulgarWord();if(!new RegExp("".concat(e),["i"]).exec(this.val))return;this._addErrorMessage();break;default:throw new TypeError("Vulgarity validator is applicable only for strings and ".concat(this.attr," isn't."))}}},{key:"_addErrorMessage",value:function(){var e=o.I18n[o.Env.loco.getLocale()].errors.messages.vulgarity;this.obj.addErrorMessage(e,{for:this.attr})}},{key:"_getVulgarWord",value:function(){switch(o.Env.loco.getLocale()){case"pl":return"kurwa";case"en":return"fuck"}}}])&&bi(n.prototype,r),i&&bi(n,i),t}(o.Validators.Base);Oi="Vulgarity",(gi="identity")in(wi=_i)?Object.defineProperty(wi,gi,{value:Oi,enumerable:!0,configurable:!0,writable:!0}):wi[gi]=Oi;var ji=_i;Object.assign(o.Validators,{Vulgarity:ji}),o.I18n.pl={variants:{few:function(e){var t=parseInt(o.Utils.String.last(String(e)));-1!==[2,3,4].indexOf(t)&&(2!==String(e).length||String(e)[0])}},models:{},attributes:{},ui:{form:{sending:"Wysyam...",success:"Sukces",errors:{connection:"Bd z poczeniem",invalid_data:"Nieprawidowe dane"}}},date:{formats:{default:"%d-%m-%Y",short:"%d %b",long:"%B %d, %Y"},day_names:["niedziela","poniedziaek","wtorek","roda","czwartek","pitek","sobota"],abbr_day_names:["nie","pon","wto","ro","czw","pi","sob"],month_names:["stycze","luty","marzec","kwiecie","maj","czerwiec","lipiec","sierpie","wrzesie","padziernik","listopad","grudzie"],abbr_month_names:["sty","lut","mar","kwi","maj","cze","lip","sie","wrz","pa","lis","gru"]},errors:{messages:{accepted:"musi zosta zaakceptowane",blank:"nie moe by puste",confirmation:"nie zgadza si z polem %{attribute}",empty:"nie moe by puste",equal_to:"musi by rwne %{count}",even:"musi by parzyste",exclusion:"jest zarezerwowane",greater_than:"musi by wiksze od %{count}",greater_than_or_equal_to:"musi by wiksze lub rwne %{count}",inclusion:"nie znajduje si na licie dopuszczalnych wartoci",invalid:"jest nieprawidowe",less_than:"musi by mniejsze od %{count}",less_than_or_equal_to:"musi by mniejsze lub rwne %{count}",not_a_number:"nie jest liczb",not_an_integer:"musi by liczb cakowit",odd:"musi by nieparzyste",present:"musi by puste",too_long:{few:"jest za dugie (maksymalnie %{count} znaki)",many:"jest za dugie (maksymalnie %{count} znakw)",one:"jest za dugie (maksymalnie jeden znak)",other:"jest za dugie (maksymalnie %{count} znakw)"},too_short:{few:"jest za krtkie (przynajmniej %{count} znaki)",many:"jest za krtkie (przynajmniej %{count} znakw)",one:"jest za krtkie (przynajmniej jeden znak)",other:"jest za krtkie (przynajmniej %{count} znakw)"},wrong_length:{few:"ma nieprawidow dugo (powinna wynosi %{count} znaki)",many:"ma nieprawidow dugo (powinna wynosi %{count} znakw)",one:"ma nieprawidow dugo (powinna wynosi jeden znak)",other:"ma nieprawidow dugo (powinna wynosi %{count} znakw)"},other_than:"musi by inna ni %{count}"}}},o.I18n.pl.models.User="Uytkownik",o.I18n.pl.attributes.User={password:"Haso",passwordConfirmation:"Powtrz haso"},o.I18n.en.errors.messages.vulgarity="contains strong language.",o.I18n.pl.errors.messages.vulgarity="zawiera mocny jzyk.",Object.assign(o.Controllers,{Admin:Dr,Main:Yo,User:Vt}),Object.assign(xe,{Comment:Q}),Object.assign(wt,{Member:Ke}),Object.assign(o.Models,{Article:xe,Room:wt,User:it}),window.test={Channels:o.Channels,Env:o.Env}}});
//# sourceMappingURL=application.js.map