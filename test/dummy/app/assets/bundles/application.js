!function(){"use strict";var e,t={9056:function(e,t,r){r(4916);var n=r(8535);r.n(n)().start();var o=r(4940),a=r(130),i=r(6936),c=(r(5666),r(9826),r(1539),r(8674),r(2526),r(1817),r(2165),r(6992),r(8783),r(3948),r(7042),r(8309),r(1038),r(7941),r(7327),r(5003),r(4747),r(9337),"ADD_ARTICLES"),u="PREPEND_ARTICLES",l="REMOVE_ARTICLE",s="SET_ARTICLES",f="UPDATE_ARTICLE",p="ADD_COMMENTS",d="REMOVE_COMMENT",m="SET_COMMENTS",y="UPDATE_COMMENT",b="PREPEND_USERS",v="SET_USERS";function h(e){return{type:c,articles:e}}function g(e){return{type:u,articles:e}}function w(e){return{type:s,articles:e}}function O(e,t){return{type:f,article:e,index:t}}function E(e,t){return{type:p,articleId:t,comments:e}}function j(e,t){return{type:m,comments:e,articleId:t}}function _(e,t,r){return{type:y,comment:e,articleId:t,index:r}}function S(e){return{type:b,users:e}}function k(e){return{type:b,users:e}}var R=r(4890),x=(r(2222),r(8172)),P=(0,x.ZP)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case c:return e.concat(t.articles);case u:return t.articles.concat(e);case l:return e.filter((function(e){return e.id!==t.id}));case s:return t.articles;case f:e[t.index]=t.article;break;default:return e}})),A=(0,x.ZP)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case p:void 0===e[t.articleId]&&(e[t.articleId]=[]),e[t.articleId]=e[t.articleId].concat(t.comments);break;case d:if(null==e[t.articleId])return e;e[t.articleId]=e[t.articleId].filter((function(e){return e.id!==t.id}));break;case m:e[t.articleId]=t.comments;break;case y:var r=t.articleId,n=t.index;if(!n){var o=e[r].find((function(e){return e.id===t.comment.id}));n=e[r].indexOf(o)}e[r][n]=t.comment;break;default:return e}})),I=(0,x.ZP)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case v:return t.users;case b:return t.users.concat(e);default:return e}})),C=(0,R.UY)({articles:P,comments:A,users:I}),T=(0,R.MT)(C),B=function(e){return function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=t[e];if(n.parentId&&(o=o[n.parentId]),void 0===o)return[null,null];var a=o.find((function(e){return e.id===r}));if(!a)return[null,null];var i=o.indexOf(a);return[a,i]}},z=B("articles"),D=B("comments");function M(e){return M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},M(e)}function N(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function q(e,t){return q=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},q(e,t)}function U(e,t){if(t&&("object"===M(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function L(e){return L=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},L(e)}function F(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r(489),r(2419);var $=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&q(e,t)}(i,e);var t,r,n,o,a=(n=i,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=L(n);if(o){var r=L(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return U(this,e)});function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=a.call(this,e)).published=null!=t.publishedAt,t}return t=i,(r=[{key:"vulgarityLevel",value:function(){(null!=this.title&&/fuck/i.exec(this.title)||null!=this.content&&/fuck/i.exec(this.content))&&this.addErrorMessage("Article contains strong language.",{for:"base"})}},{key:"setDefaultValuesForAdminReview",value:function(){this.adminRate=null==this.adminRate?3:this.adminRate,this.categoryId=null==this.categoryId?6:this.categoryId,this.adminReviewStartedAt=Date.now()}}])&&N(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(o.Models.Base);F($,"identity","Article"),F($,"resources",{url:"/user/articles",paginate:{per:5},main:{url:"/articles",paginate:{per:3}},admin:{url:"/admin/articles",paginate:{per:4}}}),F($,"attributes",{title:{validations:{presence:!0,length:{within:[3,255]}}},content:{validations:{presence:!0,length:{minimum:100}},remoteName:"text"},createdAt:{type:"Date",remoteName:"created_at"},updatedAt:{type:"Date",remoteName:"updated_at"},commentsCount:{type:"Int",remoteName:"comments_count"},publishedAt:{type:"Date",remoteName:"published_at"},published:{},adminReview:{remoteName:"admin_review"},adminRate:{type:"Int",remoteName:"admin_rate"},categoryId:{type:"Int",remoteName:"category_id"},adminReviewStartedAt:{remoteName:"admin_review_started_at"}}),F($,"validate",["vulgarityLevel"]);var H=$;function V(e){return V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},V(e)}function Y(e,t){return Y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Y(e,t)}function W(e,t){if(t&&("object"===V(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function J(e){return J=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},J(e)}function G(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Z=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Y(e,t)}(a,e);var t,r,n,o=(r=a,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=J(r);if(n){var o=J(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return W(this,e)});function a(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),o.call(this,e)}return t=a,Object.defineProperty(t,"prototype",{writable:!1}),t}(o.Models.Base);G(Z,"identity","Article.Comment"),G(Z,"remoteName","Comment"),G(Z,"resources",{url:"/user/articles/:articleId/comments",paginate:{per:10},main:{url:"/articles/:articleId/comments",paginate:{per:5,param:"page-num"}},admin:{url:"/admin/articles/:articleId/comments",paginate:{per:5}}}),G(Z,"attributes",{author:{validations:{presence:!0}},text:{validations:{presence:!0,vulgarity:!0}},articleId:{type:"Int",validations:{presence:!0},remoteName:"article_id"},createdAt:{type:"Date",remoteName:"created_at"},updatedAt:{type:"Date",remoteName:"updated_at"},emotion:{type:"Int"},pinned:{type:"Boolean"},adminRate:{type:"Int",remoteName:"admin_rate"},approved:{type:"Boolean"}});var K=Z;function Q(e){return Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Q(e)}function X(e,t){return X=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},X(e,t)}function ee(e,t){if(t&&("object"===Q(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function te(e){return te=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},te(e)}function re(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ne=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&X(e,t)}(a,e);var t,r,n,o=(r=a,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=te(r);if(n){var o=te(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return ee(this,e)});function a(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),o.call(this,e)}return t=a,Object.defineProperty(t,"prototype",{writable:!1}),t}(o.Models.Base);re(ne,"identity","User"),re(ne,"resources",{url:"/users",admin:{url:"/admin/users"}}),re(ne,"paginate",{per:10}),re(ne,"attributes",{email:{validations:{presence:!0,format:{with:/^([^@\s]+)@((?:[-a-z0-9]+\.)+[a-z]{2,})$/i}}},username:{validations:{presence:!0,format:{with:/^[a-z][a-z0-9_-]*$/i}}},password:{validations:{presence:{on:"create"},confirmation:!0}},passwordConfirmation:{remoteName:"password_confirmation"},confirmed:{},createdAt:{type:"Date",remoteName:"created_at"},updatedAt:{type:"Date",remoteName:"updated_at"}});var oe=ne,ae=function(e){e.classList.remove("notice"),e.classList.remove("alert"),e.classList.remove("warning")},ie=function(e,t,r){null!=e[t]&&(r.classList.add(t),document.querySelector(".flash p").textContent=e[t])},ce=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4e3;setTimeout((function(){document.querySelector(".flash").classList.add("none")}),e)},ue=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.hide,r=document.querySelector(".flash");ae(r),ie(e,"notice",r),ie(e,"alert",r),ie(e,"warning",r),r.classList.remove("none"),t&&ce()};function le(e){return le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},le(e)}function se(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function pe(e,t){return pe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},pe(e,t)}function de(e,t){if(t&&("object"===le(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function me(e){return me=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},me(e)}var ye=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pe(e,t)}(i,e);var t,r,n,o,a=(n=i,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=me(n);if(o){var r=me(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return de(this,e)});function i(){return se(this,i),a.apply(this,arguments)}return t=i,(r=[{key:"disconnectedForTooLong",value:function(){ue({alert:"You have been disconnected from the server for too long. Reload page!",hide:!1})}}])&&fe(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(o.Controllers.Base),be=r(7294),ve=r(3935),he=(r(1249),r(5697)),ge=r.n(he);function we(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Oe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r(5306),r(9714);var Ee=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(0,o.getLocale)();we(this,e),this.date=t,this.skope=o.I18n[r].date}var t,r;return t=e,r=[{key:"toString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default",t=this.skope.formats;switch(e){case"default":return this.strftime(t.default);case"short":return this.strftime(t.short);case"long":return this.strftime(t.long);default:console.log("Services.Date#toString: unknown format.")}}},{key:"strftime",value:function(e){e=(e=e.replace("%Y",this.date.getFullYear())).replace("%y",this.date.getFullYear().toString().substr(-2,2));var t=this.date.getMonth()+1;return t=t>=10?t:"0".concat(t),(e=(e=(e=(e=(e=(e=e.replace("%m",t)).replace("%b",this.skope.abbr_month_names[this.date.getMonth()])).replace("%B",this.skope.month_names[this.date.getMonth()])).replace("%d",this.date.getDate()>=10?this.date.getDate():"0".concat(this.date.getDate()))).replace("%H",this.date.getHours()>=10?this.date.getHours():"0".concat(this.date.getHours()))).replace("%M",this.date.getMinutes()>=10?this.date.getMinutes():"0".concat(this.date.getMinutes()))).replace("%S",this.date.getSeconds()>=10?this.date.getSeconds():"0".concat(this.date.getSeconds()))}}],r&&Oe(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),je=Ee;function _e(e){var t=e.comment,r=new je(t.createdAt).strftime("%d %b %y");return be.createElement("p",{id:"comment_".concat(t.id)},be.createElement("b",null,t.author)," on ",be.createElement("i",null,r)," (",be.createElement("a",{href:"/admin/articles/".concat(t.articleId,"/comments/").concat(t.id,"/edit")},"edit"),")",be.createElement("br",null),t.text)}_e.propTypes={comment:ge().instanceOf(K).isRequired};var Se=_e;function ke(e){var t=e.comments;return 0===t.length?be.createElement("p",null,"No comments"):be.createElement(be.Fragment,null,t.map((function(e){return be.createElement(Se,{comment:e,key:e.id})})))}ke.propTypes={comments:ge().arrayOf(ge().instanceOf(K)).isRequired};var Re=ke;function xe(e,t,r,n,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}var Pe=function(e){document.getElementById("article_author").textContent=e.author,document.getElementById("article_title").textContent=e.title,document.getElementById("article_text").textContent=e.content},Ae=function(e){return function(){var t,r=(t=regeneratorRuntime.mark((function t(r){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=r,t.next="updated"===t.t0?3:7;break;case 3:return t.next=5,e.reload();case 5:n=t.sent,Pe(n);case 7:case"end":return t.stop()}}),t)})),function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(e){xe(a,n,o,i,c,"next",e)}function c(e){xe(a,n,o,i,c,"throw",e)}i(void 0)}))});return function(e){return r.apply(this,arguments)}}()},Ie=function(e){(0,o.subscribe)({to:e,with:Ae(e)}),Pe(e)},Ce=function(e){(0,ve.render)(be.createElement(Re,{comments:e}),document.getElementById("comments"))},Te=function(e){e.setDefaultValuesForAdminReview(),new a.UI.Form({id:"edit_article_form",for:e}).render()};function Be(e){var t=e.article,r=new je(t.publishedAt).toString("short");return be.createElement("article",{id:"article_".concat(t.id)},be.createElement("h2",null,t.title),be.createElement("p",null,be.createElement("i",null,t.author," wrote this on ",r," /"," ",be.createElement("span",{className:"comments_quantity"},t.commentsCount," comment",1===t.commentsCount?"":"s"))),be.createElement("p",null,t.content),be.createElement("p",null,be.createElement("a",{href:"/admin/articles/".concat(t.id,"/edit")},"Review")))}Be.propTypes={article:ge().instanceOf(H).isRequired};var ze=Be;function De(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Me(e){var t,r,n=(t=(0,be.useState)(e.articles),r=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a=[],i=!0,c=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){c=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(c)throw o}}return a}}(t,r)||function(e,t){if(e){if("string"==typeof e)return De(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?De(e,t):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=n[0],a=n[1];(0,be.useEffect)((function(){var e=T.subscribe((function(){return a(T.getState().articles)}));return function(){e()}}),[]);var i=o.map((function(e){return be.createElement(ze,{key:e.id,article:e})}));return be.createElement(be.Fragment,null,i)}Me.propTypes={articles:ge().arrayOf(ge().instanceOf(H)).isRequired};var Ne=Me;function qe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ue(e,t,r,n,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function Le(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){Ue(a,n,o,i,c,"next",e)}function c(e){Ue(a,n,o,i,c,"throw",e)}i(void 0)}))}}var Fe=function(){var e=Le(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H.find(o.helpers.params.id);case 2:t=e.sent,Ie(t),Te(t);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),$e=function(){var e=Le(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K.all({articleId:o.helpers.params.id});case 2:t=e.sent,Ce(t.resources);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),He=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n,o;return t=e,r=[{key:"published",value:(o=Le(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H.get("published");case 2:t=e.sent,T.dispatch(w(t.resources)),(0,ve.render)(be.createElement(Ne,{articles:t.resources}),document.getElementById("articles"));case 5:case"end":return e.stop()}}),e)}))),function(){return o.apply(this,arguments)})},{key:"edit",value:(n=Le(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Fe(),$e();case 2:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})}],r&&qe(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Ve=He;function Ye(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var We=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r;return t=e,r=[{key:"edit",value:function(){!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new a.UI.Form({for:new K({id:e.commentId,resource:"admin"}),id:"edit_comment_".concat(e.commentId),initObj:!0});t.render(),window.test={commentFormObj:t.getObj()}}({commentId:o.helpers.params.id})}}],r&&Ye(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Je=We,Ge=function(){return window.location.href="/admin"};function Ze(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Ke=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r;return t=e,(r=[{key:"new",value:function(){new a.UI.Form({id:"sign_in_admin",callbackSuccess:Ge}).render()}}])&&Ze(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Qe=function(e){var t=e.user;return be.createElement("tr",{id:"user_".concat(t.id)},be.createElement("td",null,t.email),be.createElement("td",null,t.username),be.createElement("td",{className:"confirmed"},t.confirmed?"Yes":"No"),be.createElement("td",null,be.createElement("a",{href:"/admin/users/".concat(t.id)},"Show")," |"," ",be.createElement("a",{href:"/admin/users/".concat(t.id,"/edit")},"Edit")," |"," ",be.createElement("a",{href:"/admin/users/".concat(t.id),"data-method":"delete","data-confirm":"Are you sure?"},"Delete")," ","|"," ",be.createElement("a",{href:"#",onClick:function(e){return function(e,t){e.preventDefault(),(0,o.emit)({type:"PING",user_id:t})}(e,t.id)}},"Ping")))};Qe.propTypes={user:ge().instanceOf(oe).isRequired};var Xe=Qe;function et(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function tt(e){var t,r,n=(t=(0,be.useState)(e.users),r=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a=[],i=!0,c=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){c=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(c)throw o}}return a}}(t,r)||function(e,t){if(e){if("string"==typeof e)return et(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?et(e,t):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=n[0],a=n[1];(0,be.useEffect)((function(){var e=T.subscribe((function(){return a(T.getState().users)}));return function(){e()}}),[]);var i=o.map((function(e){return be.createElement(Xe,{key:"user_".concat(e.id),user:e})}));return be.createElement(be.Fragment,null,i)}tt.propTypes={users:ge().arrayOf(ge().instanceOf(oe)).isRequired};var rt=tt,nt=function(e){document.getElementById("user_email").textContent=e.email,document.getElementById("user_username").textContent=e.username,document.getElementById("user_confirmed").textContent=e.confirmed?"Yes":"No",function(e){var t=document.getElementById("edit_link"),r=t.getAttribute("href");t.setAttribute("href",r.replace("/0/","/".concat(e.id,"/")))}(e)};function ot(e,t,r,n,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function at(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){ot(a,n,o,i,c,"next",e)}function c(e){ot(a,n,o,i,c,"throw",e)}i(void 0)}))}}function it(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var ct=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n,i;return t=e,r=[{key:"index",value:(i=at(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,oe.get("all");case 2:t=e.sent,T.dispatch(k(t.resources)),(0,ve.render)(be.createElement(rt,{users:t.resources}),document.querySelector("table tbody"));case 5:case"end":return e.stop()}}),e)}))),function(){return i.apply(this,arguments)})},{key:"show",value:(n=at(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,oe.find(o.helpers.params.id);case 2:t=e.sent,nt(t);case 4:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})},{key:"edit",value:function(){var e;e=new oe({id:o.helpers.params.id}),new a.UI.Form({for:e,initObj:!0,id:"admin_user_form"}).render()}}],r&&it(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),ut=ct;function lt(e){return lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lt(e)}function st(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ft(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function pt(e,t){return pt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},pt(e,t)}function dt(e,t){if(t&&("object"===lt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function mt(e){return mt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},mt(e)}var yt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pt(e,t)}(i,e);var t,r,n,o,a=(n=i,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=mt(n);if(o){var r=mt(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return dt(this,e)});function i(){return st(this,i),a.apply(this,arguments)}return t=i,(r=[{key:"initialize",value:function(){this.setScope("admin")}}])&&ft(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(ye);yt.Articles=Ve,yt.Comments=Je,yt.Sessions=Ke,yt.Users=ut;var bt=yt,vt=function(e,t){return e.comments[t]};function ht(e){var t=e.comment,r=new je(t.createdAt).strftime("%d %b %y");return be.createElement("p",{id:"comment_".concat(t.id)},be.createElement("b",null,t.author)," on ",be.createElement("i",null,r)," wrote:",be.createElement("br",null),t.text)}ht.propTypes={comment:ge().instanceOf(K).isRequired};var gt=ht;function wt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ot(e){var t,r,n=e.articleId,o=(t=(0,be.useState)(e.comments),r=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a=[],i=!0,c=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){c=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(c)throw o}}return a}}(t,r)||function(e,t){if(e){if("string"==typeof e)return wt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?wt(e,t):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=o[0],i=o[1];(0,be.useEffect)((function(){var e=T.subscribe((function(){i(vt(T.getState(),n))}));return function(){e()}}),[]);var c=a.map((function(e){return be.createElement(gt,{key:e.id,comment:e})}));return 0===a.length?be.createElement("p",{id:"no_comments"},"No comments."):be.createElement(be.Fragment,null,c)}Ot.propTypes={articleId:ge().number.isRequired,comments:ge().arrayOf(ge().instanceOf(K)).isRequired};var Et=Ot;function jt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _t(e){var t,r,n=(t=(0,be.useState)(e.comments),r=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a=[],i=!0,c=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){c=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(c)throw o}}return a}}(t,r)||function(e,t){if(e){if("string"==typeof e)return jt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?jt(e,t):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=n[0],a=n[1];return(0,be.useEffect)((function(){var t=T.subscribe((function(){a(vt(T.getState(),e.articleId))}));return function(){t()}}),[]),be.createElement(be.Fragment,null,"".concat(o.length," comment").concat(1===o.length?"":"s"))}_t.propTypes={articleId:ge().number.isRequired,comments:ge().arrayOf(ge().instanceOf(K)).isRequired};var St=_t,kt=(r(3210),function(e){return(e=(e=e.replace(/\r\n?/,"\n")).trim()).length>0&&(e="<p>"+(e=(e=e.replace(/\n\n+/g,"</p><p>")).replace(/\n/g,"<br>"))+"</p>"),e});function Rt(e,t,r,n,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}var xt=function(e){return function(){var t,r=(t=regeneratorRuntime.mark((function t(r){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=r,t.next="updating"===t.t0?3:"updated"===t.t0?6:10;break;case 3:return ue({warning:"Author is currently editing article. Be aware of possible changes."}),t.abrupt("break",10);case 6:return t.next=8,e.reload();case 8:n=t.sent,Pt(n,!0);case 10:case"end":return t.stop()}}),t)})),function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(e){Rt(a,n,o,i,c,"next",e)}function c(e){Rt(a,n,o,i,c,"throw",e)}i(void 0)}))});return function(e){return r.apply(this,arguments)}}()},Pt=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!1===t&&(0,o.subscribe)({to:e,with:xt(e)}),document.getElementById("title").textContent=e.title,document.getElementById("author").textContent=e.author;var r=new je(e.publishedAt);document.getElementById("pub_date").textContent=r.toString("short");var n=document.getElementById("text");n.innerHTML="";var a=kt(e.content);n.insertAdjacentHTML("beforeend",a)},At={renderArticle:Pt,renderForm:function(e){new a.UI.Form({for:e,initObj:!0,id:"new_comment"}).render()}};function It(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ct(e,t,r,n,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function Tt(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){Ct(a,n,o,i,c,"next",e)}function c(e){Ct(a,n,o,i,c,"throw",e)}i(void 0)}))}}var Bt=function(){var e=Tt(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H.find(o.helpers.params.id);case 2:t=e.sent,T.dispatch(w([t])),At.renderArticle(t);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),zt=function(){var e=Tt(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K.get("count",{articleId:o.helpers.params.id});case 2:return t=e.sent,e.next=5,K.all({articleId:o.helpers.params.id,total:t.total});case 5:r=e.sent,T.dispatch(j(r,o.helpers.params.id)),(0,ve.render)(be.createElement(Et,{articleId:o.helpers.params.id,comments:r}),document.getElementById("comments")),(0,ve.render)(be.createElement(St,{articleId:o.helpers.params.id,comments:r}),document.getElementById("comments_count"));case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Dt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,r=[{key:"show",value:(n=Tt(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=new K({articleId:o.helpers.params.id}),At.renderForm(t),Bt(),zt();case 4:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})}],r&&It(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Mt=Dt;function Nt(e,t,r,n,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function qt(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){Nt(a,n,o,i,c,"next",e)}function c(e){Nt(a,n,o,i,c,"throw",e)}i(void 0)}))}}function Ut(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a=[],i=!0,c=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){c=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(c)throw o}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Lt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Lt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Lt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ft(){var e=Ut((0,be.useState)(1),2),t=e[0],r=e[1],n=Ut((0,be.useState)(!1),2),o=n[0],a=n[1];function i(){return(i=qt(regeneratorRuntime.mark((function e(n){var o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),r(o=t+1),i=null,e.prev=4,e.next=7,H.get("all",{page:o});case 7:i=e.sent,e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(4),alert("Invalid URL: ".concat(e.t0)),e.abrupt("return");case 14:i.resources.length>0?T.dispatch(h(i.resources)):a(!0);case 15:case"end":return e.stop()}}),e,null,[[4,10]])})))).apply(this,arguments)}return o?be.createElement("span",null,"No more posts."):be.createElement("a",{href:"#",id:"load_more",onClick:function(e){return i.apply(this,arguments)}},"Load more…")}function $t(e){var t=e.article,r=new je(t.publishedAt).toString("short");return be.createElement("article",{id:"article_".concat(t.id)},be.createElement("h2",null,t.title),be.createElement("p",null,be.createElement("i",null,t.author," wrote this on ",r," /"," ",be.createElement("a",{href:"/articles/".concat(t.id,"#comments"),className:"comments_quantity"},t.commentsCount," comment",1===t.commentsCount?"":"s"))),be.createElement("p",null,t.content),be.createElement("p",null,be.createElement("a",{href:"/articles/".concat(t.id)},"Continued…")))}$t.propTypes={article:ge().instanceOf(H).isRequired};var Ht=$t;function Vt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Yt(e){var t,r,n=(t=(0,be.useState)(e.articles),r=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a=[],i=!0,c=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){c=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(c)throw o}}return a}}(t,r)||function(e,t){if(e){if("string"==typeof e)return Vt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Vt(e,t):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=n[0],a=n[1];(0,be.useEffect)((function(){var e=T.subscribe((function(){return a(T.getState().articles)}));return function(){e()}}),[]);var i=o.map((function(e){return be.createElement(Ht,{key:e.id,article:e})}));return be.createElement(be.Fragment,null,i)}Yt.propTypes={articles:ge().arrayOf(ge().instanceOf(H)).isRequired};var Wt=Yt;function Jt(e,t,r,n,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function Gt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Zt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n,o;return t=e,r=[{key:"index",value:(n=regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(0,ve.render)(be.createElement(Ft,null),document.getElementById("load_more_wrapper")),e.next=3,H.get("all",{page:1});case 3:t=e.sent,T.dispatch(w(t.resources)),(0,ve.render)(be.createElement(Wt,{articles:t.resources}),document.getElementById("articles"));case 6:case"end":return e.stop()}}),e)})),o=function(){var e=this,t=arguments;return new Promise((function(r,o){var a=n.apply(e,t);function i(e){Jt(a,r,o,i,c,"next",e)}function c(e){Jt(a,r,o,i,c,"throw",e)}i(void 0)}))},function(){return o.apply(this,arguments)})}],r&&Gt(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Kt=Zt,Qt=function(e){switch(e){case"confirming":document.getElementById("verification_info").textContent=document.getElementById("verification_progress").textContent;break;case"confirmed":window.location.href="/user/sessions/new?event=confirmed"}},Xt=function(e){(0,o.subscribe)({to:new oe({id:e.id}),with:Qt}),document.querySelector("form").style.display="none",document.getElementById("sign_in_paragraph").classList.remove("none"),document.getElementById("verification_info").classList.remove("none"),ue({notice:e.notice})};function er(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var tr=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r;return t=e,(r=[{key:"new",value:function(){new a.UI.Form({for:new oe,callbackSuccess:Xt}).render()}}])&&er(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),rr=tr;function nr(e){return nr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nr(e)}function or(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ar(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ir(e,t){return ir=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ir(e,t)}function cr(e,t){if(t&&("object"===nr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ur(e){return ur=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ur(e)}var lr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ir(e,t)}(i,e);var t,r,n,o,a=(n=i,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ur(n);if(o){var r=ur(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return cr(this,e)});function i(){return or(this,i),a.apply(this,arguments)}return t=i,(r=[{key:"initialize",value:function(){this.setScope("main")}}])&&ar(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(ye);lr.Articles=Mt,lr.Pages=Kt,lr.Users=rr;var sr=lr;function fr(e){return fr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fr(e)}function pr(e,t){return pr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},pr(e,t)}function dr(e,t){if(t&&("object"===fr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function mr(e){return mr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},mr(e)}function yr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var br=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pr(e,t)}(a,e);var t,r,n,o=(r=a,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=mr(r);if(n){var o=mr(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return dr(this,e)});function a(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),o.call(this,e)}return t=a,Object.defineProperty(t,"prototype",{writable:!1}),t}(o.Models.Base);yr(br,"identity","Room.Member"),yr(br,"resources",{url:"/user/rooms/:roomId/members",paginate:{per:100}});var vr=br;function hr(e){return hr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hr(e)}function gr(e,t){return gr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},gr(e,t)}function wr(e,t){if(t&&("object"===hr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Or(e){return Or=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Or(e)}var Er,jr,_r,Sr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gr(e,t)}(a,e);var t,r,n,o=(r=a,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Or(r);if(n){var o=Or(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return wr(this,e)});function a(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),o.call(this,e)}return t=a,Object.defineProperty(t,"prototype",{writable:!1}),t}(o.Models.Base);_r="Room",(jr="identity")in(Er=Sr)?Object.defineProperty(Er,jr,{value:_r,enumerable:!0,configurable:!0,writable:!0}):Er[jr]=_r;var kr=Sr,Rr=function(e){document.querySelector("#room_".concat(e," td.members"))},xr=function(e,t){switch(e){case"Room member_joined":o=t.room_id,(a=Rr(o)).textContent=parseInt(a.text())+1;break;case"Room member_left":!function(e){var t=Rr(e);t.textContent=parseInt(t.text())-1}(t.room_id);break;case"Room created":document.getElementById("rooms_list").insertAdjacentHTML("beforeend",(n=t.room,void"\n  <tr id='room_".concat(n.id,"'>\n    <td>").concat(n.name,"</td>\n    <td class='members'>0</td>\n    <td>\n      <a rel='nofollow' data-method='patch' href='/user/rooms/").concat(n.id,"/join'>Join</a> |\n      <a data-confirm='R U sure?' rel='nofollow' data-method='delete'\n        href='/user/rooms/").concat(n.id,"'>Destroy</a>\n    </td>\n  </tr>\n  ")));break;case"Room destroyed":var r=document.getElementById("room_".concat(t.room_id));r.parentNode.removeChild(r)}var n,o,a};function Pr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Ar=function(e){var t="<li id='user_".concat(e.id,"'>").concat(e.username,"</li>");document.getElementById("members").insertAdjacentHTML("beforeend",t)},Ir=function(e){return function(t,r){switch(t){case"Room member_joined":if(r.room_id!==e)return;Ar(r.member);break;case"Room member_left":if(r.room_id!==e)return;n=r.member,(o=document.querySelector("#members li#user_".concat(n.id))).parentNode.removeChild(o)}var n,o}},Cr=function(e){var t,r=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Pr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Pr(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(c)throw a}}}}(e);try{for(r.s();!(t=r.n()).done;){var n=t.value;Ar(n)}}catch(e){r.e(e)}finally{r.f()}},Tr=function(e,t){var r='<p class="msg"><b>'.concat(t,"</b>: ").concat(e,"</p>");document.getElementById("messages").insertAdjacentHTML("beforeend",r)};function Br(e,t,r,n,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function zr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Dr=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.callbacks={}}var t,r,n,a;return t=e,r=[{key:"index",value:function(){(0,o.subscribe)({to:kr,with:xr})}},{key:"show",value:(n=regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.callbacks.receivedMessage=Tr,r=o.helpers.params.id,(0,o.subscribe)({to:kr,with:Ir(r)}),function(e){document.querySelector("[data-behavior~=room-speaker]").addEventListener("keypress",(function(t){13===t.keyCode&&(t.preventDefault(),(0,o.emit)({type:"NEW_MESSAGE",txt:t.target.value,room_id:e}),t.target.value="")}))}(r),e.next=4,vr.all({roomId:o.helpers.params.id});case 4:t=e.sent,Cr(t.resources);case 6:case"end":return e.stop()}var r}),e,this)})),a=function(){var e=this,t=arguments;return new Promise((function(r,o){var a=n.apply(e,t);function i(e){Br(a,r,o,i,c,"next",e)}function c(e){Br(a,r,o,i,c,"throw",e)}i(void 0)}))},function(){return a.apply(this,arguments)})}],r&&zr(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Mr=Dr;function Nr(e,t,r,n,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function qr(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){Nr(a,n,o,i,c,"next",e)}function c(e){Nr(a,n,o,i,c,"throw",e)}i(void 0)}))}}var Ur=function(e){document.getElementById("article_title").textContent=e.title,document.getElementById("article_text").textContent=e.content;var t=document.getElementById("publish_article");t&&null!=e.publishedAt?t.style.display="none":t&&(t.style.display="")},Lr=function(e){return function(){var t=qr(regeneratorRuntime.mark((function t(r){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=r,t.next="updated"===t.t0?3:"destroyed"===t.t0?8:9;break;case 3:return t.next=5,e.reload();case 5:return e.applyChanges(),Ur(e),t.abrupt("break",9);case 8:window.location.href="/user/articles?message=deleted";case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},Fr=function(e){var t,r;null!==e&&((0,o.subscribe)({to:e,with:Lr(e)}),function(e){document.getElementById("publish_article").addEventListener("click",function(){var t=qr(regeneratorRuntime.mark((function t(r){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r.preventDefault(),r.target.textContent="Publishing...",t.prev=2,t.next=5,e.put("publish");case 5:document.getElementById("publish_article").outerHTML="<span>Published!</span>",t.next=12;break;case 8:t.prev=8,t.t0=t.catch(2),document.getElementById("publish_article").textContent="Publish",ue({alert:"Connection error!"});case 12:case"end":return t.stop()}}),t,null,[[2,8]])})));return function(e){return t.apply(this,arguments)}}())}(e),t=e.id,r=document.getElementById("edit_link").getAttribute("href"),document.getElementById("edit_link").setAttribute("href",r.replace("/0/","/".concat(t,"/"))),Ur(e))};function $r(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Hr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?$r(Object(r),!0).forEach((function(t){Vr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$r(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Vr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Yr(e,t,r,n,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function Wr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Jr(e){var t,r,n,o=e.comment,a=e.isAdmin,i=void 0!==a&&a,c=(r=(0,be.useState)(!1),n=2,function(e){if(Array.isArray(e))return e}(r)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a=[],i=!0,c=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){c=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(c)throw o}}return a}}(r,n)||function(e,t){if(e){if("string"==typeof e)return Wr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Wr(e,t):void 0}}(r,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),u=c[0],l=c[1],s=new je(o.createdAt).strftime("%d %b %y"),f=function(){var e,t=(e=regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),l(!0),o.approved=!0,e.next=5,o.updateAttribute("approved");case 5:if(e.sent.ok){e.next=8;break}return e.abrupt("return");case 8:T.dispatch(_(new K(Hr(Hr({},o),{},{approved:!0})),o.articleId));case 9:case"end":return e.stop()}}),e)})),function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){Yr(a,n,o,i,c,"next",e)}function c(e){Yr(a,n,o,i,c,"throw",e)}i(void 0)}))});return function(e){return t.apply(this,arguments)}}();return be.createElement("p",{id:"comment_".concat(o.id)},be.createElement("b",null,o.author)," on ",be.createElement("i",null,s),i?(t=o.approved?be.createElement(be.Fragment,null,be.createElement("span",null,"approved")," |"," "):u?be.createElement(be.Fragment,null,be.createElement("span",null,"approving...")," |"," "):be.createElement(be.Fragment,null,be.createElement("a",{href:"/user/articles/".concat(o.articleId,"/comments/").concat(o.id,"/approve"),className:"approve",onClick:f},"approve")," ","|"," "),be.createElement(be.Fragment,null," ","(",t,be.createElement("a",{href:"/user/articles/".concat(o.articleId,"/comments/").concat(o.id,"/edit")},"edit")," ","|"," ",be.createElement("a",{href:"/user/articles/".concat(o.articleId,"/comments/").concat(o.id),"data-method":"delete","data-confirm":"Are you sure?"},"delete"),")")):"",be.createElement("br",null),o.text)}r(9720),r(3290),Jr.propTypes={comment:ge().instanceOf(K).isRequired,isAdmin:ge().bool};var Gr=Jr;function Zr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Kr(e){var t,r,n=e.articleId,o=e.isAdmin||!1,a=(t=(0,be.useState)(e.comments),r=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a=[],i=!0,c=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){c=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(c)throw o}}return a}}(t,r)||function(e,t){if(e){if("string"==typeof e)return Zr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Zr(e,t):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=a[0],c=a[1];if((0,be.useEffect)((function(){var e=T.subscribe((function(){return c(vt(T.getState(),n))}));return function(){e()}}),[]),0===i.length)return be.createElement("p",null,"No comments.");var u=i.map((function(e){return be.createElement(Gr,{key:e.id,comment:e,isAdmin:o})}));return be.createElement(be.Fragment,null,u)}Kr.propTypes={articleId:ge().number.isRequired,isAdmin:ge().bool,comments:ge().arrayOf(ge().instanceOf(K)).isRequired};var Qr=Kr;function Xr(e,t,r,n,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function en(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){Xr(a,n,o,i,c,"next",e)}function c(e){Xr(a,n,o,i,c,"throw",e)}i(void 0)}))}}function tn(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var rn,nn=function(e){for(var t=0,r=Object.entries(e.changes());t<r.length;t++){var n=(a=r[t],i=1,function(e){if(Array.isArray(e))return e}(a)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a=[],i=!0,c=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){c=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(c)throw o}}return a}}(a,i)||function(e,t){if(e){if("string"==typeof e)return tn(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?tn(e,t):void 0}}(a,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0],o=document.querySelector("a.apply_changes[data-for=".concat(e.getAttrRemoteName(n),"]"));o&&o.classList.remove("none")}var a,i},on=function(e){return function(){var t=en(regeneratorRuntime.mark((function t(r,n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=r,t.next="updating"===t.t0?3:"updated"===t.t0?5:"destroyed"===t.t0?9:10;break;case 3:return document.querySelector("h1").getAttribute("data-mark")!==n.mark&&ue({warning:"Uuups someone else started editing this article."}),t.abrupt("break",10);case 5:return t.next=7,e.reload();case 7:return nn(e),t.abrupt("break",10);case 9:window.location.href="/user/articles?message=deleted";case 10:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}()},an={render:function(e){T.dispatch(h([e])),(0,o.subscribe)({to:e,with:on(e)});var t=new a.UI.Form({for:e});t.render(),function(e){for(var t=0,r=Array.from(document.querySelectorAll("a.apply_changes"));t<r.length;t++)r[t].addEventListener("click",(function(t){t.preventDefault();var r=e.getObj(),n=r.getAttrName(t.target.getAttribute("data-for"));r[n]=r.changes()[n].is,e.fill(n),t.target.classList.add("none")}))}(t)},renderComments:(rn=en(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K.all({articleId:t});case 2:r=e.sent,T.dispatch(j(r.resources,t)),(0,ve.render)(be.createElement(Qr,{articleId:t,comments:r.resources,isAdmin:!0}),document.getElementById("comments"));case 5:case"end":return e.stop()}}),e)}))),function(e){return rn.apply(this,arguments)})};function cn(e,t,r,n,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function un(e){var t=e.article,r=e.onArticleDestroyed,n=function(){var e,n=(e=regeneratorRuntime.mark((function e(n){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),confirm("Are you sure?")){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,t.delete(null);case 5:(o=e.sent).success&&T.dispatch((a=o.id,{type:l,id:a})),r(o);case 8:case"end":return e.stop()}var a}),e)})),function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){cn(a,n,o,i,c,"next",e)}function c(e){cn(a,n,o,i,c,"throw",e)}i(void 0)}))});return function(e){return n.apply(this,arguments)}}();return be.createElement("tr",{id:"article_".concat(t.id)},be.createElement("td",null,t.title),be.createElement("td",null,t.content),be.createElement("td",{className:"comments_quantity"},t.commentsCount),be.createElement("td",{className:"published"},t.publishedAt?"yes":"no"),be.createElement("td",null,be.createElement("a",{href:"/user/articles/".concat(t.id)},"Show")," |",be.createElement("a",{href:"/user/articles/".concat(t.id,"/edit")},"Edit")," |",be.createElement("a",{href:"/user/articles/".concat(t.id),className:"delete_article",onClick:n},"Delete")))}un.propTypes={article:ge().instanceOf(H).isRequired,onArticleDestroyed:ge().func.isRequired};var ln=un;function sn(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function fn(e){var t,r,n=(t=(0,be.useState)(e.articles),r=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a=[],i=!0,c=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){c=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(c)throw o}}return a}}(t,r)||function(e,t){if(e){if("string"==typeof e)return sn(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?sn(e,t):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=n[0],a=n[1];(0,be.useEffect)((function(){var e=T.subscribe((function(){return a(T.getState().articles)}));return function(){e()}}),[]);var i=o.map((function(t){return be.createElement(ln,{key:t.id,article:t,onArticleDestroyed:e.onArticleDestroyed})}));return be.createElement(be.Fragment,null,i)}fn.propTypes={articles:ge().arrayOf(ge().instanceOf(H)).isRequired,onArticleDestroyed:ge().func.isRequired};var pn=fn;function dn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function mn(e,t,r,n,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function yn(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){mn(a,n,o,i,c,"next",e)}function c(e){mn(a,n,o,i,c,"throw",e)}i(void 0)}))}}var bn=function(){var e=yn(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H.find(o.helpers.params.id);case 2:t=e.sent,T.dispatch(w([t])),Fr(t);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),vn=function(){var e=yn(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K.all({articleId:o.helpers.params.id});case 2:t=e.sent,T.dispatch(j(t.resources,o.helpers.params.id)),(0,ve.render)(be.createElement(Qr,{articleId:o.helpers.params.id,comments:t.resources}),document.getElementById("comments"));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),hn=function(e){e.success?ue({notice:e.notice}):ue({alert:e.alert})},gn=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n,a;return t=e,r=[{key:"index",value:(a=yn(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"deleted"===o.helpers.params.message&&ue({alert:"Article has been deleted."}),e.next=3,H.get("all");case 3:t=e.sent,T.dispatch(w(t.resources)),(0,ve.render)(be.createElement(pn,{articles:t.resources,onArticleDestroyed:hn}),document.getElementById("article_list"));case 6:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)})},{key:"show",value:function(){bn(),vn()}},{key:"new",value:function(){an.render(new H)}},{key:"edit",value:(n=yn(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return an.renderComments(o.helpers.params.id),e.next=3,H.find(o.helpers.params.id);case 3:t=e.sent,an.render(t);case 5:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})}],r&&dn(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),wn=gn;function On(e){return On="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},On(e)}function En(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jn(e,t){return jn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},jn(e,t)}function _n(e,t){if(t&&("object"===On(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Sn(e){return Sn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Sn(e)}var kn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jn(e,t)}(a,e);var t,r,n,o=(r=a,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Sn(r);if(n){var o=Sn(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return _n(this,e)});function a(){return En(this,a),o.apply(this,arguments)}return t=a,Object.defineProperty(t,"prototype",{writable:!1}),t}(ye);kn.Articles=wn,kn.Rooms=Mr;var Rn=kn;function xn(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Pn(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?xn(Object(r),!0).forEach((function(t){An(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xn(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function An(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function In(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a=[],i=!0,c=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){c=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(c)throw o}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Cn(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Cn(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Cn(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Tn(e,t,r,n,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function Bn(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){Tn(a,n,o,i,c,"next",e)}function c(e){Tn(a,n,o,i,c,"throw",e)}i(void 0)}))}}var zn,Dn,Mn=function(){var e=Bn(regeneratorRuntime.mark((function e(t){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.id,o.Env.namespaceController.constructor===Rn){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,H.find({id:r,abbr:!0});case 5:n=e.sent,T.dispatch(h([n]));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Nn=function(){var e=Bn(regeneratorRuntime.mark((function e(t){var r,n,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.id,o.Env.namespaceController.constructor!==bt){e.next=8;break}return e.next=4,H.find({id:r,abbr:!0,resource:"admin"});case 4:n=e.sent,T.dispatch(g([n])),e.next=12;break;case 8:return e.next=10,H.find({id:r,abbr:!0});case 10:a=e.sent,T.dispatch(h([a]));case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),qn=function(){var e=Bn(regeneratorRuntime.mark((function e(t){var r,n,a,i,c,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.id,n={id:r,abbr:!0},o.Env.namespaceController.constructor===bt&&(n.resource="admin"),a=z(T.getState(),r),i=In(a,2),c=i[0],u=i[1],c){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,H.find(n);case 8:c=e.sent,T.dispatch(O(c,u));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Un=function(e,t){var r=e.article_id,n=In(z(T.getState(),r),2),o=n[0],a=n[1];if(o){var i=new H(Pn(Pn({},o),{},{commentsCount:o.commentsCount+t}));T.dispatch(O(i,a))}},Ln=function(){var e=Bn(regeneratorRuntime.mark((function e(t){var r,n,a,i,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.article_id,n=t.id,a={articleId:r,id:n},o.Env.namespaceController.constructor===sr&&(a.resource="main"),i=z(T.getState(),r),In(i,1)[0]){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,K.find(a);case 8:if(null!==(c=e.sent)){e.next=11;break}return e.abrupt("return");case 11:T.dispatch(E([c],r)),Un({article_id:r},1);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Fn=function(){var e=Bn(regeneratorRuntime.mark((function e(t){var r,n,o,a,i,c,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.article_id,n=t.id,o=D(T.getState(),n,{parentId:r}),a=In(o,2),i=a[0],c=a[1],i){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,i.reload();case 6:u=e.sent,T.dispatch(_(u,r,c));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),$n=function(){var e=Bn(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.type,e.next="PING"===e.t0?3:"NEW_MESSAGE"===e.t0?5:"Article created"===e.t0?7:"Article published"===e.t0?9:"Article updated"===e.t0?11:"Article.Comment created"===e.t0?13:"Article.Comment destroyed"===e.t0?15:"Article.Comment updated"===e.t0?18:"User created"===e.t0?20:25;break;case 3:return o.Env.namespaceController.constructor===Rn&&alert("Ping!"),e.abrupt("break",25);case 5:return(void 0,c=function(){},o.Env.namespaceController.constructor!==Rn||o.Env.controller.constructor!==Mr||"show"!==o.Env.action?c:o.Env.controller.callbacks.receivedMessage)(t.message,t.author),e.abrupt("break",25);case 7:return Mn(t.payload),e.abrupt("break",25);case 9:return Nn(t.payload),e.abrupt("break",25);case 11:return qn(t.payload),e.abrupt("break",25);case 13:return Ln(t.payload),e.abrupt("break",25);case 15:return Un(t.payload,-1),n=t.payload,a=void 0,i=void 0,a=n.article_id,i=n.id,T.dispatch(function(e,t){return{type:d,id:e,articleId:t}}(i,a)),e.abrupt("break",25);case 18:return Fn(t.payload),e.abrupt("break",25);case 20:return e.next=22,oe.find(t.payload.id);case 22:return r=e.sent,T.dispatch(S([r])),e.abrupt("break",25);case 25:case"end":return e.stop()}var n,a,i,c}),e)})));return function(t){return e.apply(this,arguments)}}();function Hn(e){return Hn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Hn(e)}function Vn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Yn(e,t){return Yn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Yn(e,t)}function Wn(e,t){if(t&&("object"===Hn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Jn(e){return Jn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Jn(e)}H.Comment=K,kr.Member=vr,(0,o.init)({cable:(0,i.zD)(),controllers:{Admin:bt,Main:sr,User:Rn},models:{Article:H,Room:kr,User:oe},notificationCenter:$n,notifications:{log:!0,size:10},postInit:function(){"test"===document.querySelector("body").getAttribute("data-rails-env")&&(0,o.getWire)().setPollingTime(1e3)}}),(0,a.connect)(o.connector),r(4603),o.Validators.Vulgarity=(Dn=zn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Yn(e,t)}(c,e);var t,r,n,a,i=(n=c,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Jn(n);if(a){var r=Jn(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return Wn(this,e)});function c(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),i.call(this)}return t=c,(r=[{key:"validate",value:function(){if(null!=this.val){if("string"!==Hn(this.val))throw new TypeError("Vulgarity validator is applicable only for strings and ".concat(this.attr," isn't."));var e=this._getVulgarWord();new RegExp("".concat(e),["i"]).exec(this.val)&&this._addErrorMessage()}}},{key:"_addErrorMessage",value:function(){var e=o.I18n[(0,o.getLocale)()].errors.messages.vulgarity;this.obj.addErrorMessage(e,{for:this.attr})}},{key:"_getVulgarWord",value:function(){switch((0,o.getLocale)()){case"pl":return"kurwa";case"en":return"fuck"}}}])&&Vn(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),c}(o.Validators.Base),function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(zn,"identity","Vulgarity"),Dn),o.I18n.pl={variants:{few:function(e){var t,r=parseInt((t=String(e))[t.length-1]);-1!==[2,3,4].indexOf(r)&&(2!==String(e).length||String(e)[0])}},models:{},attributes:{},ui:{form:{sending:"Wysyłam...",success:"Sukces",errors:{connection:"Błąd z połączeniem",invalid_data:"Nieprawidłowe dane"}}},date:{formats:{default:"%d-%m-%Y",short:"%d %b",long:"%B %d, %Y"},day_names:["niedziela","poniedziałek","wtorek","środa","czwartek","piątek","sobota"],abbr_day_names:["nie","pon","wto","śro","czw","pią","sob"],month_names:["styczeń","luty","marzec","kwiecień","maj","czerwiec","lipiec","sierpień","wrzesień","październik","listopad","grudzień"],abbr_month_names:["sty","lut","mar","kwi","maj","cze","lip","sie","wrz","paź","lis","gru"]},errors:{messages:{accepted:"musi zostać zaakceptowane",blank:"nie może być puste",confirmation:"nie zgadza się z polem %{attribute}",empty:"nie może być puste",equal_to:"musi być równe %{count}",even:"musi być parzyste",exclusion:"jest zarezerwowane",greater_than:"musi być większe od %{count}",greater_than_or_equal_to:"musi być większe lub równe %{count}",inclusion:"nie znajduje się na liście dopuszczalnych wartości",invalid:"jest nieprawidłowe",less_than:"musi być mniejsze od %{count}",less_than_or_equal_to:"musi być mniejsze lub równe %{count}",not_a_number:"nie jest liczbą",not_an_integer:"musi być liczbą całkowitą",odd:"musi być nieparzyste",present:"musi być puste",too_long:{few:"jest za długie (maksymalnie %{count} znaki)",many:"jest za długie (maksymalnie %{count} znaków)",one:"jest za długie (maksymalnie jeden znak)",other:"jest za długie (maksymalnie %{count} znaków)"},too_short:{few:"jest za krótkie (przynajmniej %{count} znaki)",many:"jest za krótkie (przynajmniej %{count} znaków)",one:"jest za krótkie (przynajmniej jeden znak)",other:"jest za krótkie (przynajmniej %{count} znaków)"},wrong_length:{few:"ma nieprawidłową długość (powinna wynosić %{count} znaki)",many:"ma nieprawidłową długość (powinna wynosić %{count} znaków)",one:"ma nieprawidłową długość (powinna wynosić jeden znak)",other:"ma nieprawidłową długość (powinna wynosić %{count} znaków)"},other_than:"musi być inna niż %{count}"}}},o.I18n.pl.models.User="Użytkownik",o.I18n.pl.attributes.User={password:"Hasło",passwordConfirmation:"Powtórz hasło"},o.I18n.en.errors.messages.vulgarity="contains strong language.",o.I18n.pl.errors.messages.vulgarity="zawiera mocny język.",o.I18n.en.date={formats:{default:"%Y-%m-%d",short:"%b %d",long:"%B %d, %Y"},day_names:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],abbr_day_names:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],month_names:["January","February","March","April","May","June","July","August","September","October","November","December"],abbr_month_names:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},window.test={getLine:o.getLine,getWire:o.getWire}}},r={};function n(e){var o=r[e];if(void 0!==o)return o.exports;var a=r[e]={exports:{}};return t[e].call(a.exports,a,a.exports,n),a.exports}n.m=t,e=[],n.O=function(t,r,o,a){if(!r){var i=1/0;for(s=0;s<e.length;s++){r=e[s][0],o=e[s][1],a=e[s][2];for(var c=!0,u=0;u<r.length;u++)(!1&a||i>=a)&&Object.keys(n.O).every((function(e){return n.O[e](r[u])}))?r.splice(u--,1):(c=!1,a<i&&(i=a));if(c){e.splice(s--,1);var l=o();void 0!==l&&(t=l)}}return t}a=a||0;for(var s=e.length;s>0&&e[s-1][2]>a;s--)e[s]=e[s-1];e[s]=[r,o,a]},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={34:0};n.O.j=function(t){return 0===e[t]};var t=function(t,r){var o,a,i=r[0],c=r[1],u=r[2],l=0;if(i.some((function(t){return 0!==e[t]}))){for(o in c)n.o(c,o)&&(n.m[o]=c[o]);if(u)var s=u(n)}for(t&&t(r);l<i.length;l++)a=i[l],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return n.O(s)},r=self.webpackChunk=self.webpackChunk||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var o=n.O(void 0,[736],(function(){return n(9056)}));o=n.O(o)}();
//# sourceMappingURL=application.js.map