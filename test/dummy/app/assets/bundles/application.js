!function(){var t,e={78443:function(t){var e;self,e=()=>(()=>{"use strict";var t={d:(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function n(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,(i=function(t,e){if("object"!==r(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(o.key),"symbol"===r(i)?i:String(i)),o)}var i}t.r(e),t.d(e,{Config:()=>o,I18n:()=>i,Models:()=>L,Validators:()=>M,connector:()=>B});const o=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.localeVar="en",this.protocolWithHostVar=null,this.scopeVar=null}var e,r;return e=t,(r=[{key:"locale",get:function(){return this.localeVar},set:function(t){this.localeVar=t}},{key:"protocolWithHost",get:function(){return this.protocolWithHostVar},set:function(t){t?"/"===t[t.length-1]?this.protocolWithHostVar=t.slice(0,t.length-1):this.protocolWithHostVar=t:this.protocolWithHostVar=null}},{key:"scope",get:function(){return this.scopeVar},set:function(t){this.scopeVar=t}}])&&n(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}()),i={en:{variants:{},models:{},attributes:{},errors:{messages:{accepted:"must be accepted",blank:"can't be blank",confirmation:"doesn't match %{attribute}",empty:"can't be empty",equal_to:"must be equal to %{count}",even:"must be even",exclusion:"is reserved",greater_than:"must be greater than %{count}",greater_than_or_equal_to:"must be greater than or equal to %{count}",inclusion:"is not included in the list",invalid:"is invalid",less_than:"must be less than %{count}",less_than_or_equal_to:"must be less than or equal to %{count}",not_a_number:"is not a number",not_an_integer:"must be an integer",odd:"must be odd",present:"must be blank",too_long:{one:"is too long (maximum is 1 character)",other:"is too long (maximum is %{count} characters)"},too_short:{one:"is too short (minimum is 1 character)",other:"is too short (minimum is %{count} characters)"},wrong_length:{one:"is the wrong length (should be 1 character)",other:"is the wrong length (should be %{count} characters)"},other_than:"must be other than %{count}"}}}};function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}var a={},c=function(t,e){if(-1!==t.indexOf(e))return null;var r=function(t){var e=t.length;return t.find((function(t,r){if(null===t)return e=r,!0})),e}(t);return t[r]=e,r},l=function(t,e,r){var n,o,i;void 0!==(null===(n=a)||void 0===n||null===(o=n[t])||void 0===o||null===(i=o[e])||void 0===i?void 0:i[r])&&(a[t][e][r]=null)},u=function(t){var e=t.getIdentity();void 0===a[e]&&(a[e]={}),void 0===a[e][t.id]&&(a[e][t.id]=[]),a[e][t.id][0]=t};const d={get imap(){return a},clear:function(){return a={}},subscribe:function(t){var e=function(){};if("object"===s(t.to)){var r=function(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).with;u(e);var r=a[e.getIdentity()][e.id];return c(r,t)}(t.with,{with:t.to});return null===r?e:function(){l(t.to.getIdentity(),t.to.id,r)}}if("function"==typeof t.to){var n=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};void 0===a[t]&&(a[t]={}),void 0===a[t].collection&&(a[t].collection=[]);var r=a[t].collection;return c(r,e.to)}(t.to.getIdentity(),{to:t.with});return null===n?e:function(){l(t.to.getIdentity(),"collection",n)}}},unsubscribe:l,add:u,find:function(t,e){return void 0!==a[t]&&null!=a[t][e]?a[t][e][0]:null},findConnected:function(t,e){return void 0!==a[t]&&void 0!==a[t][e]&&a[t][e].length>1?a[t][e].slice(1):[]}},m=function(){function t(){this.obj=null,this.attr=null,this.val=null,this.opts=null}return t.sharedInstances={},t.instance=function(t,e,r){var n,o;return o=this.identity,null==this.sharedInstances[o]&&(this.sharedInstances[o]=new M[o]),(n=this.sharedInstances[o]).assignAttribs(t,e,r),n},t.prototype.assignAttribs=function(t,e,r){return this.obj=t,this.attr=e,this.val=this.obj[this.attr],this.opts=r},t}();var p={}.hasOwnProperty;const h=function(t){function e(){e.__super__.constructor.call(this)}return function(t,e){for(var r in e)p.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(e,t),e.identity="Absence",e.prototype.validate=function(){if("string"==typeof this.val){if(null!=this.val&&0===this.val.length)return}else if(null==this.val)return;return this._addErrorMessage()},e.prototype._addErrorMessage=function(){var t;return t=null!=this.opts.message?this.opts.message:i[o.locale].errors.messages.present,this.obj.addErrorMessage(t,{for:this.attr})},e}(m);var f={}.hasOwnProperty;const y=function(t){function e(){e.__super__.constructor.call(this)}return function(t,e){for(var r in e)f.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(e,t),e.identity="Confirmation",e.prototype.validate=function(){var t;if(t=this.obj[this._properAttr()],null==this.val||null==t||this.val!==t)return this._addErrorMessage()},e.prototype._addErrorMessage=function(){var t,e,r,n;return r=this.attr.charAt(0).toUpperCase()+this.attr.slice(1),t=(e=i[o.locale].attributes[this.obj.getIdentity()])&&e[this.attr]||r,n=(n=null!=this.opts.message?this.opts.message:i[o.locale].errors.messages.confirmation).replace("%{attribute}",t),this.obj.addErrorMessage(n,{for:this._properAttr()})},e.prototype._properAttr=function(){return this.attr+"Confirmation"},e}(m);var g={}.hasOwnProperty;const b=function(t){function e(){e.__super__.constructor.call(this)}return function(t,e){for(var r in e)g.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(e,t),e.identity="Exclusion",e.prototype.validate=function(){if(-1!==(this.opts.in||this.opts.within||[]).indexOf(this.val))return this._addErrorMessage()},e.prototype._addErrorMessage=function(){var t;return t=null!=this.opts.message?this.opts.message:i[o.locale].errors.messages.exclusion,this.obj.addErrorMessage(t,{for:this.attr})},e}(m);var v={}.hasOwnProperty;const _=function(t){function e(){e.__super__.constructor.call(this)}return function(t,e){for(var r in e)v.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(e,t),e.identity="Format",e.prototype.validate=function(){if(null==this.opts.with.exec(this.val))return this._addErrorMessage()},e.prototype._addErrorMessage=function(){var t;return t=null!=this.opts.message?this.opts.message:i[o.locale].errors.messages.invalid,this.obj.addErrorMessage(t,{for:this.attr})},e}(m);var w={}.hasOwnProperty;const E=function(t){function e(){e.__super__.constructor.call(this)}return function(t,e){for(var r in e)w.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(e,t),e.identity="Inclusion",e.prototype.validate=function(){if(-1===(this.opts.in||this.opts.within||[]).indexOf(this.val))return this._addErrorMessage()},e.prototype._addErrorMessage=function(){var t;return t=null!=this.opts.message?this.opts.message:i[o.locale].errors.messages.inclusion,this.obj.addErrorMessage(t,{for:this.attr})},e}(m);var S={}.hasOwnProperty;const k=function(t){function e(){e.__super__.constructor.call(this)}return function(t,e){for(var r in e)S.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(e,t),e.identity="Length",e.prototype.validate=function(){var t;if(null!=this.val&&null!==(t=null!=this._range()[0]&&null!=this._range()[1]&&this._range()[0]===this._range()[1]&&this.val.length!==this._range()[0]?this._selectErrorMessage("wrong_length",this._range()[0]):null!=this._range()[0]&&this.val.length<this._range()[0]?this._selectErrorMessage("too_short",this._range()[0]):null!=this._range()[1]&&this.val.length>this._range()[1]?this._selectErrorMessage("too_long",this._range()[1]):null))return this.obj.addErrorMessage(t,{for:this.attr})},e.prototype._range=function(){return[this.opts.minimum||this.opts.is||null!=this.opts.within&&this.opts.within[0]||null,this.opts.maximum||this.opts.is||null!=this.opts.within&&this.opts.within[1]||null]},e.prototype._selectErrorMessage=function(t,e){var r,n,s,a,c;if(1===e)return i[o.locale].errors.messages[t].one;for(s=null,r=0,n=(a=["few","many"]).length;r<n;r++)if(c=a[r],this._checkVariant(c,e)){s=i[o.locale].errors.messages[t][c];break}return null==s&&(s=i[o.locale].errors.messages[t].other),null!=this.opts.message&&(s=this.opts.message),/%{count}/.exec(s)&&(s=s.replace("%{count}",e)),s},e.prototype._checkVariant=function(t,e){if(null!=i[o.locale].variants[t])return i[o.locale].variants[t](e)},e}(m);var I={}.hasOwnProperty;const j=function(t){function e(){e.__super__.constructor.call(this)}return function(t,e){for(var r in e)I.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(e,t),e.identity="Numericality",e.prototype.validate=function(){return isNaN(this.val)?this._addNaNErrorMessage():null!=this.opts.only_integer&&Number(this.val)!==parseInt(this.val)?this._addIntErrorMessage():null!=this.opts.greater_than&&Number(this.val)<=this.opts.greater_than?this._addGreatherThanErrorMessage():null!=this.opts.greater_than_or_equal_to&&Number(this.val)<this.opts.greater_than_or_equal_to?this._addGreatherThanOrEqualToErrorMessage():null!=this.opts.equal_to&&Number(this.val)!==this.opts.equal_to?this._addEqualToErrorMessage():null!=this.opts.less_than&&Number(this.val)>=this.opts.less_than?this._addLessThanErrorMessage():null!=this.opts.less_than_or_equal_to&&Number(this.val)>this.opts.less_than_or_equal_to?this._addLessThanOrEqualToErrorMessage():null!=this.opts.other_than&&Number(this.val)===this.opts.other_than?this._addOtherThanErrorMessage():null!=this.opts.odd&&Number(this.val)%2!=1?this._addOddErrorMessage():null!=this.opts.even&&Number(this.val)%2!=0?this._addEvenErrorMessage():void 0},e.prototype._addNaNErrorMessage=function(){var t;return t=null!=this.opts.message?this.opts.message:i[o.locale].errors.messages.not_a_number,this.obj.addErrorMessage(t,{for:this.attr})},e.prototype._addIntErrorMessage=function(){var t;return t=i[o.locale].errors.messages.not_an_integer,this.obj.addErrorMessage(t,{for:this.attr})},e.prototype._addGreatherThanErrorMessage=function(){var t;return t=(t=i[o.locale].errors.messages.greater_than).replace("%{count}",this.opts.greater_than),this.obj.addErrorMessage(t,{for:this.attr})},e.prototype._addGreatherThanOrEqualToErrorMessage=function(){var t;return t=(t=i[o.locale].errors.messages.greater_than_or_equal_to).replace("%{count}",this.opts.greater_than_or_equal_to),this.obj.addErrorMessage(t,{for:this.attr})},e.prototype._addEqualToErrorMessage=function(){var t;return t=(t=i[o.locale].errors.messages.equal_to).replace("%{count}",this.opts.equal_to),this.obj.addErrorMessage(t,{for:this.attr})},e.prototype._addLessThanErrorMessage=function(){var t;return t=(t=i[o.locale].errors.messages.less_than).replace("%{count}",this.opts.less_than),this.obj.addErrorMessage(t,{for:this.attr})},e.prototype._addLessThanOrEqualToErrorMessage=function(){var t;return t=(t=i[o.locale].errors.messages.less_than_or_equal_to).replace("%{count}",this.opts.less_than_or_equal_to),this.obj.addErrorMessage(t,{for:this.attr})},e.prototype._addOtherThanErrorMessage=function(){var t;return t=(t=i[o.locale].errors.messages.other_than).replace("%{count}",this.opts.other_than),this.obj.addErrorMessage(t,{for:this.attr})},e.prototype._addOddErrorMessage=function(){var t;return t=i[o.locale].errors.messages.odd,this.obj.addErrorMessage(t,{for:this.attr})},e.prototype._addEvenErrorMessage=function(){var t;return t=i[o.locale].errors.messages.even,this.obj.addErrorMessage(t,{for:this.attr})},e}(m);var O={}.hasOwnProperty;const A=function(t){function e(){e.__super__.constructor.call(this)}return function(t,e){for(var r in e)O.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(e,t),e.identity="Presence",e.prototype.validate=function(){if("string"==typeof this.val){if(null!=this.val&&this.val.length>0)return}else if(null!=this.val)return;return this._addErrorMessage()},e.prototype._addErrorMessage=function(){var t;return t=null!=this.opts.message?this.opts.message:i[o.locale].errors.messages.blank,this.obj.addErrorMessage(t,{for:this.attr})},e}(m);var T,C={}.hasOwnProperty;T=function(t){function e(){e.__super__.constructor.call(this)}return function(t,e){for(var r in e)C.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(e,t),e.identity="Size",e.prototype.validate=function(){return k.instance(this.obj,this.attr,this.opts).validate()},e}(m);const M={Absence:h,Base:m,Confirmation:y,Exclusion:b,Format:_,Inclusion:E,Length:k,Numericality:j,Presence:A,Size:T};var R,P=function(t,e,r){var n,o,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=function(t){var e={};if(!t)return e;var r=["resource","total","count"];return Object.keys(t).forEach((function(n){-1===r.indexOf(n)&&(e[n]=t[n])})),e}(r),a="GET"===t?"".concat(e,"?").concat((n=s,o="",Object.keys(n).forEach((function(t){""!==o&&(o="".concat(o,"&")),o="".concat(o).concat(t,"=").concat(encodeURIComponent(n[t]))})),o)):e,c=document.querySelector("meta[name='csrf-token']"),l=new XMLHttpRequest;return l.withCredentials=!0===i.cookiesByCORS,l.open(t,a),l.setRequestHeader("Accept","application/json"),l.setRequestHeader("Content-Type","application/json"),c&&l.setRequestHeader("X-CSRF-Token",c.content),null!=i.authorizationHeader&&l.setRequestHeader("Authorization",i.authorizationHeader),l.send(JSON.stringify(s)),l};R=function(){function t(t){null==t&&(t={}),this.id=null,this.errors=null,this.resource=t.resource,null!=this.constructor.attributes&&this.__initAttributes(),null!=t&&this.__assignAttributes(t)}return t.getIdentity=function(){if(null!=this.identity)return this.identity;throw"Specify Model's identity!"},t.getRemoteName=function(){return null!=this.remoteName?this.remoteName:this.getIdentity()},t.all=function(t){return null==t&&(t={}),this.get("all",t)},t.get=function(t,e){return null==e&&(e={}),this.__send("GET",t,e)},t.post=function(t,e){return null==e&&(e={}),this.__send("POST",t,e)},t.put=function(t,e){return null==e&&(e={}),this.__send("PUT",t,e)},t.patch=function(t,e){return null==e&&(e={}),this.__send("PATCH",t,e)},t.delete=function(t,e){return null==e&&(e={}),this.__send("DELETE",t,e)},t.find=function(t){var e,r,n,o,i;return o={},"object"==typeof t?(o=t,e=t.id,delete o.id):e=t,n=this.__getResourcesUrl(o)+"/"+e,r=P("GET",n,o,this.__requestOpts()),new Promise((i=this,function(e,n){return r.onerror=function(t){return n(t)},r.onload=function(r){var n;if(404!==r.target.status)return n=JSON.parse(r.target.response),e(i.__initFromJSON(n,t.resource));e(null)}}))},t.getAttribRemoteName=function(t){return null==this.attributes||null==this.attributes[t]?null:null==this.attributes[t].remoteName?t:this.attributes[t].remoteName},t.getResourcesUrlParams=function(t){var e,r,n,o;for(o=this.__getResourcesUrl({resource:t.resource}),n=/:(\w+)\/?/,r=[];e=n.exec(o);)r.push(e[1]),o=o.replace(e[0],e[1]);return r},t.__getResourcesUrl=function(t){var e,r;return r=null==this.resources?"/"+this.getRemoteName().toLowerCase()+"s":t.resource?this.resources[t.resource].url:null!=o.scope&&null!=this.resources[o.scope]?this.resources[o.scope].url:this.resources.url,null!=this.protocolWithHost?r=""+this.protocolWithHost+r:null!=o.protocolWithHost&&(r=""+o.protocolWithHost+r),null==(e=/:([a-zA-Z]+)\/?/.exec(r))||(null!=t[e[1]]?(r=r.replace(":"+e[1],t[e[1]]),delete t[e[1]]):null!=t.obj&&null!=t.obj[e[1]]&&(r=r.replace(":"+e[1],t.obj[e[1]]))),r},t.__requestOpts=function(){return{authorizationHeader:o.authorizationHeader||this.authorizationHeader,cookiesByCORS:null!=this.cookiesByCORS?this.cookiesByCORS:o.cookiesByCORS}},t.__page=function(t,e,r){var n,o,i;return o=e.url,e.params[e.pageParam]=t,n=P(e.method,o,e.params,this.__requestOpts()),new Promise((i=this,function(t,o){return n.onerror=function(t){return o(t)},n.onload=function(n){var o,s,a,c,l,u,d,m,p,h;if((o=JSON.parse(n.target.response)).constructor===Array)for(s=0,l=o.length;s<l;s++)m=o[s],d=i.__initFromJSON(m,e.resource),r.push(d);else if(null!=o.resources){for(r.constructor===Array&&(r={resources:[],count:0}),a=0,u=(p=o.resources).length;a<u;a++)m=p[a],d=i.__initFromJSON(m,e.resource),r.resources.push(d);r.count=o.count}else for(c in o)h=o[c],r[c]=h;return t(r)}}))},t.__paginate=function(t){var e,r;return e={method:t.method,url:t.url,params:t.params,pageParam:t.pageParam,resource:t.resource},this.__page(t.pageNum||1,e,[]).then((r=this,function(n){var o,i,s,a,c,l,u;if(u=n.count||t.total,c=Promise.resolve(n),null!=t.pageNum)return c;if(u<=t.perPage)return c;if((a=parseInt(u/t.perPage))!==u/t.perPage&&(a+=1),1===a)return c;for(i=s=2,l=a;2<=l?s<=l:s>=l;i=2<=l?++s:--s)o=function(t){return c=c.then((function(o){return r.__page(t,e,n)}))},o(i);return c}))},t.__getPaginationParam=function(t){var e,r,n,i,s,a;return e="page",null!=t&&null!=this.resources&&this.resources[t]?(null!=(r=this.resources[t].paginate)?r.param:void 0)||e:null!=o.scope&&null!=this.resources&&null!=this.resources[o.scope]?(null!=(n=this.resources[o.scope])&&null!=(i=n.paginate)?i.param:void 0)||e:null!=(null!=(s=this.resources)&&null!=(a=s.paginate)?a.param:void 0)?this.resources.paginate.param:e},t.__getPaginationPer=function(t){var e,r,n,i,s;return null!=t&&null!=this.resources&&this.resources[t]?null!=(e=this.resources[t].paginate)?e.per:void 0:null!=o.scope&&null!=this.resources&&null!=this.resources[o.scope]?null!=(r=this.resources[o.scope])&&null!=(n=r.paginate)?n.per:void 0:null!=(null!=(i=this.resources)&&null!=(s=i.paginate)?s.per:void 0)?this.resources.paginate.per:null},t.__send=function(t,e,r){var n,o;return o=this.__getResourcesUrl(r),"all"!==e&&(o=o+"/"+e),n={method:t,url:o,params:r,resource:r.resource,perPage:this.__getPaginationPer(r.resource),pageNum:r.page,pageParam:this.__getPaginationParam(r.resource),total:r.total||r.count},this.__paginate(n)},t.__initFromJSON=function(t,e){var r;return(r=new this(t)).resource=e,d.add(r),r},t.prototype.setResource=function(t){return this.resource=t},t.prototype.getIdentity=function(){return this.constructor.getIdentity()},t.prototype.getAttrRemoteName=function(t){return null==this.constructor.attributes||null==this.constructor.attributes[t]?null:this.constructor.attributes[t].remoteName||t},t.prototype.getAttrName=function(t){var e,r;if(null==this.constructor.attributes)return t;if(null!=this.constructor.attributes[t])return t;for(e in r=this.constructor.attributes)if(r[e].remoteName===t)return e;return t},t.prototype.getAttrType=function(t){return null==this.constructor.attributes||null==this.constructor.attributes[t]?null:this.constructor.attributes[t].type},t.prototype.assignAttr=function(t,e){var r;if(r=this.getAttrType(t),null!=e){switch(r){case"Date":e=new Date(Date.parse(e));break;case"Integer":case"Int":e=parseInt(e);break;case"Float":e=parseFloat(e);break;case"Boolean":case"Bool":e="boolean"==typeof e?e:Boolean(parseInt(e));break;case"Number":e=Number(e);break;case"String":e=String(e)}return this[t]=e}this[t]=null},t.prototype.attributes=function(){var t,e,r;if(t={id:this.id},null==this.constructor.attributes)return t;for(e in r=this.constructor.attributes)r[e],t[e]=this[e];return t},t.prototype.isValid=function(){var t,e,r,n,o,i,s,a,c,l,u;if(null==this.constructor.attributes)return!0;for(n in this.errors=null,i=this.constructor.attributes)if(null!=(t=i[n]).validations)for(c in s=t.validations)l=s[c],null!=this.id&&"create"===l.on||null==this.id&&"update"===l.on||(null==l.if||l.if(this))&&(u=c.charAt(0).toUpperCase()+c.slice(1),null!=M[u]?(o=this.__processedValidationSettings(l),M[u].instance(this,n,o).validate()):console.warn('"'+u+'" validator is not implemented!'));if(null!=this.constructor.validate)for(e=0,r=(a=this.constructor.validate).length;e<r;e++)this[a[e]]();return null==this.errors},t.prototype.isInvalid=function(){return!this.isValid()},t.prototype.isEmpty=function(){var t,e;for(t in e=this.attributes())if(e[t],null!==this[t])return!1;return!0},t.prototype.addErrorMessage=function(t,e){return null==e&&(e={}),null==this.errors&&(this.errors={}),null==this.errors[e.for]&&(this.errors[e.for]=[]),this.errors[e.for].push(t)},t.prototype.save=function(){var t,e,r;return t=null!=this.id?"PUT":"POST",e=P(t,this.__getResourceUrl(),this.serialize(),this.constructor.__requestOpts()),new Promise((r=this,function(t,n){return e.onerror=function(t){return n(t)},e.onload=function(e){var n;if(!(n=JSON.parse(e.target.response)).success)return null!=n.errors&&r.__assignRemoteErrorMessages(n.errors),t(n);t(n)}}))},t.prototype.updateAttribute=function(t){var e,r;return e=P("PUT",this.__getResourceUrl(),this.serialize(t),this.constructor.__requestOpts()),new Promise((r=this,function(t,n){return e.onerror=function(t){return n(t)},e.onload=function(e){var o;return e.target.status>=200&&e.target.status<400?(o=JSON.parse(e.target.response)).success?void t(o):(null!=o.errors&&r.__assignRemoteErrorMessages(o.errors),t(o)):e.target.status>=500?n(e):void 0}}))},t.prototype.serialize=function(t){var e,r,n,o;if(null==t&&(t=null),null==this.constructor.attributes)return{};for(t in(r={})[n=this.constructor.getRemoteName().toLowerCase()]={},e={},null!=t?e[t]=null:e=this.constructor.attributes,e)e[t],o=this.getAttrRemoteName(t),r[n][o]=this[t];return r},t.prototype.reload=function(){var t,e,r,n,o;for(t={id:this.id,resource:this.resource},e=0,r=(o=this.constructor.getResourcesUrlParams({resource:this.resource})).length;e<r;e++)t[n=o[e]]=this[n];return this.constructor.find(t)},t.prototype.changes=function(){var t,e,r,n,o;for(e in n={},t=d.find(this.getIdentity(),this.id),r=this.attributes())if((o=r[e])!==t[e]){if(null!=o&&o.constructor===Date&&t[e]-o==0)continue;o!==t[e]&&(n[e]={is:t[e],was:o})}return n},t.prototype.applyChanges=function(){var t,e,r,n;for(t in r=[],e=this.changes())n=e[t],r.push(this[t]=n.is);return r},t.prototype.toKey=function(){return this.getIdentity().toLowerCase()+"_"+this.id},t.prototype.get=function(t,e){return null==e&&(e={}),this.__send("GET",t,e)},t.prototype.post=function(t,e){return null==e&&(e={}),this.__send("POST",t,e)},t.prototype.put=function(t,e){return null==e&&(e={}),this.__send("PUT",t,e)},t.prototype.patch=function(t,e){return null==e&&(e={}),this.__send("PATCH",t,e)},t.prototype.delete=function(t,e){return null==e&&(e={}),this.__send("DELETE",t,e)},t.prototype.__send=function(t,e,r){var n,o;return o=this.__getResourceUrl(),null!=e&&(o=o+"/"+e),n=P(t,o,r,this.constructor.__requestOpts()),new Promise((function(t,e){return n.onerror=function(t){return e(t)},n.onload=function(n){return n.target.status>=200&&n.target.status<400?(r=JSON.parse(n.target.response),t(r)):n.target.status>=500?e(n):void 0}}))},t.prototype.__assignAttributes=function(t){var e,r,n,o;for(r in n=[],t)o=t[r],e=this.getAttrName(r),n.push(this.assignAttr(e,o));return n},t.prototype.__initAttributes=function(){var t,e,r;for(t in r=[],e=this.constructor.attributes)e[t],r.push(this[t]=null);return r},t.prototype.__assignRemoteErrorMessages=function(t){var e,r,n,o,i;for(o in i=[],t)n=t[o],e=this.getAttrName(o),i.push(function(){var t,o,i;for(i=[],t=0,o=n.length;t<o;t++)r=n[t],i.push(this.addErrorMessage(r,{for:e}));return i}.call(this));return i},t.prototype.__getResourceUrl=function(){var t;return t=this.constructor.__getResourcesUrl({resource:this.resource,obj:this}),null==this.id?t:t+"/"+this.id},t.prototype.__processedValidationSettings=function(t){var e,r,n;for(e in n={},t)r=t[e],n[e]="function"==typeof r?r(this):r;return n},t}();const N=R;function q(t){return q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},q(t)}function x(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function z(t,e,r){return(e=function(t){var e=function(t,e){if("object"!==q(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==q(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===q(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}N.prototype.clone=function(){return new this.constructor(function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?x(Object(r),!0).forEach((function(e){z(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):x(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},this.attributes()))};const L={Base:N};var B={IdentityMap:d,Models:L};return e})(),t.exports=e()},21927:function(t){var e;self,e=()=>(()=>{"use strict";var t={d:(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{UI:()=>a,connect:()=>p});const r={getLocale:null,wire:null,I18n:null};var n=function(t,e){return null!=t.classList?t.classList.contains(e):new RegExp("(^| )"+e+"( |$)","gi").test(t.className)},o=function(t,e){null!=t.classList?t.classList.add(e):t.className+=" "+e},i=function(t,e){null!=t.classList?t.classList.remove(e):t.className=t.className.replace(new RegExp("(^|\\b)"+e.split(" ").join("|")+"(\\b|$)","gi")," ")},s=function(t){return Array.from(t).map((function(t){return t.getAttribute("type")})).filter((function(t,e,r){return r.indexOf(t)===e}))};const a={Form:function(){function t(t){null==t&&(t={}),this.formId=t.id,this.obj=t.for,this.initObj=!(null==t.initObj||!t.initObj),this.callbackSuccess=t.callbackSuccess,this.callbackFailure=t.callbackFailure,this.callbackActive=t.callbackActive,this.form=this._findForm(),this.submit=null,this.submitVal=null,null!=this.form&&(this.submit=this.form.querySelector('[type="submit"]')),null!=this.submit&&(this.submitVal=this.submit.value),this.locale=r.getLocale()}return t.prototype.getObj=function(){return this.obj},t.prototype.render=function(){return this.initObj?(this._assignAttribs(),this._handle()):null!=this.form?(this.fill(),this._handle()):void 0},t.prototype.fill=function(t){var e,r,n,o,i,a,c,l;if(null==t&&(t=null),null==this.obj)return null;if(null==this.obj.constructor.attributes)return null;for(n in e={},null!=t?e[t]=null:e=this.obj.constructor.attributes,c=[],e)e[n],a=this.obj.getAttrRemoteName(n),null!==(o=this.form.querySelector("[data-attr="+a+"]"))&&0!==(r=o.querySelectorAll("input,textarea,select")).length&&(1!==r.length?1!==(l=s(r)).length||"radio"!==l[0]||null==(i=Array.from(r).find(function(t){return function(e){return e.value===String(t.obj[n])}}(this)))?"hidden"!==r[0].getAttribute("type")&&"checkbox"!==r[r.length-1].getAttribute("type")||c.push(r[r.length-1].checked=Boolean(this.obj[n])):i.checked=!0:r[0].value=this.obj[n]);return c},t.prototype._findForm=function(){var t;return null!=this.formId?document.getElementById(""+this.formId):null!=this.obj?(t=this.obj.getIdentity().toLowerCase(),null!=this.obj.id?document.getElementById("edit_"+t+"_"+this.obj.id):document.getElementById("new_"+t)):void 0},t.prototype._handle=function(){return this.form.addEventListener("submit",(t=this,function(e){var r;if(e.preventDefault(),t._canBeSubmitted()){if(null!=t.obj)return t._assignAttribs(),t._hideErrors(),t.obj.isInvalid()?(t._renderErrors(),void(null!=t.callbackFailure&&t.callbackFailure())):(t._submittingForm(!1),r=null==t.obj.id,t.obj.save().then((function(e){return t._alwaysAfterRequest(),e.success?t._handleSuccess(e,r):(null!=t.callbackFailure&&t.callbackFailure(),t._renderErrors())})).catch((function(e){return t._connectionError()})));t._submitForm()}}));var t},t.prototype._canBeSubmitted=function(){return null==this.submit||!n(this.submit,"active")&&!n(this.submit,"success")&&!n(this.submit,"failure")},t.prototype._submitForm=function(){var t,e,r,n,o;return this._submittingForm(),n=this.form.getAttribute("action")+".json",t=new FormData(this.form),(r=new XMLHttpRequest).open("POST",n),r.setRequestHeader("X-CSRF-Token",null!=(e=document.querySelector("meta[name='csrf-token']"))?e.content:void 0),r.onload=(o=this,function(e){return o._alwaysAfterRequest(),null!=o.submit&&o.submit.blur(),e.target.status>=200&&e.target.status<400?(t=JSON.parse(e.target.response)).success?o._handleSuccess(t,"POST"===o.form.getAttribute("method")):o._renderErrors(t.errors):e.target.status>=500?o._connectionError():void 0}),r.onerror=function(t){return function(){return t._alwaysAfterRequest(),null!=t.submit&&t.submit.blur(),t._connectionError()}}(this),r.send(t)},t.prototype._handleSuccess=function(t,e){var n,s,a,c;if(null==e&&(e=!0),a=null!=(n=null!=(s=t.flash)?s.success:void 0)?n:r.I18n[this.locale].ui.form.success,null!=this.submit&&(o(this.submit,"success"),this.submit.value=a),null!=t.access_token&&(r.wire.token=t.access_token),null==this.callbackSuccess)return setTimeout((c=this,function(){var t,r,n,o,s,a;if(null!=c.submit&&(c.submit.disabled=!1,i(c.submit,"success"),c.submit.value=c.submitVal),a=":not([data-loco-not-clear=true])",e){for(s=[],t=0,r=(o=c.form.querySelectorAll("input:not([type='submit'])"+a+", textarea"+a)).length;t<r;t++)n=o[t],s.push(n.value="");return s}}),5e3);null!=t.data?this.callbackSuccess(t.data):this.callbackSuccess()},t.prototype._renderErrors=function(t){var e,n,s,a,c,l,u,d,m;if(null==t&&(t=null),!(null!=this.obj&&null==this.obj.errors||null==this.obj&&null==t)){for(e in n=null!=t?t:this.obj.errors)if(s=n[e],null==(m=null!=this.obj?this.obj.getAttrRemoteName(e):e)||"base"===e)"base"===e&&s.length>0&&(1===(u=document.querySelectorAll(".errors[data-for='base']")).length?u[0].textContent=s[0]:null!=this.submit&&(this.submit.value=s[0]));else{if(null===(d=this.form.querySelector("[data-attr="+m+"]")))continue;if(0===(u=d.querySelectorAll(".errors[data-for="+m+"]")).length)continue;for(a=0,c=u.length;a<c;a++)(l=u[a]).textContent=s[0]}return null!=this.submit&&(this.submit.value!==this.submitVal&&this.submit.value!==r.I18n[this.locale].ui.form.sending||(this.submit.value=r.I18n[this.locale].ui.form.errors.invalid_data),o(this.submit,"failure")),this._showErrors(),setTimeout((p=this,function(){var t,e,r,n;for(null!=p.submit&&(p.submit.disabled=!1,i(p.submit,"failure"),p.submit.value=p.submitVal),n=[],t=0,e=(r=p.form.querySelectorAll("input.invalid, textarea.invalid, select.invalid")).length;t<e;t++)l=r[t],n.push(i(l,"invalid"));return n}),1e3);var p}},t.prototype._assignAttribs=function(){var t,e,r,n,o,i,a,c;if(null==this.obj.constructor.attributes)return null;for(e in a=[],o=this.obj.constructor.attributes)o[e],i=this.obj.getAttrRemoteName(e),null!==(r=this.form.querySelector("[data-attr="+i+"]"))&&0!==(t=r.querySelectorAll("input,textarea,select")).length&&(1!==t.length?1!==(c=s(t)).length||"radio"!==c[0]||null==(n=Array.from(t).find((function(t){return!0===t.checked})))?"hidden"!==t[0].getAttribute("type")&&"checkbox"!==t[t.length-1].getAttribute("type")||(!0===t[t.length-1].checked?a.push(this.obj.assignAttr(e,t[t.length-1].value)):a.push(this.obj.assignAttr(e,t[0].value))):this.obj.assignAttr(e,n.value):this.obj.assignAttr(e,t[0].value));return a},t.prototype._hideErrors=function(){var t,e,r,n,o;for(o=[],e=0,r=(n=this.form.querySelectorAll(".errors")).length;e<r;e++)(t=n[e]).textContent.trim().length>0?(t.textContent="",o.push(t.style.display="none")):o.push(void 0);return o},t.prototype._showErrors=function(){var t,e,r,n,o;for(o=[],e=0,r=(n=this.form.querySelectorAll(".errors")).length;e<r;e++)(t=n[e]).textContent.trim().length>0?o.push(t.style.display="block"):o.push(void 0);return o},t.prototype._submittingForm=function(t){if(null==t&&(t=!0),null!=this.submit&&(i(this.submit,"success"),i(this.submit,"failure"),o(this.submit,"active"),this.submit.value=r.I18n[this.locale].ui.form.sending),null!=this.callbackActive&&this.callbackActive(),t)return this._hideErrors()},t.prototype._connectionError=function(){var t;if(null!=this.submit)return i(this.submit,"active"),o(this.submit,"failure"),this.submit.value=r.I18n[this.locale].ui.form.errors.connection,setTimeout((t=this,function(){return t.submit.disabled=!1,i(t.submit,"failure"),t.submit.value=t.submitVal}),3e3)},t.prototype._alwaysAfterRequest=function(){if(null!=this.submit)return i(this.submit,"active")},t}()},c={ui:{form:{sending:"Sending...",success:"Success",errors:{connection:"Connection Error",invalid_data:"Invalid data"}}}};function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function u(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function d(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?u(Object(r),!0).forEach((function(e){m(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function m(t,e,r){return(e=function(t){var e=function(t,e){if("object"!==l(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===l(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var p=function(t){r.getLocale=t.getLocale,r.wire=t.loco.getWire(),r.I18n=t.I18n,r.I18n.en=d(d({},c),r.I18n.en)};return e})(),t.exports=e()},84223:function(t){var e;self,e=()=>(()=>{"use strict";var t={d:(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{connectWithModel:()=>A,init:()=>j,subscribe:()=>O});const r=function(){function t(){}return t.toURIParams=function(t){var e,r,n;for(e in r="",t)n=t[e],""!==r&&(r+="&"),r+=e+"="+encodeURIComponent(n);return r},t}(),n=function(t,e,r){var n=document.querySelector("meta[name='csrf-token']"),o=new XMLHttpRequest;return o.withCredentials=!0===r.cookiesByCORS,o.open(t,e),o.setRequestHeader("Accept","application/json"),n&&o.setRequestHeader("X-CSRF-Token",n.content),null!=r.authorizationHeader&&o.setRequestHeader("Authorization",r.authorizationHeader),o};var o=null,i=null,s=[];const a=function(t){return!!s.includes(t)||(s.unshift(t),s.length>100&&s.pop(),!1)};var c;function l(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=u(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,a=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return s=t.done,t},e:function(t){a=!0,i=t},f:function(){try{s||null==r.return||r.return()}finally{if(a)throw i}}}}function u(t,e){if(t){if("string"==typeof t)return d(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?d(t,e):void 0}}function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}c=function(){var t,e,r,n,o;for(t in r=[],o=/^[A-Z]/,i)if(i[t],o.exec(t)&&"Base"!==t)for(e in r.push(t),n=i[t])n[e],o.exec(e)&&r.push(t+"."+e);return r};var m=function(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;null!=t&&t(null==n?e:{type:n,payload:e},r)};const p=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.log&&console.log(t);var r,n=function(t){if(Array.isArray(t))return t}(r=t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,s,a=[],c=!0,l=!1;try{for(i=(r=r.call(t)).next;!(c=(n=i.call(r)).done)&&(a.push(n.value),4!==a.length);c=!0);}catch(t){l=!0,o=t}finally{try{if(!c&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(l)throw o}}return a}}(r)||u(r,4)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),s=n[0],d=n[1],p=n[2],h=n[3];if(a(h.loco.idempotency_key))return!1;if(delete h.loco,null==s&&null==p)return m(e.notificationCenter,h,e.emit),!0;var f=function(t){var e,r,n,o;for(e=0,r=(o=c()).length;e<r;e++)if(1===(n=o[e].split(".")).length){if(i[n[0]].getRemoteName()===t)return i[n[0]]}else if(2===n.length&&i[n[0]][n[1]].getRemoteName()===t)return i[n[0]][n[1]]}(s);return void 0===f?(m(e.notificationCenter,h,e.emit,"".concat(s," ").concat(p)),!1):(function(t,e,r,n,i,s){var a=t.getIdentity();m(i,n,s,"".concat(a," ").concat(r)),void 0!==o.imap[a]&&(void 0!==o.imap[a][e]&&function(t,e,r,n,i){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;null===s&&(s=new n({id:t}));var a,c=l(o.findConnected(i,t));try{for(c.s();!(a=c.n()).done;)(0,a.value)(e,r)}catch(t){c.e(t)}finally{c.f()}}(e,r,n,t,a),void 0!==o.imap[a].collection&&0!==o.imap[a].collection.length&&function(t,e,r){var n,i=l(o.imap[r].collection.filter((function(t){return null!==t})));try{for(i.s();!(n=i.n()).done;)(0,n.value)("".concat(r," ").concat(t),e)}catch(t){i.e(t)}finally{i.f()}}(r,n,a))}(f,d,p,h,e.notificationCenter,e.emit),!0)};var h;h=function(){function t(t,e,r){var n,o,i,s;this.pollingTime=null!=(n=t.pollingTime)?n:3e3,this.log=!(null==t.log||!t.log),this.ssl=t.ssl,this.location=null!=(o=t.location)?o:"notification-center",this.size=null!=(i=t.size)?i:100,this.protocolWithHost=t.protocolWithHost,this.allowedDisconnectionTime=null!=(s=t.allowedDisconnectionTime)?s:10,this.disconnectedForTooLong=t.disconnectedForTooLong,this.notificationCenter=e,this.reqOpts=r,this.syncTime=null,this.token=null,this.pollingInterval=null,this.disconnectedSinceTime=null,this.uuid=null,this.line=null}return t.prototype.setDisconnectedForTooLong=function(t){return this.disconnectedForTooLong=t},t.prototype.setLine=function(t){return this.line=t},t.prototype.setPollingTime=function(t){var e;if(this.pollingTime=t,!(null!=(e=this.line)?e.isConnected:void 0))return this.disconnect(),this.connect()},t.prototype.connect=function(){return this.check(),this.pollingInterval=setInterval((t=this,function(){var e;if(!(null!=(e=t.line)?e.isConnected:void 0))return t.check();t.disconnect()}),this.pollingTime);var t},t.prototype.disconnect=function(){return window.clearInterval(this.pollingInterval)},t.prototype.check=function(){var t,e;return(t=n("GET",this._getURL()+"?"+r.toURIParams(this._requestParams()),this.reqOpts)).onload=(e=this,function(t){var r,n,o,i,s;if(t.target.status>=200&&t.target.status<400){if(r=JSON.parse(t.target.response),e.disconnectedSinceTime=null,e.syncTime=r[1],0===(s=r[0]).length)return;for(n=0,o=s.length;n<o;n++)i=s[n],p(i,{log:e.log,notificationCenter:e.notificationCenter,emit:e.line.send});if(s.length===e.size)return e.check()}else if(t.target.status>=500)return e._handleDisconnection()}),t.onerror=function(t){return function(){return t._handleDisconnection()}}(this),t.send()},t.prototype.fetchSyncTime=function(t){var e,r;return null==t&&(t={}),(e=n("GET",this._getURL()+"/sync-time",this.reqOpts)).onerror=(r=this,function(){if(null!=t.after)return r[t.after]()}),e.onload=function(e){return function(r){var n;if(r.target.status>=200&&r.target.status<400){if(n=JSON.parse(r.target.response),e.syncTime=n.sync_time,null!=t.after)return e[t.after]()}else if(r.target.status>=500&&null!=t.after)return e[t.after]()}}(this),e.send()},t.prototype._requestParams=function(){var t;return t={synced_at:this.syncTime},null!=this.token&&(t.token=this.token),null!=this.uuid&&(t.uuid=this.uuid),t},t.prototype._getURL=function(){var t,e,r,n;return e=(r=window.location.href.split("/"))[0],r[1],t=r[2],null!=this.protocolWithHost&&(e=(n=this.protocolWithHost.split("//"))[0],t=n[1]),null!=this.ssl&&(e=this.ssl?"https:":"http:"),e+"//"+t+"/"+this.location},t.prototype._handleDisconnection=function(){if(null==this.disconnectedSinceTime&&(this.disconnectedSinceTime=new Date),(new Date-this.disconnectedSinceTime)/1e3>this.allowedDisconnectionTime&&null!=this.disconnectedForTooLong)return this.disconnectedForTooLong(this.disconnectedSinceTime)},t}();const f=h;function y(t){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y(t)}function g(t){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g(t)}function b(t){var e=function(t,e){if("object"!=g(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=g(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==g(e)?e:String(e)}var v=function(){function t(e,r,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.client=e,this.notificationCenter=r,this.wire=n,this.isConnected=!1}var e,r;return e=t,r=[{key:"connect",value:function(){this.client.connect(this)}},{key:"disconnect",value:function(){return this.client.disconnect()}},{key:"send",value:function(t){return!!this.isConnected&&this.client.send(t)}},{key:"pong",value:function(){var t=this;setTimeout((function(){return t.send({loco:{pong:!0}})}),3e3)}},{key:"connected",value:function(){console.log("WS connected"),this.isConnected=!0,null!==this.wire&&this.wire.check(),this.notificationCenter({loco:"connected"}),this.pong()}},{key:"disconnected",value:function(){console.log("WS disconnected"),this.isConnected=!1,null!==this.wire&&(this.wire.uuid=null,this.wire.fetchSyncTime({after:"connect"})),this.notificationCenter({loco:"disconnected"})}},{key:"rejected",value:function(){console.log("WS rejected"),this.notificationCenter({loco:"rejected"})}},{key:"received",value:function(t){if(null!=t.loco){var e=function(t,e){if(!0===t.ping&&e.pong(),null!=e.wire)return"string"==typeof t.sync_time&&(e.wire.syncTime=t.sync_time),"string"==typeof t.uuid&&(console.log("uuid: ".concat(t.uuid)),e.wire.uuid=t.uuid),"object"===y(t.notification)&&"Array"===t.notification.constructor.name&&p(t.notification,{log:e.wire.log,notificationCenter:e.notificationCenter,emit:e.send}),"string"!=typeof t.idempotency_key||!a(t.idempotency_key)}(t.loco,this);if(!0!==e)return;delete t.loco}0!==Object.keys(t).length&&this.notificationCenter(t)}}],r&&function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,b(n.key),n)}}(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();const _=v;function w(t){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},w(t)}function E(t){var e=function(t,e){if("object"!=w(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=w(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==w(e)?e:String(e)}var S=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.consumer=e,this.subscription=null}var e,r;return e=t,r=[{key:"connect",value:function(t){this.subscription=this.consumer.subscriptions.create({channel:"Loco::NotificationCenterChannel"},{connected:function(){t.connected()},disconnected:function(){t.disconnected()},rejected:function(){t.rejected()},received:function(e){t.received(e)}})}},{key:"disconnect",value:function(){this.consumer.disconnect()}},{key:"send",value:function(t){this.subscription.send(t)}}],r&&function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,E(n.key),n)}}(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();const k=S,I=function(){function t(t){this.models=t,this.wire=null,this.line=null}return t.prototype.getModels=function(){return this.models},t.prototype.getLine=function(){return this.line},t.prototype.getWire=function(){return this.wire},t.prototype.setAuthorizationHeader=function(t){var e,r,n,o;for(e in o=[],n=this.models)r=n[e],o.push(r.authorizationHeader=t);return o},t.prototype.setDisconnectedForTooLong=function(t){return this.wire.setDisconnectedForTooLong(t)},t.prototype.init=function(t){var e,r,n,o;return(e=null!=(r=t.notifications)?r:{}).protocolWithHost=t.protocolWithHost,!1!==e.enable&&(n={cookiesByCORS:t.cookiesByCORS,authorizationHeader:t.authorizationHeader},this.wire=new f(e,t.notificationCenter,n),this.wire.fetchSyncTime({after:"connect"})),null!=(o=this._initWsClient(t))&&(this.line=new _(o,t.notificationCenter,this.wire),this.line.connect(),null!=this.wire&&this.wire.setLine(this.line)),this._ready((function(){if(null!=t.postInit)return t.postInit()}))},t.prototype.emit=function(t){return this.line.send(t)},t.prototype._initWsClient=function(t){return null!=t.wsClient?t.wsClient:null!=t.cable?new k(t.cable):null},t.prototype._ready=function(t){return(document.attachEvent?"complete"===document.readyState:"loading"!==document.readyState)?t():document.addEventListener("DOMContentLoaded",t)},t}();var j=function(t){var e=function(t){var e=t.models||{};if(null===i)return e;for(var r=0,n=Object.keys(e);r<n.length;r++){var o=n[r];i[o]=e[o]}return e}(t),r=new I(e);return r.init(t),r},O=function(){},A=function(t){var e,r;e=t.IdentityMap,(o=e).clear(),r=t.Models,i=r,O=t.IdentityMap.subscribe};return e})(),t.exports=e()},48244:function(t,e,r){"use strict";r(84315),r(96519).A.start(),r(8559),document.addEventListener("turbo:before-render",(t=>{const{namespace:e,controller:r,action:n}=t.detail.newBody.dataset;document.body.dataset.namespace=e,document.body.dataset.controller=r,document.body.dataset.action=n}));var n=r(35742),o=r(78443),i=class{setScope(t){o.Config.scope=t}},s=r(96540),a=r(40961);const c="ADD_ARTICLES",l="PREPEND_ARTICLES",u="REMOVE_ARTICLE",d="SET_ARTICLES",m="UPDATE_ARTICLE",p="ADD_COMMENTS",h="REMOVE_COMMENT",f="SET_COMMENTS",y="UPDATE_COMMENT",g="PREPEND_USERS";function b(t){return{type:c,articles:t}}function v(t){return{type:d,articles:t}}function _(t,e){return{type:m,article:t,index:e}}function w(t,e){return{type:f,comments:t,articleId:e}}function E(t,e,r){return{type:y,comment:t,articleId:e,index:r}}var S=r(82960),k=r(16535),I=(0,k.Ay)(((t=[],e)=>{switch(e.type){case c:{const r=e.articles.filter((e=>!t.some((t=>t.id===e.id))));return void t.push(...r)}case l:return e.articles.concat(t);case u:return t.filter((t=>t.id!==e.id));case d:return e.articles;case m:t[e.index]=e.article;break;default:return t}})),j=(0,k.Ay)(((t={},e)=>{switch(e.type){case p:void 0===t[e.articleId]&&(t[e.articleId]=[]),t[e.articleId]=t[e.articleId].concat(e.comments);break;case h:if(null==t[e.articleId])return t;t[e.articleId]=t[e.articleId].filter((t=>t.id!==e.id));break;case f:t[e.articleId]=e.comments;break;case y:{const r=e.articleId;let n=e.index;if(!n){const o=t[r].find((t=>t.id===e.comment.id));n=t[r].indexOf(o)}t[r][n]=e.comment;break}default:return t}})),O=(0,k.Ay)(((t=[],e)=>{switch(e.type){case"SET_USERS":return e.users;case g:return e.users.concat(t);default:return t}})),A=(0,S.HY)({articles:I,comments:j,users:O}),T=(0,S.y$)(A);class C extends o.Models.Base{static identity="Article";static resources={url:"/user/articles",paginate:{per:5},main:{url:"/articles",paginate:{per:3}},admin:{url:"/admin/articles",paginate:{per:4}}};static attributes={title:{validations:{presence:!0,length:{within:[3,255]}}},content:{validations:{presence:!0,length:{minimum:100}},remoteName:"text"},createdAt:{type:"Date",remoteName:"created_at"},updatedAt:{type:"Date",remoteName:"updated_at"},commentsCount:{type:"Int",remoteName:"comments_count"},publishedAt:{type:"Date",remoteName:"published_at"},published:{},adminReview:{remoteName:"admin_review"},adminRate:{type:"Int",remoteName:"admin_rate"},categoryId:{type:"Int",remoteName:"category_id"},adminReviewStartedAt:{remoteName:"admin_review_started_at"}};static validate=["vulgarityLevel"];constructor(t){super(t),this.published=null!=this.publishedAt}vulgarityLevel(){(null!=this.title&&/fuck/i.exec(this.title)||null!=this.content&&/fuck/i.exec(this.content))&&this.addErrorMessage("Article contains strong language.",{for:"base"})}setDefaultValuesForAdminReview(){this.adminRate=null==this.adminRate?3:this.adminRate,this.categoryId=null==this.categoryId?6:this.categoryId,this.adminReviewStartedAt=Date.now()}}var M=C;class R extends o.Models.Base{static identity="Article.Comment";static remoteName="Comment";static resources={url:"/user/articles/:articleId/comments",paginate:{per:10},main:{url:"/articles/:articleId/comments",paginate:{per:5,param:"page-num"}},admin:{url:"/admin/articles/:articleId/comments",paginate:{per:5}}};static attributes={author:{validations:{presence:!0}},text:{validations:{presence:!0,vulgarity:!0}},articleId:{type:"Int",validations:{presence:!0},remoteName:"article_id"},createdAt:{type:"Date",remoteName:"created_at"},updatedAt:{type:"Date",remoteName:"updated_at"},emotion:{type:"Int"},pinned:{type:"Boolean"},adminRate:{type:"Int",remoteName:"admin_rate"},approved:{type:"Boolean"}};constructor(t){super(t)}}var P=R,N=r(84223),q=r(5556),x=r.n(q),z=class{constructor(t,e=o.Config.locale){this.date=t,this.skope=o.I18n[e].date}toString(t="default"){const e=this.skope.formats;switch(t){case"default":return this.strftime(e.default);case"short":return this.strftime(e.short);case"long":return this.strftime(e.long);default:console.log("Services.Date#toString: unknown format.")}}strftime(t){t=(t=t.replace("%Y",this.date.getFullYear())).replace("%y",this.date.getFullYear().toString().substr(-2,2));let e=this.date.getMonth()+1;return e=e>=10?e:`0${e}`,(t=(t=(t=(t=(t=(t=t.replace("%m",e)).replace("%b",this.skope.abbr_month_names[this.date.getMonth()])).replace("%B",this.skope.month_names[this.date.getMonth()])).replace("%d",this.date.getDate()>=10?this.date.getDate():`0${this.date.getDate()}`)).replace("%H",this.date.getHours()>=10?this.date.getHours():`0${this.date.getHours()}`)).replace("%M",this.date.getMinutes()>=10?this.date.getMinutes():`0${this.date.getMinutes()}`)).replace("%S",this.date.getSeconds()>=10?this.date.getSeconds():`0${this.date.getSeconds()}`)}};function L({comment:t}){const e=new z(t.createdAt).strftime("%d %b %y");return s.createElement("p",{id:`comment_${t.id}`},s.createElement("b",null,t.author)," on ",s.createElement("i",null,e)," (",s.createElement("a",{href:`/admin/articles/${t.articleId}/comments/${t.id}/edit`},"edit"),")",s.createElement("br",null),t.text)}L.propTypes={comment:x().instanceOf(P).isRequired};var B=L;function D({comments:t}){return 0===t.length?s.createElement("p",null,"No comments"):s.createElement(s.Fragment,null,t.map((t=>s.createElement(B,{comment:t,key:t.id}))))}D.propTypes={comments:x().arrayOf(x().instanceOf(P)).isRequired};var F=D;const $=t=>{document.getElementById("article_author").textContent=t.author,document.getElementById("article_title").textContent=t.title,document.getElementById("article_text").textContent=t.content},H=t=>async function(e){if("updated"===e){const e=await t.reload();$(e)}};var U=r(21927);function W({article:t}){const e=new z(t.publishedAt).toString("short");return s.createElement("article",{id:`article_${t.id}`},s.createElement("h2",null,t.title),s.createElement("p",null,s.createElement("i",null,t.author," wrote this on ",e," /"," ",s.createElement("span",{className:"comments_quantity"},t.commentsCount," comment",1===t.commentsCount?"":"s"))),s.createElement("p",null,t.content),s.createElement("p",null,s.createElement("a",{href:`/admin/articles/${t.id}/edit`},"Review")))}W.propTypes={article:x().instanceOf(M).isRequired};var V=W;function J(t){const[e,r]=(0,s.useState)(t.articles);(0,s.useEffect)((()=>{const t=T.subscribe((()=>r(T.getState().articles)));return()=>{t()}}),[]);const n=e.map((t=>s.createElement(V,{key:t.id,article:t})));return s.createElement(s.Fragment,null,n)}J.propTypes={articles:x().arrayOf(x().instanceOf(M)).isRequired};var G=J;const Y=async()=>{const t=await M.find(n.helpers.params.id);(t=>{(0,N.subscribe)({to:t,with:H(t)}),$(t)})(t),(t=>{t.setDefaultValuesForAdminReview(),new U.UI.Form({id:"edit_article_form",for:t}).render()})(t)};const X=()=>window.location.href="/admin";class Z extends o.Models.Base{static identity="User";static resources={url:"/users",admin:{url:"/admin/users"}};static paginate={per:10};static attributes={email:{validations:{presence:!0,format:{with:/^([^@\s]+)@((?:[-a-z0-9]+\.)+[a-z]{2,})$/i}}},username:{validations:{presence:!0,format:{with:/^[a-z][a-z0-9_-]*$/i}}},password:{validations:{presence:{on:"create"},confirmation:!0}},passwordConfirmation:{remoteName:"password_confirmation"},confirmed:{},createdAt:{type:"Date",remoteName:"created_at"},updatedAt:{type:"Date",remoteName:"updated_at"}};constructor(t){super(t)}}var K=Z,Q=r(5997);const tt=t=>function(e,r,n={}){let o=e[t];if(n.parentId&&(o=o[n.parentId]),void 0===o)return[null,null];const i=o.find((t=>t.id===r));return i?[i,o.indexOf(i)]:[null,null]},et=tt("articles"),rt=tt("comments"),nt=(t,e)=>t.comments[e];function ot({comment:t}){const e=new z(t.createdAt).strftime("%d %b %y");return s.createElement("p",{id:`comment_${t.id}`},s.createElement("b",null,t.author)," on ",s.createElement("i",null,e)," wrote:",s.createElement("br",null),t.text)}ot.propTypes={comment:x().instanceOf(P).isRequired};var it=ot;function st(t){const e=t.articleId,[r,n]=(0,s.useState)(t.comments);(0,s.useEffect)((()=>{const t=T.subscribe((()=>{n(nt(T.getState(),e))}));return()=>{t()}}),[]);const o=r.map((t=>s.createElement(it,{key:t.id,comment:t})));return 0===r.length?s.createElement("p",{id:"no_comments"},"No comments."):s.createElement(s.Fragment,null,o)}st.propTypes={articleId:x().number.isRequired,comments:x().arrayOf(x().instanceOf(P)).isRequired};var at=st;function ct(t){const[e,r]=(0,s.useState)(t.comments);return(0,s.useEffect)((()=>{const e=T.subscribe((()=>{r(nt(T.getState(),t.articleId))}));return()=>{e()}}),[]),s.createElement(s.Fragment,null,`${e.length} comment${1===e.length?"":"s"}`)}ct.propTypes={articleId:x().number.isRequired,comments:x().arrayOf(x().instanceOf(P)).isRequired};var lt=ct;const ut=(t,e,r)=>{null!=t[e]&&(r.classList.add(e),document.querySelector(".flash p").textContent=t[e])};var dt=(t={})=>{const{hide:e}=t,r=document.querySelector(".flash");(t=>{t.classList.remove("notice"),t.classList.remove("alert"),t.classList.remove("warning")})(r),ut(t,"notice",r),ut(t,"alert",r),ut(t,"warning",r),r.classList.remove("none"),e&&((t=4e3)=>{setTimeout((()=>{document.querySelector(".flash").classList.add("none")}),t)})()};const mt=t=>async function(e){switch(e){case"updating":dt({warning:"Author is currently editing article. Be aware of possible changes."});break;case"updated":{const e=await t.reload();pt(e,!0)}}},pt=(t,e=!1)=>{!1===e&&(0,N.subscribe)({to:t,with:mt(t)}),document.getElementById("title").textContent=t.title,document.getElementById("author").textContent=t.author;const r=new z(t.publishedAt);document.getElementById("pub_date").textContent=r.toString("short");const n=document.getElementById("text");n.innerHTML="";const o=((i=(i=(i=t.content).replace(/\r\n?/,"\n")).trim()).length>0&&(i="<p>"+(i=(i=i.replace(/\n\n+/g,"</p><p>")).replace(/\n/g,"<br>"))+"</p>"),i);var i;n.insertAdjacentHTML("beforeend",o)};var ht={renderArticle:pt,renderForm:t=>{new U.UI.Form({for:t,initObj:!0,id:"new_comment"}).render()}};function ft(){const[t,e]=(0,s.useState)(1),[r,n]=(0,s.useState)(!1);return r?s.createElement("span",null,"No more posts."):s.createElement("a",{href:"#",id:"load_more",onClick:async function(r){r.preventDefault();const o=t+1;e(o);let i=null;try{i=await M.get("all",{page:o})}catch(r){return void alert(`Invalid URL: ${r}`)}i.resources.length>0?T.dispatch(b(i.resources)):n(!0)}},"Load more…")}function yt({article:t}){const e=new z(t.publishedAt).toString("short");return s.createElement("article",{id:`article_${t.id}`},s.createElement("h2",null,t.title),s.createElement("p",null,s.createElement("i",null,t.author," wrote this on ",e," /"," ",s.createElement("a",{href:`/articles/${t.id}#comments`,className:"comments_quantity"},t.commentsCount," comment",1===t.commentsCount?"":"s"))),s.createElement("p",null,t.content),s.createElement("p",null,s.createElement("a",{href:`/articles/${t.id}`},"Continued…")))}yt.propTypes={article:x().instanceOf(M).isRequired};var gt=yt;function bt(t){const[e,r]=(0,s.useState)(t.articles);(0,s.useEffect)((()=>{const t=T.subscribe((()=>r(T.getState().articles)));return()=>{t()}}),[]);const n=e.map((t=>s.createElement(gt,{key:t.id,article:t})));return s.createElement(s.Fragment,null,n)}bt.propTypes={articles:x().arrayOf(x().instanceOf(M)).isRequired};var vt=bt;const _t=t=>{switch(t){case"confirming":document.getElementById("verification_info").textContent=document.getElementById("verification_progress").textContent;break;case"confirmed":window.location.href="/user/sessions/new?event=confirmed"}},wt=t=>{te.getWire().token=t.access_token,(0,N.subscribe)({to:new K({id:t.id}),with:_t}),document.querySelector("form").style.display="none",document.getElementById("sign_in_paragraph").classList.remove("none"),document.getElementById("verification_info").classList.remove("none"),dt({notice:t.notice})};class Et extends i{initialize(){this.setScope("main")}}Et.Articles=class{async show(){const t=new P({articleId:n.helpers.params.id});ht.renderForm(t),(async()=>{const t=await M.find(n.helpers.params.id);T.dispatch(v([t])),ht.renderArticle(t)})(),(async()=>{const t=await P.get("count",{articleId:n.helpers.params.id}),e=await P.all({articleId:n.helpers.params.id,total:t.total});T.dispatch(w(e,n.helpers.params.id)),(0,a.render)(s.createElement(at,{articleId:n.helpers.params.id,comments:e}),document.getElementById("comments")),(0,a.render)(s.createElement(lt,{articleId:n.helpers.params.id,comments:e}),document.getElementById("comments_count"))})()}},Et.Pages=class{async index(){(0,a.render)(s.createElement(ft,null),document.getElementById("load_more_wrapper"));const t=await M.get("all",{page:1});T.dispatch(v(t.resources)),(0,a.render)(s.createElement(vt,{articles:t.resources}),document.getElementById("articles"))}},Et.Users=class{new(){new U.UI.Form({for:new K,callbackSuccess:wt}).render()}};var St=Et;class kt extends o.Models.Base{static identity="Room.Member";static resources={url:"/user/rooms/:roomId/members",paginate:{per:100}};constructor(t){super(t)}}var It=kt;class jt extends o.Models.Base{static identity="Room";constructor(t){super(t)}}var Ot=jt,At=()=>{const t=document.getElementById("current-user-data");return JSON.parse(t.textContent)};const Tt={rooms:[]},Ct=({id:t,name:e,members_count:r,joined:n})=>`\n  <tr id="room_${t}">\n    <td>${e}</td>\n    <td class="members">${r}</td>\n    <td>\n      <a\n        rel="nofollow"\n        data-method="patch"\n        href="${n?`/user/rooms/${t}/leave`:`/user/rooms/${t}/join`}"\n      >\n        ${n?"Leave":"Join"}\n      </a>\n      |\n      <a\n        rel="nofollow"\n        data-method="delete"\n        data-confirm="R U sure?"\n        href="/user/rooms/${t}"\n      >\n        Destroy\n      </a>\n    </td>\n  </tr>\n  `,Mt=t=>{const e=Tt.rooms.find((e=>e.id===t));document.getElementById(`room_${t}`).innerHTML=Ct(e)},Rt=(t,e)=>{switch(t){case"Room member_joined":{const t=Tt.rooms.find((t=>t.id===e.room_id));t.members_count++,e.member.id===At().id&&(t.joined=!0),Mt(e.room_id);break}case"Room member_left":{const t=Tt.rooms.find((t=>t.id===e.room_id));t.members_count--,e.member.id===At().id&&(t.joined=!1),Mt(e.room_id);break}case"Room created":document.querySelector("#rooms_list tbody").insertAdjacentHTML("beforeend",Ct(e.room));break;case"Room destroyed":{const t=document.getElementById(`room_${e.room_id}`);t.parentNode.removeChild(t)}}};const Pt=t=>{if(document.querySelector(`#members li#user_${t.id}`))return;const e=`<li id='user_${t.id}'>${t.username}</li>`;document.getElementById("members").insertAdjacentHTML("beforeend",e)},Nt=t=>function(e,r){switch(e){case"Room member_joined":if(r.room_id!==t)return;Pt(r.member);break;case"Room member_left":if(r.room_id!==t)return;(t=>{const e=document.querySelector(`#members li#user_${t.id}`);e.parentNode.removeChild(e)})(r.member)}};var qt=(t,e)=>{const r=`<p class="msg"><b>${e}</b>: ${t}</p>`;document.getElementById("messages").insertAdjacentHTML("beforeend",r)},xt=class{constructor(){this.callbacks={}}deinitialize(){this.unsubscribe()}index(){this.unsubscribe=function(){console.log(">>> CurrentUser",At());let t=document.getElementById("rooms-data");return Tt.rooms=JSON.parse(t.textContent),(()=>{const t=document.querySelector("#rooms_list tbody");Tt.rooms.forEach((e=>{t.insertAdjacentHTML("beforeend",Ct(e))}))})(),(0,N.subscribe)({to:Ot,with:Rt})}()}async show(){this.callbacks.receivedMessage=qt,this.unsubscribe=(t=>{(t=>{document.querySelector("[data-behavior~=room-speaker]").addEventListener("keypress",(e=>{13===e.keyCode&&(e.preventDefault(),te.emit({type:"NEW_MESSAGE",txt:e.target.value,room_id:t,message_type:document.querySelector("[name='message_type']:checked").value}),e.target.value="")}))})(t);const e=(t=>{const e=setInterval((()=>{te.emit({type:"HEARTBEAT",room_id:t}),console.log("heartbeat",t)}),3e3);return()=>clearInterval(e)})(t),r=(0,N.subscribe)({to:Ot,with:Nt(t)});return()=>{e(),r()}})(n.helpers.params.id);(t=>{for(const e of t)Pt(e)})((await It.all({roomId:n.helpers.params.id})).resources)}};const zt=t=>{document.getElementById("article_title").textContent=t.title,document.getElementById("article_text").textContent=t.content;const e=document.getElementById("publish_article");e&&null!=t.publishedAt?e.style.display="none":e&&(e.style.display="")},Lt=t=>async function(e){switch(e){case"updated":await t.reload(),t.applyChanges(),zt(t);break;case"destroyed":window.location.href="/user/articles?message=deleted"}};function Bt({comment:t,isAdmin:e=!1}){const[r,n]=(0,s.useState)(!1),o=new z(t.createdAt).strftime("%d %b %y"),i=async e=>{e.preventDefault(),n(!0),t.approved=!0,(await t.updateAttribute("approved")).ok&&T.dispatch(E(new P({...t,approved:!0}),t.articleId))};return s.createElement("p",{id:`comment_${t.id}`},s.createElement("b",null,t.author)," on ",s.createElement("i",null,o),e?(()=>{let e;return e=t.approved?s.createElement(s.Fragment,null,s.createElement("span",null,"approved")," |"," "):r?s.createElement(s.Fragment,null,s.createElement("span",null,"approving...")," |"," "):s.createElement(s.Fragment,null,s.createElement("a",{href:`/user/articles/${t.articleId}/comments/${t.id}/approve`,className:"approve",onClick:i},"approve")," ","|"," "),s.createElement(s.Fragment,null," ","(",e,s.createElement("a",{href:`/user/articles/${t.articleId}/comments/${t.id}/edit`},"edit")," ","|"," ",s.createElement("a",{href:`/user/articles/${t.articleId}/comments/${t.id}`,"data-method":"delete","data-confirm":"Are you sure?"},"delete"),")")})():"",s.createElement("br",null),t.text)}Bt.propTypes={comment:x().instanceOf(P).isRequired,isAdmin:x().bool};var Dt=Bt;function Ft(t){const e=t.articleId,r=t.isAdmin||!1,[n,o]=(0,s.useState)(t.comments);if((0,s.useEffect)((()=>{const t=T.subscribe((()=>o(nt(T.getState(),e))));return()=>{t()}}),[]),0===n.length)return s.createElement("p",null,"No comments.");const i=n.map((t=>s.createElement(Dt,{key:t.id,comment:t,isAdmin:r})));return s.createElement(s.Fragment,null,i)}Ft.propTypes={articleId:x().number.isRequired,isAdmin:x().bool,comments:x().arrayOf(x().instanceOf(P)).isRequired};var $t=Ft;const Ht=t=>async function(e,r){switch(e){case"updating":document.querySelector("h1").getAttribute("data-mark")!==r.mark&&dt({warning:"Uuups someone else started editing this article."});break;case"updated":await t.reload(),(t=>{for(const[e]of Object.entries(t.changes())){const r=document.querySelector(`a.apply_changes[data-for=${t.getAttrRemoteName(e)}]`);r&&r.classList.remove("none")}})(t);break;case"destroyed":window.location.href="/user/articles?message=deleted"}};var Ut=t=>{T.dispatch(b([t]));const e=(0,N.subscribe)({to:t,with:Ht(t)}),r=new U.UI.Form({for:t});return r.render(),(t=>{for(const e of Array.from(document.querySelectorAll("a.apply_changes")))e.addEventListener("click",(e=>{e.preventDefault();const r=t.getObj(),n=r.getAttrName(e.target.getAttribute("data-for"));r[n]=r.changes()[n].is,t.fill(n),e.target.classList.add("none")}))})(r),e};function Wt({article:t,onArticleDestroyed:e}){return s.createElement("tr",{id:`article_${t.id}`},s.createElement("td",null,t.title),s.createElement("td",null,t.content),s.createElement("td",{className:"comments_quantity"},t.commentsCount),s.createElement("td",{className:"published"},t.publishedAt?"yes":"no"),s.createElement("td",null,s.createElement("a",{href:`/user/articles/${t.id}`},"Show")," |",s.createElement("a",{href:`/user/articles/${t.id}/edit`},"Edit")," |",s.createElement("a",{href:`/user/articles/${t.id}`,className:"delete_article",onClick:async r=>{if(r.preventDefault(),!confirm("Are you sure?"))return;const n=await t.delete(null);var o;n.success&&T.dispatch((o=n.id,{type:u,id:o})),e(n)}},"Delete")))}Wt.propTypes={article:x().instanceOf(M).isRequired,onArticleDestroyed:x().func.isRequired};var Vt=Wt;function Jt(t){const[e,r]=(0,s.useState)(t.articles);(0,s.useEffect)((()=>{const t=T.subscribe((()=>r(T.getState().articles)));return()=>{t()}}),[]);const n=e.map((e=>s.createElement(Vt,{key:e.id,article:e,onArticleDestroyed:t.onArticleDestroyed})));return s.createElement(s.Fragment,null,n)}Jt.propTypes={articles:x().arrayOf(x().instanceOf(M)).isRequired,onArticleDestroyed:x().func.isRequired};var Gt=Jt;const Yt=t=>{t.success?dt({notice:t.notice}):dt({alert:t.alert})};class Xt extends i{initialize(){this.setScope(null)}}Xt.Articles=class{initialize(){this.unsubscribe=null}deinitialize(){null!==this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null)}async index(){"deleted"===n.helpers.params.message&&dt({alert:"Article has been deleted."});const t=await M.get("all");T.dispatch(v(t.resources)),(0,a.render)(s.createElement(Gt,{articles:t.resources,onArticleDestroyed:Yt}),document.getElementById("article_list"))}show(){(async()=>{const t=await M.find(n.helpers.params.id);T.dispatch(v([t])),(t=>{null!==t&&((0,N.subscribe)({to:t,with:Lt(t)}),(t=>{document.getElementById("publish_article").addEventListener("click",(async e=>{e.preventDefault(),e.target.textContent="Publishing...";try{await t.put("publish"),document.getElementById("publish_article").outerHTML="<span>Published!</span>"}catch(t){document.getElementById("publish_article").textContent="Publish",dt({alert:"Connection error!"})}}))})(t),(t=>{const e=document.getElementById("edit_link").getAttribute("href");document.getElementById("edit_link").setAttribute("href",e.replace("/0/",`/${t}/`))})(t.id),zt(t))})(t)})(),(async()=>{const t=await P.all({articleId:n.helpers.params.id});T.dispatch(w(t.resources,n.helpers.params.id)),(0,a.render)(s.createElement($t,{articleId:n.helpers.params.id,comments:t.resources}),document.getElementById("comments"))})()}new(){this.unsubscribe=Ut(new M)}async edit(){(async t=>{const e=await P.all({articleId:t});T.dispatch(w(e.resources,t)),(0,a.render)(s.createElement($t,{articleId:t,comments:e.resources,isAdmin:!0}),document.getElementById("comments"))})(n.helpers.params.id);const t=await M.find(n.helpers.params.id);this.unsubscribe=Ut(t)}},Xt.Rooms=xt;var Zt=Xt;const Kt=({article_id:t},e)=>{const[r,n]=et(T.getState(),t);if(!r)return;const o=new M({...r,commentsCount:r.commentsCount+e});T.dispatch(_(o,n))};(0,N.connectWithModel)(o.connector),M.Comment=P,Ot.Member=It;const Qt=(0,N.init)({cable:(0,Q.Be)(),models:{Article:M,Room:Ot,User:K},notificationCenter:async t=>{switch(t.type){case"PING":le().namespaceController.constructor===Zt&&alert("Ping!");break;case"NEW_MESSAGE":(le().namespaceController.constructor!==Zt||le().controller.constructor!==xt||"show"!==le().action?()=>{}:le().controller.callbacks.receivedMessage)(t.message,t.author);break;case"Article created":(async({id:t})=>{if(le().namespaceController.constructor!==Zt)return;const e=await M.find({id:t,abbr:!0});T.dispatch(b([e]))})(t.payload);break;case"Article published":(async({id:t})=>{if(le().namespaceController.constructor===se){const e=await M.find({id:t,abbr:!0,resource:"admin"});T.dispatch(function(t){return{type:l,articles:t}}([e]))}else{const e=await M.find({id:t,abbr:!0});T.dispatch(b([e]))}})(t.payload);break;case"Article updated":(async({id:t})=>{const e={id:t,abbr:!0};le().namespaceController.constructor===se&&(e.resource="admin");let[r,n]=et(T.getState(),t);r&&(r=await M.find(e),T.dispatch(_(r,n)))})(t.payload);break;case"Article.Comment created":(async({article_id:t,id:e})=>{const r={articleId:t,id:e};le().namespaceController.constructor===St&&(r.resource="main");const[n]=et(T.getState(),t);if(!n)return;const o=await P.find(r);null!==o&&(T.dispatch(function(t,e){return{type:p,articleId:e,comments:t}}([o],t)),Kt({article_id:t},1))})(t.payload);break;case"Article.Comment destroyed":Kt(t.payload,-1),(({article_id:t,id:e})=>{T.dispatch(function(t,e){return{type:h,id:t,articleId:e}}(e,t))})(t.payload);break;case"Article.Comment updated":(async({article_id:t,id:e})=>{const[r,n]=rt(T.getState(),e,{parentId:t});if(!r)return;const o=await r.reload();T.dispatch(E(o,t,n))})(t.payload);break;case"USER_CONFIRMED":window.location.href="/user/sessions/new?event=confirmed";break;case"User created":{const e=await K.find(t.payload.id);T.dispatch(function(t){return{type:g,users:t}}([e]));break}}},notifications:{log:!0,size:10,disconnectedForTooLong:()=>{dt({alert:"You have been disconnected from the server for too long. Reload page!",hide:!1})}},postInit:()=>{"test"===document.querySelector("body").getAttribute("data-rails-env")&&Qt.getWire().setPollingTime(1e3)}});var te=Qt;const ee=({user:t})=>s.createElement("tr",{id:`user_${t.id}`},s.createElement("td",null,t.email),s.createElement("td",null,t.username),s.createElement("td",{className:"confirmed"},t.confirmed?"Yes":"No"),s.createElement("td",null,s.createElement("a",{href:`/admin/users/${t.id}`},"Show")," |"," ",s.createElement("a",{href:`/admin/users/${t.id}/edit`},"Edit")," |"," ",s.createElement("a",{href:`/admin/users/${t.id}`,"data-method":"delete","data-confirm":"Are you sure?"},"Delete")," ","|"," ",s.createElement("a",{href:"#",onClick:e=>((t,e)=>{t.preventDefault(),te.emit({type:"PING",user_id:e})})(e,t.id)},"Ping")));ee.propTypes={user:x().instanceOf(K).isRequired};var re=ee;function ne(t){const[e,r]=(0,s.useState)(t.users);(0,s.useEffect)((()=>{const t=T.subscribe((()=>r(T.getState().users)));return()=>{t()}}),[]);const n=e.map((t=>s.createElement(re,{key:`user_${t.id}`,user:t})));return s.createElement(s.Fragment,null,n)}ne.propTypes={users:x().arrayOf(x().instanceOf(K)).isRequired};var oe=ne;class ie extends i{initialize(){this.setScope("admin")}}ie.Articles=class{async published(){const t=await M.get("published");T.dispatch(v(t.resources)),(0,a.render)(s.createElement(G,{articles:t.resources}),document.getElementById("articles"))}async edit(){Y(),(async()=>{(t=>{(0,a.render)(s.createElement(F,{comments:t}),document.getElementById("comments"))})((await P.all({articleId:n.helpers.params.id})).resources)})()}},ie.Comments=class{edit(){((t={})=>{const e=new U.UI.Form({for:new P({id:t.commentId,resource:"admin"}),id:`edit_comment_${t.commentId}`,initObj:!0});e.render(),window.test={commentFormObj:e.getObj()}})({commentId:n.helpers.params.id})}},ie.Sessions=class{new(){new U.UI.Form({id:"sign_in_admin",callbackSuccess:X}).render()}},ie.Users=class{async index(){const t=await K.get("all");T.dispatch(function(t){return{type:g,users:t}}(t.resources)),(0,a.render)(s.createElement(oe,{users:t.resources}),document.querySelector("table tbody"))}async show(){(t=>{document.getElementById("user_email").textContent=t.email,document.getElementById("user_username").textContent=t.username,document.getElementById("user_confirmed").textContent=t.confirmed?"Yes":"No",(t=>{const e=document.getElementById("edit_link"),r=e.getAttribute("href");e.setAttribute("href",r.replace("/0/",`/${t.id}/`))})(t)})(await K.find(n.helpers.params.id))}edit(){var t;t=new K({id:n.helpers.params.id}),new U.UI.Form({for:t,initObj:!0,id:"admin_user_form"}).render()}};var se=ie;const ae={Admin:se,Main:St,User:Zt};let ce=null;["turbo:click","turbo:submit-start"].forEach((t=>{document.addEventListener(t,(()=>{null!==ce&&null!=ce.controller.cleanup&&(ce.controller.cleanup(),ce.controller.cleanup=null)}))})),document.addEventListener("turbo:load",(()=>{ce=(0,n.init)(ae)}));var le=()=>ce;(0,U.connect)({getLocale:()=>o.Config.locale,loco:te,I18n:o.I18n}),o.Validators.Vulgarity=class extends o.Validators.Base{static identity="Vulgarity";constructor(){super()}validate(){if(null!=this.val)switch(typeof this.val){case"string":{const t=this._getVulgarWord();if(!new RegExp(`${t}`,["i"]).exec(this.val))return;this._addErrorMessage();break}default:throw new TypeError(`Vulgarity validator is applicable only for strings and ${this.attr} isn't.`)}}_addErrorMessage(){const t=o.I18n[o.Config.locale].errors.messages.vulgarity;this.obj.addErrorMessage(t,{for:this.attr})}_getVulgarWord(){switch(o.Config.locale){case"pl":return"kurwa";case"en":return"fuck"}}},o.I18n.pl={variants:{few(t){const e=parseInt((r=String(t))[r.length-1]);var r;-1!==[2,3,4].indexOf(e)&&(2!==String(t).length||String(t)[0])}},models:{},attributes:{},ui:{form:{sending:"Wysyłam...",success:"Sukces",errors:{connection:"Błąd z połączeniem",invalid_data:"Nieprawidłowe dane"}}},date:{formats:{default:"%d-%m-%Y",short:"%d %b",long:"%B %d, %Y"},day_names:["niedziela","poniedziałek","wtorek","środa","czwartek","piątek","sobota"],abbr_day_names:["nie","pon","wto","śro","czw","pią","sob"],month_names:["styczeń","luty","marzec","kwiecień","maj","czerwiec","lipiec","sierpień","wrzesień","październik","listopad","grudzień"],abbr_month_names:["sty","lut","mar","kwi","maj","cze","lip","sie","wrz","paź","lis","gru"]},errors:{messages:{accepted:"musi zostać zaakceptowane",blank:"nie może być puste",confirmation:"nie zgadza się z polem %{attribute}",empty:"nie może być puste",equal_to:"musi być równe %{count}",even:"musi być parzyste",exclusion:"jest zarezerwowane",greater_than:"musi być większe od %{count}",greater_than_or_equal_to:"musi być większe lub równe %{count}",inclusion:"nie znajduje się na liście dopuszczalnych wartości",invalid:"jest nieprawidłowe",less_than:"musi być mniejsze od %{count}",less_than_or_equal_to:"musi być mniejsze lub równe %{count}",not_a_number:"nie jest liczbą",not_an_integer:"musi być liczbą całkowitą",odd:"musi być nieparzyste",present:"musi być puste",too_long:{few:"jest za długie (maksymalnie %{count} znaki)",many:"jest za długie (maksymalnie %{count} znaków)",one:"jest za długie (maksymalnie jeden znak)",other:"jest za długie (maksymalnie %{count} znaków)"},too_short:{few:"jest za krótkie (przynajmniej %{count} znaki)",many:"jest za krótkie (przynajmniej %{count} znaków)",one:"jest za krótkie (przynajmniej jeden znak)",other:"jest za krótkie (przynajmniej %{count} znaków)"},wrong_length:{few:"ma nieprawidłową długość (powinna wynosić %{count} znaki)",many:"ma nieprawidłową długość (powinna wynosić %{count} znaków)",one:"ma nieprawidłową długość (powinna wynosić jeden znak)",other:"ma nieprawidłową długość (powinna wynosić %{count} znaków)"},other_than:"musi być inna niż %{count}"}}},o.I18n.pl.models.User="Użytkownik",o.I18n.pl.attributes.User={password:"Hasło",passwordConfirmation:"Powtórz hasło"},o.I18n.en.errors.messages.vulgarity="contains strong language.",o.I18n.pl.errors.messages.vulgarity="zawiera mocny język.",o.I18n.en.date={formats:{default:"%Y-%m-%d",short:"%b %d",long:"%B %d, %Y"},day_names:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],abbr_day_names:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],month_names:["January","February","March","April","May","June","July","August","September","October","November","December"],abbr_month_names:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},window.test={getLine:()=>te.getLine(),getWire:()=>te.getWire()}}},r={};function n(t){var o=r[t];if(void 0!==o)return o.exports;var i=r[t]={exports:{}};return e[t].call(i.exports,i,i.exports,n),i.exports}n.m=e,t=[],n.O=function(e,r,o,i){if(!r){var s=1/0;for(u=0;u<t.length;u++){r=t[u][0],o=t[u][1],i=t[u][2];for(var a=!0,c=0;c<r.length;c++)(!1&i||s>=i)&&Object.keys(n.O).every((function(t){return n.O[t](r[c])}))?r.splice(c--,1):(a=!1,i<s&&(s=i));if(a){t.splice(u--,1);var l=o();void 0!==l&&(e=l)}}return e}i=i||0;for(var u=t.length;u>0&&t[u-1][2]>i;u--)t[u]=t[u-1];t[u]=[r,o,i]},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,{a:e}),e},n.d=function(t,e){for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.e=function(){return Promise.resolve()},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},function(){var t={543:0};n.O.j=function(e){return 0===t[e]};var e=function(e,r){var o,i,s=r[0],a=r[1],c=r[2],l=0;if(s.some((function(e){return 0!==t[e]}))){for(o in a)n.o(a,o)&&(n.m[o]=a[o]);if(c)var u=c(n)}for(e&&e(r);l<s.length;l++)i=s[l],n.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return n.O(u)},r=self.webpackChunk=self.webpackChunk||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))}();var o=n.O(void 0,[121],(function(){return n(48244)}));o=n.O(o)}();
//# sourceMappingURL=application.js.map